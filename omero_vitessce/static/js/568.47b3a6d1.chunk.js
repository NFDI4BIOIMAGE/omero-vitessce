/*! For license information please see 568.47b3a6d1.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkomero_vitessce=self.webpackChunkomero_vitessce||[]).push([[568],{568:(e,t,n)=>{n.d(t,{SpatialWrapper:()=>_a});var r=n(583),o=n(43),i=(n(950),{exports:{}}),a={ConcurrentRoot:1,ContinuousEventPriority:4,DefaultEventPriority:16,DiscreteEventPriority:1,IdleEventPriority:536870912,LegacyRoot:0};i.exports=a;var s=i.exports,l={exports:{}},u={exports:{}},c={};!function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>o(l,n))u<i&&0>o(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[s]=n,r=s);else{if(!(u<i&&0>o(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var l=[],u=[],c=1,d=null,f=3,h=!1,p=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function b(e){for(var o=n(u);null!==o;){if(null===o.callback)r(u);else{if(!(o.startTime<=e))break;r(u),o.sortIndex=o.expirationTime,t(l,o)}o=n(u)}}function x(e){if(m=!1,b(e),!p)if(null!==n(l))p=!0,I(w);else{var t=n(u);null!==t&&z(x,t.startTime-e)}}function w(t,o){p=!1,m&&(m=!1,v(T),T=-1),h=!0;var i=f;try{for(b(o),d=n(l);null!==d&&(!(d.expirationTime>o)||t&&!C());){var a=d.callback;if("function"==typeof a){d.callback=null,f=d.priorityLevel;var s=a(d.expirationTime<=o);o=e.unstable_now(),"function"==typeof s?d.callback=s:d===n(l)&&r(l),b(o)}else r(l);d=n(l)}if(null!==d)var c=!0;else{var g=n(u);null!==g&&z(x,g.startTime-o),c=!1}return c}finally{d=null,f=i,h=!1}}typeof navigator<"u"&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,_=!1,E=null,T=-1,A=5,P=-1;function C(){return!(e.unstable_now()-P<A)}function M(){if(null!==E){var t=e.unstable_now();P=t;var n=!0;try{n=E(!0,t)}finally{n?S():(_=!1,E=null)}}else _=!1}if("function"==typeof y)S=function(){y(M)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,R=L.port2;L.port1.onmessage=M,S=function(){R.postMessage(null)}}else S=function(){g(M,0)};function I(e){E=e,_||(_=!0,S())}function z(t,n){T=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,I(w))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_scheduleCallback=function(r,o,i){var a=e.unstable_now();switch("object"==typeof i&&null!==i?i="number"==typeof(i=i.delay)&&0<i?a+i:a:i=a,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return r={id:c++,callback:o,priorityLevel:r,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(r.sortIndex=i,t(u,r),null===n(l)&&r===n(u)&&(m?(v(T),T=-1):m=!0,z(x,i-a))):(r.sortIndex=s,t(l,r),p||h||(p=!0,I(w))),r},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}}(c),u.exports=c;var d=u.exports;l.exports=function(e){var t={},n=o,r=d,i=Object.assign;function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),S=Symbol.iterator;function _(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=S&&e[S]||e["@@iterator"])?e:null}function E(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case c:return"Fragment";case u:return"Portal";case h:return"Profiler";case f:return"StrictMode";case v:return"Suspense";case y:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case m:return(e.displayName||"Context")+".Consumer";case p:return(e._context.displayName||"Context")+".Provider";case g:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case b:return null!==(t=e.displayName||null)?t:E(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return E(e(t))}catch{}}return null}function T(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(t);case 8:return t===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function A(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{4098&(t=e).flags&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function P(e){if(A(e)!==e)throw Error(a(188))}function C(e){var t=e.alternate;if(!t){if(null===(t=A(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return P(o),e;if(i===r)return P(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}function M(e){return null!==(e=C(e))?L(e):null}function L(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=L(e);if(null!==t)return t;e=e.sibling}return null}function R(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=R(e);if(null!==t)return t}e=e.sibling}return null}var I,z=Array.isArray,k=e.getPublicInstance,N=e.getRootHostContext,O=e.getChildHostContext,j=e.prepareForCommit,B=e.resetAfterCommit,D=e.createInstance,U=e.appendInitialChild,F=e.finalizeInitialChildren,H=e.prepareUpdate,V=e.shouldSetTextContent,G=e.createTextInstance,q=e.scheduleTimeout,W=e.cancelTimeout,X=e.noTimeout,Y=e.isPrimaryRenderer,K=e.supportsMutation,Q=e.supportsPersistence,$=e.supportsHydration,J=e.getInstanceFromNode,Z=e.preparePortalMount,ee=e.getCurrentEventPriority,te=e.detachDeletedInstance,ne=e.supportsMicrotasks,re=e.scheduleMicrotask,oe=e.supportsTestSelectors,ie=e.findFiberRoot,ae=e.getBoundingRect,se=e.getTextContent,le=e.isHiddenSubtree,ue=e.matchAccessibilityRole,ce=e.setFocusIfFocusable,de=e.setupIntersectionObserver,fe=e.appendChild,he=e.appendChildToContainer,pe=e.commitTextUpdate,me=e.commitMount,ge=e.commitUpdate,ve=e.insertBefore,ye=e.insertInContainerBefore,be=e.removeChild,xe=e.removeChildFromContainer,we=e.resetTextContent,Se=e.hideInstance,_e=e.hideTextInstance,Ee=e.unhideInstance,Te=e.unhideTextInstance,Ae=e.clearContainer,Pe=e.cloneInstance,Ce=e.createContainerChildSet,Me=e.appendChildToContainerChildSet,Le=e.finalizeContainerChildren,Re=e.replaceContainerChildren,Ie=e.cloneHiddenInstance,ze=e.cloneHiddenTextInstance,ke=e.canHydrateInstance,Ne=e.canHydrateTextInstance,Oe=e.canHydrateSuspenseInstance,je=e.isSuspenseInstancePending,Be=e.isSuspenseInstanceFallback,De=e.registerSuspenseInstanceRetry,Ue=e.getNextHydratableSibling,Fe=e.getFirstHydratableChild,He=e.getFirstHydratableChildWithinContainer,Ve=e.getFirstHydratableChildWithinSuspenseInstance,Ge=e.hydrateInstance,qe=e.hydrateTextInstance,We=e.hydrateSuspenseInstance,Xe=e.getNextHydratableInstanceAfterSuspenseInstance,Ye=e.commitHydratedContainer,Ke=e.commitHydratedSuspenseInstance,Qe=e.clearSuspenseBoundary,$e=e.clearSuspenseBoundaryFromContainer,Je=e.shouldDeleteUnhydratedTailInstances,Ze=e.didNotMatchHydratedContainerTextInstance,et=e.didNotMatchHydratedTextInstance;function tt(e){if(void 0===I)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);I=t&&t[1]||""}return"\n"+I+e}var nt=!1;function rt(e,t){if(!e||nt)return"";nt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"==typeof u.stack){for(var o=u.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s]){var l="\n"+o[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{nt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?tt(e):""}var ot=Object.prototype.hasOwnProperty,it=[],at=-1;function st(e){return{current:e}}function lt(e){0>at||(e.current=it[at],it[at]=null,at--)}function ut(e,t){at++,it[at]=e.current,e.current=t}var ct={},dt=st(ct),ft=st(!1),ht=ct;function pt(e,t){var n=e.type.contextTypes;if(!n)return ct;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function mt(e){return null!=(e=e.childContextTypes)}function gt(){lt(ft),lt(dt)}function vt(e,t,n){if(dt.current!==ct)throw Error(a(168));ut(dt,t),ut(ft,n)}function yt(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,T(e)||"Unknown",o));return i({},n,r)}function bt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,ht=dt.current,ut(dt,e),ut(ft,ft.current),!0}function xt(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=yt(e,t,ht),r.__reactInternalMemoizedMergedChildContext=e,lt(ft),lt(dt),ut(dt,e)):lt(ft),ut(ft,n)}var wt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(St(e)/_t|0)|0},St=Math.log,_t=Math.LN2;var Et=64,Tt=4194304;function At(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~o;0!==s?r=At(s):0!==(i&=a)&&(r=At(i))}else 0!==(a=n&~o)?r=At(a):0!==i&&(r=At(i));if(0===r)return 0;if(0!==t&&t!==r&&!(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-wt(t)),r|=e[n],t&=~o;return r}function Ct(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Lt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Rt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-wt(t)]=n}function It(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-wt(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var zt=0;function kt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Nt=r.unstable_scheduleCallback,Ot=r.unstable_cancelCallback,jt=r.unstable_shouldYield,Bt=r.unstable_requestPaint,Dt=r.unstable_now,Ut=r.unstable_ImmediatePriority,Ft=r.unstable_UserBlockingPriority,Ht=r.unstable_NormalPriority,Vt=r.unstable_IdlePriority,Gt=null,qt=null;var Wt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Xt=null,Yt=!1,Kt=!1;function Qt(e){null===Xt?Xt=[e]:Xt.push(e)}function $t(){if(!Kt&&null!==Xt){Kt=!0;var e=0,t=zt;try{var n=Xt;for(zt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Xt=null,Yt=!1}catch(o){throw null!==Xt&&(Xt=Xt.slice(e+1)),Nt(Ut,$t),o}finally{zt=t,Kt=!1}}return null}var Jt=s.ReactCurrentBatchConfig;function Zt(e,t){if(Wt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!ot.call(t,o)||!Wt(e[o],t[o]))return!1}return!0}function en(e){switch(e.tag){case 5:return tt(e.type);case 16:return tt("Lazy");case 13:return tt("Suspense");case 19:return tt("SuspenseList");case 0:case 2:case 15:return e=rt(e.type,!1);case 11:return e=rt(e.type.render,!1);case 1:return e=rt(e.type,!0);default:return""}}function tn(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var nn=st(null),rn=null,on=null,an=null;function sn(){an=on=rn=null}function ln(e,t,n){Y?(ut(nn,t._currentValue),t._currentValue=n):(ut(nn,t._currentValue2),t._currentValue2=n)}function un(e){var t=nn.current;lt(nn),Y?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function dn(e,t){rn=e,an=on=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.lanes&t&&(Bo=!0),e.firstContext=null)}function fn(e){var t=Y?e._currentValue:e._currentValue2;if(an!==e)if(e={context:e,memoizedValue:t,next:null},null===on){if(null===rn)throw Error(a(308));on=e,rn.dependencies={lanes:0,firstContext:e}}else on=on.next=e;return t}var hn=null,pn=!1;function mn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function vn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==Qi&&1&e.mode&&!(2&Ki)?(null===(e=n.interleaved)?(t.next=t,null===hn?hn=[n]:hn.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function bn(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,It(e,n)}}function xn(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function wn(e,t,n,r){var o=e.updateQueue;pn=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var u=l,c=u.next;u.next=null,null===s?a=c:s.next=c,s=u;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(null!==a){var f=o.baseState;for(s=0,d=c=u=null,l=a;;){var h=l.lane,p=l.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(h=t,p=n,g.tag){case 1:if("function"==typeof(m=g.payload)){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=g.payload)?m.call(p,f,h):m))break e;f=i({},f,h);break e;case 2:pn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(h=o.effects)?o.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=p,u=f):d=d.next=p,s|=h;if(null===(l=l.next)){if(null===(l=o.shared.pending))break;l=(h=l).next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}if(null===d&&(u=f),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=d,null!==(t=o.shared.interleaved)){o=t;do{s|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);ra|=s,e.lanes=s,e.memoizedState=f}}function Sn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(a(191,o));o.call(r)}}}var _n=(new n.Component).refs;function En(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Tn={isMounted:function(e){return!!(e=e._reactInternals)&&A(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Sa(),o=_a(e),i=vn(r,o);i.payload=t,null!=n&&(i.callback=n),yn(e,i),null!==(t=Ea(e,o,r))&&bn(t,e,o)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Sa(),o=_a(e),i=vn(r,o);i.tag=1,i.payload=t,null!=n&&(i.callback=n),yn(e,i),null!==(t=Ea(e,o,r))&&bn(t,e,o)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Sa(),r=_a(e),o=vn(n,r);o.tag=2,null!=t&&(o.callback=t),yn(e,o),null!==(t=Ea(e,r,n))&&bn(t,e,r)}};function An(e,t,n,r,o,i,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!Zt(n,r)||!Zt(o,i))}function Pn(e,t,n){var r=!1,o=ct,i=t.contextType;return"object"==typeof i&&null!==i?i=fn(i):(o=mt(t)?ht:dt.current,i=(r=null!=(r=t.contextTypes))?pt(e,o):ct),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Tn,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Cn(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Tn.enqueueReplaceState(t,t.state,null)}function Mn(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=_n,mn(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=fn(i):(i=mt(t)?ht:dt.current,o.context=pt(e,i)),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(En(e,t,i,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&Tn.enqueueReplaceState(o,o.state,null),wn(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}var Ln=[],Rn=0,In=null,zn=0,kn=[],Nn=0,On=null,jn=1,Bn="";function Dn(e,t){Ln[Rn++]=zn,Ln[Rn++]=In,In=e,zn=t}function Un(e,t,n){kn[Nn++]=jn,kn[Nn++]=Bn,kn[Nn++]=On,On=e;var r=jn;e=Bn;var o=32-wt(r)-1;r&=~(1<<o),n+=1;var i=32-wt(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,jn=1<<32-wt(t)+o|n<<o|r,Bn=i+e}else jn=1<<i|n<<o|r,Bn=e}function Fn(e){null!==e.return&&(Dn(e,1),Un(e,1,0))}function Hn(e){for(;e===In;)In=Ln[--Rn],Ln[Rn]=null,zn=Ln[--Rn],Ln[Rn]=null;for(;e===On;)On=kn[--Nn],kn[Nn]=null,Bn=kn[--Nn],kn[Nn]=null,jn=kn[--Nn],kn[Nn]=null}var Vn=null,Gn=null,qn=!1,Wn=!1,Xn=null;function Yn(e,t){var n=Za(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Kn(e,t){switch(e.tag){case 5:return null!==(t=ke(t,e.type,e.pendingProps))&&(e.stateNode=t,Vn=e,Gn=Fe(t),!0);case 6:return null!==(t=Ne(t,e.pendingProps))&&(e.stateNode=t,Vn=e,Gn=null,!0);case 13:if(null!==(t=Oe(t))){var n=null!==On?{id:jn,overflow:Bn}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Za(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Vn=e,Gn=null,!0}return!1;default:return!1}}function Qn(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function $n(e){if(qn){var t=Gn;if(t){var n=t;if(!Kn(e,t)){if(Qn(e))throw Error(a(418));t=Ue(n);var r=Vn;t&&Kn(e,t)?Yn(r,n):(e.flags=-4097&e.flags|2,qn=!1,Vn=e)}}else{if(Qn(e))throw Error(a(418));e.flags=-4097&e.flags|2,qn=!1,Vn=e}}}function Jn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Vn=e}function Zn(e){if(!$||e!==Vn)return!1;if(!qn)return Jn(e),qn=!0,!1;if(3!==e.tag&&(5!==e.tag||Je(e.type)&&!V(e.type,e.memoizedProps))){var t=Gn;if(t){if(Qn(e)){for(e=Gn;e;)e=Ue(e);throw Error(a(418))}for(;t;)Yn(e,t),t=Ue(t)}}if(Jn(e),13===e.tag){if(!$)throw Error(a(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));Gn=Xe(e)}else Gn=Vn?Ue(e.stateNode):null;return!0}function er(){$&&(Gn=Vn=null,Wn=qn=!1)}function tr(e){null===Xn?Xn=[e]:Xn.push(e)}function nr(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=o.refs;t===_n&&(t=o.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function rr(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function or(e){return(0,e._init)(e._payload)}function ir(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=ts(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function d(e,t,n,r){return null===t||6!==t.tag?((t=is(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function f(e,t,n,r){var i=n.type;return i===c?p(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===x&&or(i)===t.type)?((r=o(t,n.props)).ref=nr(e,t,n),r.return=e,r):((r=ns(n.type,n.key,n.props,null,e.mode,r)).ref=nr(e,t,n),r.return=e,r)}function h(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=as(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function p(e,t,n,r,i){return null===t||7!==t.tag?((t=rs(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=is(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case l:return(n=ns(t.type,t.key,t.props,null,e.mode,n)).ref=nr(e,null,t),n.return=e,n;case u:return(t=as(t,e.mode,n)).return=e,t;case x:return m(e,(0,t._init)(t._payload),n)}if(z(t)||_(t))return(t=rs(t,e.mode,n,null)).return=e,t;rr(e,t)}return null}function g(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:d(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===o?f(e,t,n,r):null;case u:return n.key===o?h(e,t,n,r):null;case x:return g(e,t,(o=n._init)(n._payload),r)}if(z(n)||_(n))return null!==o?null:p(e,t,n,r,null);rr(e,n)}return null}function v(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r)return d(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case l:return f(t,e=e.get(null===r.key?n:r.key)||null,r,o);case u:return h(t,e=e.get(null===r.key?n:r.key)||null,r,o);case x:return v(e,t,n,(0,r._init)(r._payload),o)}if(z(r)||_(r))return p(t,e=e.get(n)||null,r,o,null);rr(t,r)}return null}return function d(f,h,p,y){if("object"==typeof p&&null!==p&&p.type===c&&null===p.key&&(p=p.props.children),"object"==typeof p&&null!==p){switch(p.$$typeof){case l:e:{for(var b=p.key,w=h;null!==w;){if(w.key===b){if((b=p.type)===c){if(7===w.tag){n(f,w.sibling),(h=o(w,p.props.children)).return=f,f=h;break e}}else if(w.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===x&&or(b)===w.type){n(f,w.sibling),(h=o(w,p.props)).ref=nr(f,w,p),h.return=f,f=h;break e}n(f,w);break}t(f,w),w=w.sibling}p.type===c?((h=rs(p.props.children,f.mode,y,p.key)).return=f,f=h):((y=ns(p.type,p.key,p.props,null,f.mode,y)).ref=nr(f,h,p),y.return=f,f=y)}return s(f);case u:e:{for(w=p.key;null!==h;){if(h.key===w){if(4===h.tag&&h.stateNode.containerInfo===p.containerInfo&&h.stateNode.implementation===p.implementation){n(f,h.sibling),(h=o(h,p.children||[])).return=f,f=h;break e}n(f,h);break}t(f,h),h=h.sibling}(h=as(p,f.mode,y)).return=f,f=h}return s(f);case x:return d(f,h,(w=p._init)(p._payload),y)}if(z(p))return function(o,a,s,l){for(var u=null,c=null,d=a,f=a=0,h=null;null!==d&&f<s.length;f++){d.index>f?(h=d,d=null):h=d.sibling;var p=g(o,d,s[f],l);if(null===p){null===d&&(d=h);break}e&&d&&null===p.alternate&&t(o,d),a=i(p,a,f),null===c?u=p:c.sibling=p,c=p,d=h}if(f===s.length)return n(o,d),qn&&Dn(o,f),u;if(null===d){for(;f<s.length;f++)null!==(d=m(o,s[f],l))&&(a=i(d,a,f),null===c?u=d:c.sibling=d,c=d);return qn&&Dn(o,f),u}for(d=r(o,d);f<s.length;f++)null!==(h=v(d,o,f,s[f],l))&&(e&&null!==h.alternate&&d.delete(null===h.key?f:h.key),a=i(h,a,f),null===c?u=h:c.sibling=h,c=h);return e&&d.forEach((function(e){return t(o,e)})),qn&&Dn(o,f),u}(f,h,p,y);if(_(p))return function(o,s,l,u){var c=_(l);if("function"!=typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var d=c=null,f=s,h=s=0,p=null,y=l.next();null!==f&&!y.done;h++,y=l.next()){f.index>h?(p=f,f=null):p=f.sibling;var b=g(o,f,y.value,u);if(null===b){null===f&&(f=p);break}e&&f&&null===b.alternate&&t(o,f),s=i(b,s,h),null===d?c=b:d.sibling=b,d=b,f=p}if(y.done)return n(o,f),qn&&Dn(o,h),c;if(null===f){for(;!y.done;h++,y=l.next())null!==(y=m(o,y.value,u))&&(s=i(y,s,h),null===d?c=y:d.sibling=y,d=y);return qn&&Dn(o,h),c}for(f=r(o,f);!y.done;h++,y=l.next())null!==(y=v(f,o,h,y.value,u))&&(e&&null!==y.alternate&&f.delete(null===y.key?h:y.key),s=i(y,s,h),null===d?c=y:d.sibling=y,d=y);return e&&f.forEach((function(e){return t(o,e)})),qn&&Dn(o,h),c}(f,h,p,y);rr(f,p)}return"string"==typeof p&&""!==p||"number"==typeof p?(p=""+p,null!==h&&6===h.tag?(n(f,h.sibling),(h=o(h,p)).return=f,f=h):(n(f,h),(h=is(p,f.mode,y)).return=f,f=h),s(f)):n(f,h)}}var ar=ir(!0),sr=ir(!1),lr={},ur=st(lr),cr=st(lr),dr=st(lr);function fr(e){if(e===lr)throw Error(a(174));return e}function hr(e,t){ut(dr,t),ut(cr,e),ut(ur,lr),e=N(t),lt(ur),ut(ur,e)}function pr(){lt(ur),lt(cr),lt(dr)}function mr(e){var t=fr(dr.current),n=fr(ur.current);n!==(t=O(n,e.type,t))&&(ut(cr,e),ut(ur,t))}function gr(e){cr.current===e&&(lt(ur),lt(cr))}var vr=st(0);function yr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||je(n)||Be(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var br=[];function xr(){for(var e=0;e<br.length;e++){var t=br[e];Y?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}br.length=0}var wr=s.ReactCurrentDispatcher,Sr=s.ReactCurrentBatchConfig,_r=0,Er=null,Tr=null,Ar=null,Pr=!1,Cr=!1,Mr=0,Lr=0;function Rr(){throw Error(a(321))}function Ir(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Wt(e[n],t[n]))return!1;return!0}function zr(e,t,n,r,o,i){if(_r=i,Er=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wr.current=null===e||null===e.memoizedState?go:vo,e=n(r,o),Cr){i=0;do{if(Cr=!1,Mr=0,25<=i)throw Error(a(301));i+=1,Ar=Tr=null,t.updateQueue=null,wr.current=yo,e=n(r,o)}while(Cr)}if(wr.current=mo,t=null!==Tr&&null!==Tr.next,_r=0,Ar=Tr=Er=null,Pr=!1,t)throw Error(a(300));return e}function kr(){var e=0!==Mr;return Mr=0,e}function Nr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ar?Er.memoizedState=Ar=e:Ar=Ar.next=e,Ar}function Or(){if(null===Tr){var e=Er.alternate;e=null!==e?e.memoizedState:null}else e=Tr.next;var t=null===Ar?Er.memoizedState:Ar.next;if(null!==t)Ar=t,Tr=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Tr=e).memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},null===Ar?Er.memoizedState=Ar=e:Ar=Ar.next=e}return Ar}function jr(e,t){return"function"==typeof t?t(e):t}function Br(e){var t=Or(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=Tr,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var l=s=null,u=null,c=i;do{var d=c.lane;if((_r&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=f,s=r):u=u.next=f,Er.lanes|=d,ra|=d}c=c.next}while(null!==c&&c!==i);null===u?s=r:u.next=l,Wt(r,t.memoizedState)||(Bo=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,Er.lanes|=i,ra|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Dr(e){var t=Or(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);Wt(i,t.memoizedState)||(Bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Ur(){}function Fr(e,t){var n=Er,r=Or(),o=t(),i=!Wt(r.memoizedState,o);if(i&&(r.memoizedState=o,Bo=!0),r=r.queue,Jr(Gr.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==Ar&&1&Ar.memoizedState.tag){if(n.flags|=2048,Xr(9,Vr.bind(null,n,r,o,t),void 0,null),null===Qi)throw Error(a(349));30&_r||Hr(n,t,o)}return o}function Hr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Er.updateQueue)?(t={lastEffect:null,stores:null},Er.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Vr(e,t,n,r){t.value=n,t.getSnapshot=r,qr(t)&&Ea(e,1,-1)}function Gr(e,t,n){return n((function(){qr(t)&&Ea(e,1,-1)}))}function qr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Wt(e,n)}catch{return!0}}function Wr(e){var t=Nr();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jr,lastRenderedState:e},t.queue=e,e=e.dispatch=uo.bind(null,Er,e),[t.memoizedState,e]}function Xr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Er.updateQueue)?(t={lastEffect:null,stores:null},Er.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Yr(){return Or().memoizedState}function Kr(e,t,n,r){var o=Nr();Er.flags|=e,o.memoizedState=Xr(1|t,n,void 0,void 0===r?null:r)}function Qr(e,t,n,r){var o=Or();r=void 0===r?null:r;var i=void 0;if(null!==Tr){var a=Tr.memoizedState;if(i=a.destroy,null!==r&&Ir(r,a.deps))return void(o.memoizedState=Xr(t,n,i,r))}Er.flags|=e,o.memoizedState=Xr(1|t,n,i,r)}function $r(e,t){return Kr(8390656,8,e,t)}function Jr(e,t){return Qr(2048,8,e,t)}function Zr(e,t){return Qr(4,2,e,t)}function eo(e,t){return Qr(4,4,e,t)}function to(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function no(e,t,n){return n=null!=n?n.concat([e]):null,Qr(4,4,to.bind(null,t,e),n)}function ro(){}function oo(e,t){var n=Or();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ir(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function io(e,t){var n=Or();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ir(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ao(e,t){var n=zt;zt=0!==n&&4>n?n:4,e(!0);var r=Sr.transition;Sr.transition={};try{e(!1),t()}finally{zt=n,Sr.transition=r}}function so(){return Or().memoizedState}function lo(e,t,n){var r=_a(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},co(e)?fo(t,n):(ho(e,t,n),null!==(e=Ea(e,r,n=Sa()))&&po(e,t,r))}function uo(e,t,n){var r=_a(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(co(e))fo(t,o);else{ho(e,t,o);var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,Wt(s,a))return}catch{}null!==(e=Ea(e,r,n=Sa()))&&po(e,t,r)}}function co(e){var t=e.alternate;return e===Er||null!==t&&t===Er}function fo(e,t){Cr=Pr=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ho(e,t,n){null!==Qi&&1&e.mode&&!(2&Ki)?(null===(e=t.interleaved)?(n.next=n,null===hn?hn=[t]:hn.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function po(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,It(e,n)}}var mo={readContext:fn,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},go={readContext:fn,useCallback:function(e,t){return Nr().memoizedState=[e,void 0===t?null:t],e},useContext:fn,useEffect:$r,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Kr(4194308,4,to.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Kr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Kr(4,2,e,t)},useMemo:function(e,t){var n=Nr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Nr();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=lo.bind(null,Er,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Nr().memoizedState=e},useState:Wr,useDebugValue:ro,useDeferredValue:function(e){var t=Wr(e),n=t[0],r=t[1];return $r((function(){var t=Sr.transition;Sr.transition={};try{r(e)}finally{Sr.transition=t}}),[e]),n},useTransition:function(){var e=Wr(!1),t=e[0];return e=ao.bind(null,e[1]),Nr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Er,o=Nr();if(qn){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Qi)throw Error(a(349));30&_r||Hr(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,$r(Gr.bind(null,r,i,e),[e]),r.flags|=2048,Xr(9,Vr.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Nr(),t=Qi.identifierPrefix;if(qn){var n=Bn;t=":"+t+"R"+(n=(jn&~(1<<32-wt(jn)-1)).toString(32)+n),0<(n=Mr++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Lr++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},vo={readContext:fn,useCallback:oo,useContext:fn,useEffect:Jr,useImperativeHandle:no,useInsertionEffect:Zr,useLayoutEffect:eo,useMemo:io,useReducer:Br,useRef:Yr,useState:function(){return Br(jr)},useDebugValue:ro,useDeferredValue:function(e){var t=Br(jr),n=t[0],r=t[1];return Jr((function(){var t=Sr.transition;Sr.transition={};try{r(e)}finally{Sr.transition=t}}),[e]),n},useTransition:function(){return[Br(jr)[0],Or().memoizedState]},useMutableSource:Ur,useSyncExternalStore:Fr,useId:so,unstable_isNewReconciler:!1},yo={readContext:fn,useCallback:oo,useContext:fn,useEffect:Jr,useImperativeHandle:no,useInsertionEffect:Zr,useLayoutEffect:eo,useMemo:io,useReducer:Dr,useRef:Yr,useState:function(){return Dr(jr)},useDebugValue:ro,useDeferredValue:function(e){var t=Dr(jr),n=t[0],r=t[1];return Jr((function(){var t=Sr.transition;Sr.transition={};try{r(e)}finally{Sr.transition=t}}),[e]),n},useTransition:function(){return[Dr(jr)[0],Or().memoizedState]},useMutableSource:Ur,useSyncExternalStore:Fr,useId:so,unstable_isNewReconciler:!1};function bo(e,t){try{var n="",r=t;do{n+=en(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o}}function xo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var wo,So,_o,Eo,To="function"==typeof WeakMap?WeakMap:Map;function Ao(e,t,n){(n=vn(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){fa||(fa=!0,ha=r),xo(0,t)},n}function Po(e,t,n){(n=vn(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){xo(0,t)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){xo(0,t),"function"!=typeof r&&(null===pa?pa=new Set([this]):pa.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Co(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new To;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Xa.bind(null,e,t,n),t.then(e,e))}function Mo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Lo(e,t,n,r,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=vn(-1,1)).tag=2,yn(n,t))),n.lanes|=1),e)}function Ro(e){e.flags|=4}function Io(e,t){if(null!==e&&e.child===t.child)return!0;if(16&t.flags)return!1;for(e=t.child;null!==e;){if(12854&e.flags||12854&e.subtreeFlags)return!1;e=e.sibling}return!0}if(K)wo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)U(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},So=function(){},_o=function(e,t,n,r,o){if((e=e.memoizedProps)!==r){var i=t.stateNode,a=fr(ur.current);n=H(i,n,e,r,o,a),(t.updateQueue=n)&&Ro(t)}},Eo=function(e,t,n,r){n!==r&&Ro(t)};else if(Q){wo=function(e,t,n,r){for(var o=t.child;null!==o;){if(5===o.tag){var i=o.stateNode;n&&r&&(i=Ie(i,o.type,o.memoizedProps,o)),U(e,i)}else if(6===o.tag)i=o.stateNode,n&&r&&(i=ze(i,o.memoizedProps,o)),U(e,i);else if(4!==o.tag)if(22===o.tag&&null!==o.memoizedState)null!==(i=o.child)&&(i.return=o),wo(e,o,!0,!0);else if(null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};var zo=function(e,t,n,r){for(var o=t.child;null!==o;){if(5===o.tag){var i=o.stateNode;n&&r&&(i=Ie(i,o.type,o.memoizedProps,o)),Me(e,i)}else if(6===o.tag)i=o.stateNode,n&&r&&(i=ze(i,o.memoizedProps,o)),Me(e,i);else if(4!==o.tag)if(22===o.tag&&null!==o.memoizedState)null!==(i=o.child)&&(i.return=o),zo(e,o,!0,!0);else if(null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};So=function(e,t){var n=t.stateNode;if(!Io(e,t)){e=n.containerInfo;var r=Ce(e);zo(r,t,!1,!1),n.pendingChildren=r,Ro(t),Le(e,r)}},_o=function(e,t,n,r,o){var i=e.stateNode,a=e.memoizedProps;if((e=Io(e,t))&&a===r)t.stateNode=i;else{var s=t.stateNode,l=fr(ur.current),u=null;a!==r&&(u=H(s,n,a,r,o,l)),e&&null===u?t.stateNode=i:(i=Pe(i,u,n,a,r,t,e,s),F(i,n,r,o,l)&&Ro(t),t.stateNode=i,e?Ro(t):wo(i,t,!1,!1))}},Eo=function(e,t,n,r){n!==r?(e=fr(dr.current),n=fr(ur.current),t.stateNode=G(r,e,n,t),Ro(t)):t.stateNode=e.stateNode}}else So=function(){},_o=function(){},Eo=function(){};function ko(e,t){if(!qn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function No(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Oo(e,t,n){var r=t.pendingProps;switch(Hn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return No(t),null;case 1:case 17:return mt(t.type)&&gt(),No(t),null;case 3:return r=t.stateNode,pr(),lt(ft),lt(dt),xr(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(null===e||null===e.child)&&(Zn(t)?Ro(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==Xn&&(Ma(Xn),Xn=null))),So(e,t),No(t),null;case 5:gr(t),n=fr(dr.current);var o=t.type;if(null!==e&&null!=t.stateNode)_o(e,t,o,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return No(t),null}if(e=fr(ur.current),Zn(t)){if(!$)throw Error(a(175));e=Ge(t.stateNode,t.type,t.memoizedProps,n,e,t,!Wn),t.updateQueue=e,null!==e&&Ro(t)}else{var i=D(o,r,n,e,t);wo(i,t,!1,!1),t.stateNode=i,F(i,o,r,n,e)&&Ro(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return No(t),null;case 6:if(e&&null!=t.stateNode)Eo(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(e=fr(dr.current),n=fr(ur.current),Zn(t)){if(!$)throw Error(a(176));if(e=t.stateNode,r=t.memoizedProps,(n=qe(e,r,t,!Wn))&&null!==(o=Vn))switch(i=0!==(1&o.mode),o.tag){case 3:Ze(o.stateNode.containerInfo,e,r,i);break;case 5:et(o.type,o.memoizedProps,o.stateNode,e,r,i)}n&&Ro(t)}else t.stateNode=G(r,e,n,t)}return No(t),null;case 13:if(lt(vr),r=t.memoizedState,qn&&null!==Gn&&1&t.mode&&!(128&t.flags)){for(e=Gn;e;)e=Ue(e);return er(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Zn(t),null===e){if(!r)throw Error(a(318));if(!$)throw Error(a(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(317));We(e,t)}else er(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return No(t),null}return null!==Xn&&(Ma(Xn),Xn=null),128&t.flags?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Zn(t):n=null!==e.memoizedState,r&&!n&&(t.child.flags|=8192,1&t.mode&&(null===e||1&vr.current?0===ta&&(ta=3):ja())),null!==t.updateQueue&&(t.flags|=4),No(t),null);case 4:return pr(),So(e,t),null===e&&Z(t.stateNode.containerInfo),No(t),null;case 10:return un(t.type._context),No(t),null;case 19:if(lt(vr),null===(o=t.memoizedState))return No(t),null;if(r=0!==(128&t.flags),null===(i=o.rendering))if(r)ko(o,!1);else{if(0!==ta||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(i=yr(e))){for(t.flags|=128,ko(o,!1),null!==(e=i.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,r=t.child;null!==r;)o=e,(n=r).flags&=14680066,null===(i=n.alternate)?(n.childLanes=0,n.lanes=o,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=i.childLanes,n.lanes=i.lanes,n.child=i.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=i.memoizedProps,n.memoizedState=i.memoizedState,n.updateQueue=i.updateQueue,n.type=i.type,o=i.dependencies,n.dependencies=null===o?null:{lanes:o.lanes,firstContext:o.firstContext}),r=r.sibling;return ut(vr,1&vr.current|2),t.child}e=e.sibling}null!==o.tail&&Dt()>ua&&(t.flags|=128,r=!0,ko(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=yr(i))){if(t.flags|=128,r=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),ko(o,!0),null===o.tail&&"hidden"===o.tailMode&&!i.alternate&&!qn)return No(t),null}else 2*Dt()-o.renderingStartTime>ua&&1073741824!==n&&(t.flags|=128,r=!0,ko(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=o.last)?e.sibling=i:t.child=i,o.last=i)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Dt(),t.sibling=null,e=vr.current,ut(vr,r?1&e|2:1&e),t):(No(t),null);case 22:case 23:return za(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?1073741824&Zi&&(No(t),K&&6&t.subtreeFlags&&(t.flags|=8192)):No(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}var jo=s.ReactCurrentOwner,Bo=!1;function Do(e,t,n,r){t.child=null===e?sr(t,null,n,r):ar(t,e.child,n,r)}function Uo(e,t,n,r,o){n=n.render;var i=t.ref;return dn(t,o),r=zr(e,t,n,r,i,o),n=kr(),null===e||Bo?(qn&&n&&Fn(t),t.flags|=1,Do(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ai(e,t,o))}function Fo(e,t,n,r,o){if(null===e){var i=n.type;return"function"!=typeof i||es(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ns(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ho(e,t,i,r,o))}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:Zt)(a,r)&&e.ref===t.ref)return ai(e,t,o)}return t.flags|=1,(e=ts(i,r)).ref=t.ref,e.return=t,t.child=e}function Ho(e,t,n,r,o){if(null!==e&&Zt(e.memoizedProps,r)&&e.ref===t.ref){if(Bo=!1,0===(e.lanes&o))return t.lanes=e.lanes,ai(e,t,o);131072&e.flags&&(Bo=!0)}return qo(e,t,n,r,o)}function Vo(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,ut(ea,Zi),Zi|=e,null;t.memoizedState={baseLanes:0,cachePool:null},r=null!==i?i.baseLanes:n,ut(ea,Zi),Zi|=r}else t.memoizedState={baseLanes:0,cachePool:null},ut(ea,Zi),Zi|=n;else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,ut(ea,Zi),Zi|=r;return Do(e,t,o,n),t.child}function Go(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function qo(e,t,n,r,o){var i=mt(n)?ht:dt.current;return i=pt(t,i),dn(t,o),n=zr(e,t,n,r,i,o),r=kr(),null===e||Bo?(qn&&r&&Fn(t),t.flags|=1,Do(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ai(e,t,o))}function Wo(e,t,n,r,o){if(mt(n)){var i=!0;bt(t)}else i=!1;if(dn(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Pn(t,n,r),Mn(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"==typeof u&&null!==u?u=fn(u):u=pt(t,u=mt(n)?ht:dt.current);var c=n.getDerivedStateFromProps,d="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Cn(t,a,r,u),pn=!1;var f=t.memoizedState;a.state=f,wn(t,r,a,o),l=t.memoizedState,s!==r||f!==l||ft.current||pn?("function"==typeof c&&(En(t,n,c,r),l=t.memoizedState),(s=pn||An(t,n,s,r,f,l,u))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,gn(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:tn(t.type,s),a.props=u,d=t.pendingProps,f=a.context,"object"==typeof(l=n.contextType)&&null!==l?l=fn(l):l=pt(t,l=mt(n)?ht:dt.current);var h=n.getDerivedStateFromProps;(c="function"==typeof h||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||f!==l)&&Cn(t,a,r,l),pn=!1,f=t.memoizedState,a.state=f,wn(t,r,a,o);var p=t.memoizedState;s!==d||f!==p||ft.current||pn?("function"==typeof h&&(En(t,n,h,r),p=t.memoizedState),(u=pn||An(t,n,u,r,f,p,l)||!1)?(c||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Xo(e,t,n,r,i,o)}function Xo(e,t,n,r,o,i){Go(e,t);var a=0!==(128&t.flags);if(!r&&!a)return o&&xt(t,n,!1),ai(e,t,i);r=t.stateNode,jo.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=ar(t,e.child,null,i),t.child=ar(t,null,s,i)):Do(e,t,s,i),t.memoizedState=r.state,o&&xt(t,n,!0),t.child}function Yo(e){var t=e.stateNode;t.pendingContext?vt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&vt(0,t.context,!1),hr(e,t.containerInfo)}function Ko(e,t,n,r,o){return er(),tr(o),t.flags|=256,Do(e,t,n,r),t.child}var Qo={dehydrated:null,treeContext:null,retryLane:0};function $o(e){return{baseLanes:e,cachePool:null}}function Jo(e,t,n){var r,o=t.pendingProps,i=vr.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(s=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(i|=1),ut(vr,1&i),null===e)return $n(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?Be(e)?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=o.children,e=o.fallback,s?(o=t.mode,s=t.child,i={mode:"hidden",children:i},1&o||null===s?s=os(i,o,0,null):(s.childLanes=0,s.pendingProps=i),e=rs(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=$o(n),t.memoizedState=Qo,e):Zo(t,i));if(null!==(i=e.memoizedState)){if(null!==(r=i.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,ni(e,t,n,Error(a(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=o.fallback,i=t.mode,o=os({mode:"visible",children:o.children},i,0,null),(s=rs(s,i,n,null)).flags|=2,o.return=t,s.return=t,o.sibling=s,t.child=o,1&t.mode&&ar(t,e.child,null,n),t.child.memoizedState=$o(n),t.memoizedState=Qo,s);if(1&t.mode)if(Be(r))t=ni(e,t,n,Error(a(419)));else if(o=0!==(n&e.childLanes),Bo||o){if(null!==(o=Qi)){switch(n&-n){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(o=s&(o.suspendedLanes|n)?0:s)&&o!==i.retryLane&&(i.retryLane=o,Ea(e,o,-1))}ja(),t=ni(e,t,n,Error(a(421)))}else je(r)?(t.flags|=128,t.child=e.child,t=Ka.bind(null,e),De(r,t),t=null):(n=i.treeContext,$&&(Gn=Ve(r),Vn=t,qn=!0,Xn=null,Wn=!1,null!==n&&(kn[Nn++]=jn,kn[Nn++]=Bn,kn[Nn++]=On,jn=n.id,Bn=n.overflow,On=t)),(t=Zo(t,t.pendingProps.children)).flags|=4096);else t=ni(e,t,n,null);return t}return s?(o=ti(e,t,o.children,o.fallback,n),s=t.child,i=e.child.memoizedState,s.memoizedState=null===i?$o(n):{baseLanes:i.baseLanes|n,cachePool:null},s.childLanes=e.childLanes&~n,t.memoizedState=Qo,o):(n=ei(e,t,o.children,n),t.memoizedState=null,n)}return s?(o=ti(e,t,o.children,o.fallback,n),s=t.child,i=e.child.memoizedState,s.memoizedState=null===i?$o(n):{baseLanes:i.baseLanes|n,cachePool:null},s.childLanes=e.childLanes&~n,t.memoizedState=Qo,o):(n=ei(e,t,o.children,n),t.memoizedState=null,n)}function Zo(e,t){return(t=os({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ei(e,t,n,r){var o=e.child;return e=o.sibling,n=ts(o,{mode:"visible",children:n}),!(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function ti(e,t,n,r,o){var i=t.mode,a=(e=e.child).sibling,s={mode:"hidden",children:n};return 1&i||t.child===e?(n=ts(e,s)).subtreeFlags=14680064&e.subtreeFlags:((n=t.child).childLanes=0,n.pendingProps=s,t.deletions=null),null!==a?r=ts(a,r):(r=rs(r,i,o,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function ni(e,t,n,r){return null!==r&&tr(r),ar(t,e.child,null,n),(e=Zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ri(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),cn(e.return,t,n)}function oi(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function ii(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Do(e,t,r.children,n),2&(r=vr.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ri(e,n,t);else if(19===e.tag)ri(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ut(vr,r),1&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===yr(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),oi(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===yr(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}oi(t,!0,n,null,i);break;case"together":oi(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function ai(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),ra|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=ts(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ts(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function si(e,t){switch(Hn(t),t.tag){case 1:return mt(t.type)&&gt(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return pr(),lt(ft),lt(dt),xr(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return gr(t),null;case 13:if(lt(vr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));er()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return lt(vr),null;case 4:return pr(),null;case 10:return un(t.type._context),null;case 22:case 23:return za(),null;default:return null}}var li=!1,ui=!1,ci="function"==typeof WeakSet?WeakSet:Set,di=null;function fi(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(r){Wa(e,t,r)}else n.current=null}function hi(e,t,n){try{n()}catch(r){Wa(e,t,r)}}var pi=!1;function mi(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&hi(t,n,i)}o=o.next}while(o!==r)}}function gi(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function vi(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=k(n);else e=n;"function"==typeof t?t(e):t.current=e}}function yi(e,t,n){if(qt&&"function"==typeof qt.onCommitFiberUnmount)try{qt.onCommitFiberUnmount(Gt,t)}catch{}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e=e.next;do{var o=r,i=o.destroy;o=o.tag,void 0!==i&&(2&o||4&o)&&hi(t,n,i),r=r.next}while(r!==e)}break;case 1:if(fi(t,n),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Wa(t,n,a)}break;case 5:fi(t,n);break;case 4:K?Ai(e,t,n):Q&&Q&&(t=t.stateNode.containerInfo,n=Ce(t),Re(t,n))}}function bi(e,t,n){for(var r=t;;)if(yi(e,r,n),null===r.child||K&&4===r.tag){if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else r.child.return=r,r=r.child}function xi(e){var t=e.alternate;null!==t&&(e.alternate=null,xi(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&te(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function wi(e){return 5===e.tag||3===e.tag||4===e.tag}function Si(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||wi(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function _i(e){if(K){e:{for(var t=e.return;null!==t;){if(wi(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(we(t),n.flags&=-33),Ti(e,n=Si(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,Ei(e,n=Si(e),t);break;default:throw Error(a(161))}}}function Ei(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ye(n,e,t):he(n,e);else if(4!==r&&null!==(e=e.child))for(Ei(e,t,n),e=e.sibling;null!==e;)Ei(e,t,n),e=e.sibling}function Ti(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ve(n,e,t):fe(n,e);else if(4!==r&&null!==(e=e.child))for(Ti(e,t,n),e=e.sibling;null!==e;)Ti(e,t,n),e=e.sibling}function Ai(e,t,n){for(var r,o,i=t,s=!1;;){if(!s){s=i.return;e:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:o=!1;break e;case 3:case 4:r=r.containerInfo,o=!0;break e}s=s.return}s=!0}if(5===i.tag||6===i.tag)bi(e,i,n),o?xe(r,i.stateNode):be(r,i.stateNode);else if(18===i.tag)o?$e(r,i.stateNode):Qe(r,i.stateNode);else if(4===i.tag){if(null!==i.child){r=i.stateNode.containerInfo,o=!0,i.child.return=i,i=i.child;continue}}else if(yi(e,i,n),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(s=!1)}i.sibling.return=i.return,i=i.sibling}}function Pi(e,t){if(K){switch(t.tag){case 0:case 11:case 14:case 15:return mi(3,t,t.return),gi(3,t),void mi(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var o=t.type,i=t.updateQueue;t.updateQueue=null,null!==i&&ge(n,i,o,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(a(162));return n=t.memoizedProps,void pe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void($&&null!==e&&e.memoizedState.isDehydrated&&Ye(t.stateNode.containerInfo));case 13:case 19:return void Ci(t)}throw Error(a(163))}switch(t.tag){case 0:case 11:case 14:case 15:return mi(3,t,t.return),gi(3,t),void mi(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void Ci(t);case 3:$&&null!==e&&e.memoizedState.isDehydrated&&Ye(t.stateNode.containerInfo)}e:if(Q){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,Re(t.containerInfo,t.pendingChildren);break e}throw Error(a(163))}}function Ci(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ci),t.forEach((function(t){var r=Qa.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Mi(e,t,n){di=e,Li(e)}function Li(e,t,n){for(var r=0!==(1&e.mode);null!==di;){var o=di,i=o.child;if(22===o.tag&&r){var a=null!==o.memoizedState||li;if(!a){var s=o.alternate,l=null!==s&&null!==s.memoizedState||ui;s=li;var u=ui;if(li=a,(ui=l)&&!u)for(di=o;null!==di;)l=(a=di).child,22===a.tag&&null!==a.memoizedState?zi(o):null!==l?(l.return=a,di=l):zi(o);for(;null!==i;)di=i,Li(i),i=i.sibling;di=o,li=s,ui=u}Ri(e)}else 8772&o.subtreeFlags&&null!==i?(i.return=o,di=i):Ri(e)}}function Ri(e){for(;null!==di;){var t=di;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:ui||gi(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!ui)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:tn(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Sn(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=k(t.child.stateNode);break;case 1:n=t.child.stateNode}Sn(t,s,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&me(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if($&&null===t.memoizedState){var u=t.alternate;if(null!==u){var c=u.memoizedState;if(null!==c){var d=c.dehydrated;null!==d&&Ke(d)}}}break;default:throw Error(a(163))}ui||512&t.flags&&vi(t)}catch(f){Wa(t,t.return,f)}}if(t===e){di=null;break}if(null!==(n=t.sibling)){n.return=t.return,di=n;break}di=t.return}}function Ii(e){for(;null!==di;){var t=di;if(t===e){di=null;break}var n=t.sibling;if(null!==n){n.return=t.return,di=n;break}di=t.return}}function zi(e){for(;null!==di;){var t=di;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{gi(4,t)}catch(l){Wa(t,n,l)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(l){Wa(t,o,l)}}var i=t.return;try{vi(t)}catch(l){Wa(t,i,l)}break;case 5:var a=t.return;try{vi(t)}catch(l){Wa(t,a,l)}}}catch(l){Wa(t,t.return,l)}if(t===e){di=null;break}var s=t.sibling;if(null!==s){s.return=t.return,di=s;break}di=t.return}}var ki=0,Ni=1,Oi=2,ji=3,Bi=4;if("function"==typeof Symbol&&Symbol.for){var Di=Symbol.for;ki=Di("selector.component"),Ni=Di("selector.has_pseudo_class"),Oi=Di("selector.role"),ji=Di("selector.test_id"),Bi=Di("selector.text")}function Ui(e){var t=J(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(a(364));return t}if(null===(e=ie(e)))throw Error(a(362));return e.stateNode.current}function Fi(e,t){switch(t.$$typeof){case ki:if(e.type===t.value)return!0;break;case Ni:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],o=e[n++],i=t[o];if(5!==r.tag||!le(r)){for(;null!=i&&Fi(r,i);)i=t[++o];if(o===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,o),r=r.sibling}}t=!1}return t;case Oi:if(5===e.tag&&ue(e.stateNode,t.value))return!0;break;case Bi:if((5===e.tag||6===e.tag)&&(null!==(e=se(e))&&0<=e.indexOf(t.value)))return!0;break;case ji:if(5===e.tag&&("string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Hi(e){switch(e.$$typeof){case ki:return"<"+(E(e.value)||"Unknown")+">";case Ni:return":has("+(Hi(e)||"")+")";case Oi:return'[role="'+e.value+'"]';case Bi:return'"'+e.value+'"';case ji:return'[data-testname="'+e.value+'"]';default:throw Error(a(365))}}function Vi(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var o=e[r++],i=e[r++],a=t[i];if(5!==o.tag||!le(o)){for(;null!=a&&Fi(o,a);)a=t[++i];if(i===t.length)n.push(o);else for(o=o.child;null!==o;)e.push(o,i),o=o.sibling}}return n}function Gi(e,t){if(!oe)throw Error(a(363));e=Vi(e=Ui(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(5===r.tag)le(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var qi=Math.ceil,Wi=s.ReactCurrentDispatcher,Xi=s.ReactCurrentOwner,Yi=s.ReactCurrentBatchConfig,Ki=0,Qi=null,$i=null,Ji=0,Zi=0,ea=st(0),ta=0,na=null,ra=0,oa=0,ia=0,aa=null,sa=null,la=0,ua=1/0;function ca(){ua=Dt()+500}var da,fa=!1,ha=null,pa=null,ma=!1,ga=null,va=0,ya=0,ba=null,xa=-1,wa=0;function Sa(){return 6&Ki?Dt():-1!==xa?xa:xa=Dt()}function _a(e){return 1&e.mode?2&Ki&&0!==Ji?Ji&-Ji:null!==Jt.transition?(0===wa&&(e=Et,!(4194240&(Et<<=1))&&(Et=64),wa=e),wa):0!==(e=zt)?e:ee():1}function Ea(e,t,n){if(50<ya)throw ya=0,ba=null,Error(a(185));var r=Ta(e,t);return null===r?null:(Rt(r,t,n),(!(2&Ki)||r!==Qi)&&(r===Qi&&(!(2&Ki)&&(oa|=t),4===ta&&La(r,Ji)),Aa(r,n),1===t&&0===Ki&&!(1&e.mode)&&(ca(),Yt&&$t())),r)}function Ta(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Aa(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-wt(i),s=1<<a,l=o[a];-1===l?(!(s&n)||s&r)&&(o[a]=Ct(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=Pt(e,e===Qi?Ji:0);if(0===r)null!==n&&Ot(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ot(n),1===t)0===e.tag?function(e){Yt=!0,Qt(e)}(Ra.bind(null,e)):Qt(Ra.bind(null,e)),ne?re((function(){0===Ki&&$t()})):Nt(Ut,$t),n=null;else{switch(kt(r)){case 1:n=Ut;break;case 4:n=Ft;break;case 16:default:n=Ht;break;case 536870912:n=Vt}n=$a(n,Pa.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Pa(e,t){if(xa=-1,wa=0,6&Ki)throw Error(a(327));var n=e.callbackNode;if(Ga()&&e.callbackNode!==n)return null;var r=Pt(e,e===Qi?Ji:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=Ba(e,r);else{t=r;var o=Ki;Ki|=2;var i=Oa();for((Qi!==e||Ji!==t)&&(ca(),ka(e,t));;)try{Ua();break}catch(l){Na(e,l)}sn(),Wi.current=i,Ki=o,null!==$i?t=0:(Qi=null,Ji=0,t=ta)}if(0!==t){if(2===t&&(0!==(o=Mt(e))&&(r=o,t=Ca(e,o))),1===t)throw n=na,ka(e,0),La(e,r),Aa(e,Dt()),n;if(6===t)La(e,r);else{if(o=e.current.alternate,!(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Wt(i(),o))return!1}catch{return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=Ba(e,r))&&(0!==(i=Mt(e))&&(r=i,t=Ca(e,i))),1===t))throw n=na,ka(e,0),La(e,r),Aa(e,Dt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:Va(e,sa);break;case 3:if(La(e,r),(130023424&r)===r&&10<(t=la+500-Dt())){if(0!==Pt(e,0))break;if(((o=e.suspendedLanes)&r)!==r){Sa(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=q(Va.bind(null,e,sa),t);break}Va(e,sa);break;case 4:if(La(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-wt(r);i=1<<s,(s=t[s])>o&&(o=s),r&=~i}if(r=o,10<(r=(120>(r=Dt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*qi(r/1960))-r)){e.timeoutHandle=q(Va.bind(null,e,sa),r);break}Va(e,sa);break;default:throw Error(a(329))}}}return Aa(e,Dt()),e.callbackNode===n?Pa.bind(null,e):null}function Ca(e,t){var n=aa;return e.current.memoizedState.isDehydrated&&(ka(e,t).flags|=256),2!==(e=Ba(e,t))&&(t=sa,sa=n,null!==t&&Ma(t)),e}function Ma(e){null===sa?sa=e:sa.push.apply(sa,e)}function La(e,t){for(t&=~ia,t&=~oa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-wt(t),r=1<<n;e[n]=-1,t&=~r}}function Ra(e){if(6&Ki)throw Error(a(327));Ga();var t=Pt(e,0);if(!(1&t))return Aa(e,Dt()),null;var n=Ba(e,t);if(0!==e.tag&&2===n){var r=Mt(e);0!==r&&(t=r,n=Ca(e,r))}if(1===n)throw n=na,ka(e,0),La(e,t),Aa(e,Dt()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Va(e,sa),Aa(e,Dt()),null}function Ia(e){null!==ga&&0===ga.tag&&!(6&Ki)&&Ga();var t=Ki;Ki|=1;var n=Yi.transition,r=zt;try{if(Yi.transition=null,zt=1,e)return e()}finally{zt=r,Yi.transition=n,!(6&(Ki=t))&&$t()}}function za(){Zi=ea.current,lt(ea)}function ka(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==X&&(e.timeoutHandle=X,W(n)),null!==$i)for(n=$i.return;null!==n;){var r=n;switch(Hn(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&gt();break;case 3:pr(),lt(ft),lt(dt),xr();break;case 5:gr(r);break;case 4:pr();break;case 13:case 19:lt(vr);break;case 10:un(r.type._context);break;case 22:case 23:za()}n=n.return}if(Qi=e,$i=e=ts(e.current,null),Ji=Zi=t,ta=0,na=null,ia=oa=ra=0,sa=aa=null,null!==hn){for(t=0;t<hn.length;t++)if(null!==(r=(n=hn[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=o,r.next=a}n.pending=r}hn=null}return e}function Na(e,t){for(;;){var n=$i;try{if(sn(),wr.current=mo,Pr){for(var r=Er.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}Pr=!1}if(_r=0,Ar=Tr=Er=null,Cr=!1,Mr=0,Xi.current=null,null===n||null===n.return){ta=1,na=t,$i=null;break}e:{var i=e,s=n.return,l=n,u=t;if(t=Ji,l.flags|=32768,null!==u&&"object"==typeof u&&"function"==typeof u.then){var c=u,d=l,f=d.tag;if(!(1&d.mode)&&(0===f||11===f||15===f)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Mo(s);if(null!==p){p.flags&=-257,Lo(p,s,l,0,t),1&p.mode&&Co(i,c,t),u=c;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(!(1&t)){Co(i,c,t),ja();break e}u=Error(a(426))}else if(qn&&1&l.mode){var v=Mo(s);if(null!==v){!(65536&v.flags)&&(v.flags|=256),Lo(v,s,l,0,t),tr(u);break e}}i=u,4!==ta&&(ta=2),null===aa?aa=[i]:aa.push(i),u=bo(u,l),l=s;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,xn(l,Ao(0,u,t));break e;case 1:i=u;var y=l.type,b=l.stateNode;if(!(128&l.flags)&&("function"==typeof y.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===pa||!pa.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,xn(l,Po(l,i,t));break e}}l=l.return}while(null!==l)}Ha(n)}catch(x){t=x,$i===n&&null!==n&&($i=n=n.return);continue}break}}function Oa(){var e=Wi.current;return Wi.current=mo,null===e?mo:e}function ja(){(0===ta||3===ta||2===ta)&&(ta=4),null===Qi||!(268435455&ra)&&!(268435455&oa)||La(Qi,Ji)}function Ba(e,t){var n=Ki;Ki|=2;var r=Oa();for(Qi===e&&Ji===t||ka(e,t);;)try{Da();break}catch(o){Na(e,o)}if(sn(),Ki=n,Wi.current=r,null!==$i)throw Error(a(261));return Qi=null,Ji=0,ta}function Da(){for(;null!==$i;)Fa($i)}function Ua(){for(;null!==$i&&!jt();)Fa($i)}function Fa(e){var t=da(e.alternate,e,Zi);e.memoizedProps=e.pendingProps,null===t?Ha(e):$i=t,Xi.current=null}function Ha(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=si(n,t)))return n.flags&=32767,void($i=n);if(null===e)return ta=6,void($i=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Oo(n,t,Zi)))return void($i=n);if(null!==(t=t.sibling))return void($i=t);$i=t=e}while(null!==t);0===ta&&(ta=5)}function Va(e,t){var n=zt,r=Yi.transition;try{Yi.transition=null,zt=1,function(e,t,n){do{Ga()}while(null!==ga);if(6&Ki)throw Error(a(327));var r=e.finishedWork,o=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-wt(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,i),e===Qi&&($i=Qi=null,Ji=0),!(2064&r.subtreeFlags)&&!(2064&r.flags)||ma||(ma=!0,$a(Ht,(function(){return Ga(),null}))),i=0!==(15990&r.flags),15990&r.subtreeFlags||i){i=Yi.transition,Yi.transition=null;var s=zt;zt=1;var l=Ki;Ki|=4,Xi.current=null,function(e,t){for(j(e.containerInfo),di=t;null!==di;)if(t=(e=di).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,di=t;else for(;null!==di;){e=di;try{var n=e.alternate;if(1024&e.flags)switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var r=n.memoizedProps,o=n.memoizedState,i=e.stateNode,s=i.getSnapshotBeforeUpdate(e.elementType===e.type?r:tn(e.type,r),o);i.__reactInternalSnapshotBeforeUpdate=s}break;case 3:K&&Ae(e.stateNode.containerInfo);break;default:throw Error(a(163))}}catch(l){Wa(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,di=t;break}di=e.return}n=pi,pi=!1}(e,r),function(e,t){for(di=t;null!==di;){var n=(t=di).deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e;K?Ai(i,o,t):bi(i,o,t);var a=o.alternate;null!==a&&(a.return=null),o.return=null}catch(w){Wa(o,t,w)}}if(n=t.child,12854&t.subtreeFlags&&null!==n)n.return=t,di=n;else for(;null!==di;){t=di;try{var s=t.flags;if(32&s&&K&&we(t.stateNode),512&s){var l=t.alternate;if(null!==l){var u=l.ref;null!==u&&("function"==typeof u?u(null):u.current=null)}}if(8192&s)switch(t.tag){case 13:if(null!==t.memoizedState){var c=t.alternate;(null===c||null===c.memoizedState)&&(la=Dt())}break;case 22:var d=null!==t.memoizedState,f=t.alternate,h=null!==f&&null!==f.memoizedState;if(n=t,K)e:if(r=n,o=d,i=null,K)for(var p=r;;){if(5===p.tag){if(null===i){i=p;var m=p.stateNode;o?Se(m):Ee(p.stateNode,p.memoizedProps)}}else if(6===p.tag){if(null===i){var g=p.stateNode;o?_e(g):Te(g,p.memoizedProps)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===r)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===r)break;for(;null===p.sibling;){if(null===p.return||p.return===r)break e;i===p&&(i=null),p=p.return}i===p&&(i=null),p.sibling.return=p.return,p=p.sibling}if(d&&!h&&1&n.mode){di=n;for(var v=n.child;null!==v;){for(n=di=v;null!==di;){var y=(r=di).child;switch(r.tag){case 0:case 11:case 14:case 15:mi(4,r,r.return);break;case 1:fi(r,r.return);var b=r.stateNode;if("function"==typeof b.componentWillUnmount){var x=r.return;try{b.props=r.memoizedProps,b.state=r.memoizedState,b.componentWillUnmount()}catch(w){Wa(r,x,w)}}break;case 5:fi(r,r.return);break;case 22:if(null!==r.memoizedState){Ii(n);continue}}null!==y?(y.return=r,di=y):Ii(n)}v=v.sibling}}}switch(4102&s){case 2:_i(t),t.flags&=-3;break;case 6:_i(t),t.flags&=-3,Pi(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,Pi(t.alternate,t);break;case 4:Pi(t.alternate,t)}}catch(w){Wa(t,t.return,w)}if(null!==(n=t.sibling)){n.return=t.return,di=n;break}di=t.return}}}(e,r),B(e.containerInfo),e.current=r,Mi(r),Bt(),Ki=l,zt=s,Yi.transition=i}else e.current=r;if(ma&&(ma=!1,ga=e,va=o),i=e.pendingLanes,0===i&&(pa=null),function(e){if(qt&&"function"==typeof qt.onCommitFiberRoot)try{qt.onCommitFiberRoot(Gt,e,void 0,128===(128&e.current.flags))}catch{}}(r.stateNode),Aa(e,Dt()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n(t[r]);if(fa)throw fa=!1,e=ha,ha=null,e;1&va&&0!==e.tag&&Ga(),i=e.pendingLanes,1&i?e===ba?ya++:(ya=0,ba=e):ya=0,$t()}(e,t,n)}finally{Yi.transition=r,zt=n}return null}function Ga(){if(null!==ga){var e=kt(va),t=Yi.transition,n=zt;try{if(Yi.transition=null,zt=16>e?16:e,null===ga)var r=!1;else{if(e=ga,ga=null,va=0,6&Ki)throw Error(a(331));var o=Ki;for(Ki|=4,di=e.current;null!==di;){var i=di,s=i.child;if(16&di.flags){var l=i.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(di=c;null!==di;){var d=di;switch(d.tag){case 0:case 11:case 15:mi(8,d,i)}var f=d.child;if(null!==f)f.return=d,di=f;else for(;null!==di;){var h=(d=di).sibling,p=d.return;if(xi(d),d===c){di=null;break}if(null!==h){h.return=p,di=h;break}di=p}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}di=i}}if(2064&i.subtreeFlags&&null!==s)s.return=i,di=s;else e:for(;null!==di;){if(2048&(i=di).flags)switch(i.tag){case 0:case 11:case 15:mi(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,di=y;break e}di=i.return}}var b=e.current;for(di=b;null!==di;){var x=(s=di).child;if(2064&s.subtreeFlags&&null!==x)x.return=s,di=x;else e:for(s=b;null!==di;){if(2048&(l=di).flags)try{switch(l.tag){case 0:case 11:case 15:gi(9,l)}}catch(S){Wa(l,l.return,S)}if(l===s){di=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,di=w;break e}di=l.return}}if(Ki=o,$t(),qt&&"function"==typeof qt.onPostCommitFiberRoot)try{qt.onPostCommitFiberRoot(Gt,e)}catch{}r=!0}return r}finally{zt=n,Yi.transition=t}}return!1}function qa(e,t,n){yn(e,t=Ao(0,t=bo(n,t),1)),t=Sa(),null!==(e=Ta(e,1))&&(Rt(e,1,t),Aa(e,t))}function Wa(e,t,n){if(3===e.tag)qa(e,e,n);else for(;null!==t;){if(3===t.tag){qa(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===pa||!pa.has(r))){yn(t,e=Po(t,e=bo(n,e),1)),e=Sa(),null!==(t=Ta(t,1))&&(Rt(t,1,e),Aa(t,e));break}}t=t.return}}function Xa(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Sa(),e.pingedLanes|=e.suspendedLanes&n,Qi===e&&(Ji&n)===n&&(4===ta||3===ta&&(130023424&Ji)===Ji&&500>Dt()-la?ka(e,0):ia|=n),Aa(e,t)}function Ya(e,t){0===t&&(1&e.mode?(t=Tt,!(130023424&(Tt<<=1))&&(Tt=4194304)):t=1);var n=Sa();null!==(e=Ta(e,t))&&(Rt(e,t,n),Aa(e,n))}function Ka(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ya(e,n)}function Qa(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ya(e,n)}function $a(e,t){return Nt(e,t)}function Ja(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Za(e,t,n,r){return new Ja(e,t,n,r)}function es(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ts(e,t){var n=e.alternate;return null===n?((n=Za(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ns(e,t,n,r,o,i){var s=2;if(r=e,"function"==typeof e)es(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case c:return rs(n.children,o,i,t);case f:s=8,o|=8;break;case h:return(e=Za(12,n,t,2|o)).elementType=h,e.lanes=i,e;case v:return(e=Za(13,n,t,o)).elementType=v,e.lanes=i,e;case y:return(e=Za(19,n,t,o)).elementType=y,e.lanes=i,e;case w:return os(n,o,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case p:s=10;break e;case m:s=9;break e;case g:s=11;break e;case b:s=14;break e;case x:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Za(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function rs(e,t,n,r){return(e=Za(7,e,r,t)).lanes=n,e}function os(e,t,n,r){return(e=Za(22,e,r,t)).elementType=w,e.lanes=n,e.stateNode={},e}function is(e,t,n){return(e=Za(6,e,null,t)).lanes=n,e}function as(e,t,n){return(t=Za(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ss(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=X,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lt(0),this.expirationTimes=Lt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lt(0),this.identifierPrefix=r,this.onRecoverableError=o,$&&(this.mutableSourceEagerHydrationData=null)}function ls(e,t,n,r,o,i,a,s,l){return e=new ss(e,t,n,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Za(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null},mn(i),e}function us(e){if(!e)return ct;e:{if(A(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(mt(n))return yt(e,n,t)}return t}function cs(e){var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return null===(e=M(t))?null:e.stateNode}function ds(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function fs(e,t){ds(e,t),(e=e.alternate)&&ds(e,t)}function hs(e){return null===(e=M(e))?null:e.stateNode}function ps(){return null}return da=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ft.current)Bo=!0;else{if(!(e.lanes&n)&&!(128&t.flags))return Bo=!1,function(e,t,n){switch(t.tag){case 3:Yo(t),er();break;case 5:mr(t);break;case 1:mt(t.type)&&bt(t);break;case 4:hr(t,t.stateNode.containerInfo);break;case 10:ln(0,t.type._context,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ut(vr,1&vr.current),t.flags|=128,null):n&t.child.childLanes?Jo(e,t,n):(ut(vr,1&vr.current),null!==(e=ai(e,t,n))?e.sibling:null);ut(vr,1&vr.current);break;case 19:if(r=0!==(n&t.childLanes),128&e.flags){if(r)return ii(e,t,n);t.flags|=128}var o=t.memoizedState;if(null!==o&&(o.rendering=null,o.tail=null,o.lastEffect=null),ut(vr,vr.current),r)break;return null;case 22:case 23:return t.lanes=0,Vo(e,t,n)}return ai(e,t,n)}(e,t,n);Bo=!!(131072&e.flags)}else Bo=!1,qn&&1048576&t.flags&&Un(t,zn,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var o=pt(t,dt.current);dn(t,n),o=zr(null,t,r,e,o,n);var i=kr();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mt(r)?(i=!0,bt(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,mn(t),o.updater=Tn,t.stateNode=o,o._reactInternals=t,Mn(t,r,e,n),t=Xo(null,t,r,!0,i,n)):(t.tag=0,qn&&i&&Fn(t),Do(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return es(e)?1:0;if(null!=e){if((e=e.$$typeof)===g)return 11;if(e===b)return 14}return 2}(r),e=tn(r,e),o){case 0:t=qo(null,t,r,e,n);break e;case 1:t=Wo(null,t,r,e,n);break e;case 11:t=Uo(null,t,r,e,n);break e;case 14:t=Fo(null,t,r,tn(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,qo(e,t,r,o=t.elementType===r?o:tn(r,o),n);case 1:return r=t.type,o=t.pendingProps,Wo(e,t,r,o=t.elementType===r?o:tn(r,o),n);case 3:e:{if(Yo(t),null===e)throw Error(a(387));r=t.pendingProps,o=(i=t.memoizedState).element,gn(e,t),wn(t,r,null,n);var s=t.memoizedState;if(r=s.element,$&&i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ko(e,t,r,n,o=Error(a(423)));break e}if(r!==o){t=Ko(e,t,r,n,o=Error(a(424)));break e}for($&&(Gn=He(t.stateNode.containerInfo),Vn=t,qn=!0,Xn=null,Wn=!1),n=sr(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(er(),r===o){t=ai(e,t,n);break e}Do(e,t,r,n)}t=t.child}return t;case 5:return mr(t),null===e&&$n(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,V(r,o)?s=null:null!==i&&V(r,i)&&(t.flags|=32),Go(e,t),Do(e,t,s,n),t.child;case 6:return null===e&&$n(t),null;case 13:return Jo(e,t,n);case 4:return hr(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ar(t,null,r,n):Do(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Uo(e,t,r,o=t.elementType===r?o:tn(r,o),n);case 7:return Do(e,t,t.pendingProps,n),t.child;case 8:case 12:return Do(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,ln(0,r,s=o.value),null!==i)if(Wt(i.value,s)){if(i.children===o.children&&!ft.current){t=ai(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){s=i.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===i.tag){(u=vn(-1,n&-n)).tag=2;var c=i.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=n,null!==(u=i.alternate)&&(u.lanes|=n),cn(i.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),cn(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}Do(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,dn(t,n),r=r(o=fn(o)),t.flags|=1,Do(e,t,r,n),t.child;case 14:return o=tn(r=t.type,t.pendingProps),Fo(e,t,r,o=tn(r.type,o),n);case 15:return Ho(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:tn(r,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,mt(r)?(e=!0,bt(t)):e=!1,dn(t,n),Pn(t,r,o),Mn(t,r,o,n),Xo(null,t,r,!0,e,n);case 19:return ii(e,t,n);case 22:return Vo(e,t,n)}throw Error(a(156,t.tag))},t.attemptContinuousHydration=function(e){13===e.tag&&(Ea(e,134217728,Sa()),fs(e,134217728))},t.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Sa(),n=_a(e);Ea(e,n,t),fs(e,n)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=At(t.pendingLanes);0!==n&&(It(t,1|n),Aa(t,Dt()),!(6&Ki)&&(ca(),$t()))}break;case 13:var r=Sa();Ia((function(){return Ea(e,1,r)})),fs(e,1)}},t.batchedUpdates=function(e,t){var n=Ki;Ki|=1;try{return e(t)}finally{0===(Ki=n)&&(ca(),Yt&&$t())}},t.createComponentSelector=function(e){return{$$typeof:ki,value:e}},t.createContainer=function(e,t,n,r,o,i,a){return ls(e,t,!1,null,0,r,0,i,a)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Ni,value:e}},t.createHydrationContainer=function(e,t,n,r,o,i,a,s,l){return(e=ls(n,r,!0,e,0,i,0,s,l)).context=us(null),n=e.current,(i=vn(r=Sa(),o=_a(n))).callback=t??null,yn(n,i),e.current.lanes=o,Rt(e,o,r),Aa(e,r),e},t.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:u,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},t.createRoleSelector=function(e){return{$$typeof:Oi,value:e}},t.createTestNameSelector=function(e){return{$$typeof:ji,value:e}},t.createTextSelector=function(e){return{$$typeof:Bi,value:e}},t.deferredUpdates=function(e){var t=zt,n=Yi.transition;try{return Yi.transition=null,zt=16,e()}finally{zt=t,Yi.transition=n}},t.discreteUpdates=function(e,t,n,r,o){var i=zt,a=Yi.transition;try{return Yi.transition=null,zt=1,e(t,n,r,o)}finally{zt=i,Yi.transition=a,0===Ki&&ca()}},t.findAllNodes=Gi,t.findBoundingRects=function(e,t){if(!oe)throw Error(a(363));t=Gi(e,t),e=[];for(var n=0;n<t.length;n++)e.push(ae(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,o=r+n.width,i=n.y,s=i+n.height,l=t-1;0<=l;l--)if(t!==l){var u=e[l],c=u.x,d=c+u.width,f=u.y,h=f+u.height;if(r>=c&&i>=f&&o<=d&&s<=h){e.splice(t,1);break}if(!(r!==c||n.width!==u.width||h<i||f>s)){f>i&&(u.height+=f-i,u.y=i),h<s&&(u.height=s-f),e.splice(t,1);break}if(!(i!==f||n.height!==u.height||d<r||c>o)){c>r&&(u.width+=c-r,u.x=r),d<o&&(u.width=o-c),e.splice(t,1);break}}return e},t.findHostInstance=cs,t.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=C(e))?R(e):null)?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return cs(e)},t.flushControlled=function(e){var t=Ki;Ki|=1;var n=Yi.transition,r=zt;try{Yi.transition=null,zt=1,e()}finally{zt=r,Yi.transition=n,0===(Ki=t)&&(ca(),$t())}},t.flushPassiveEffects=Ga,t.flushSync=Ia,t.focusWithin=function(e,t){if(!oe)throw Error(a(363));for(t=Vi(e=Ui(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!le(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},t.getCurrentUpdatePriority=function(){return zt},t.getFindAllNodesFailureDescription=function(e,t){if(!oe)throw Error(a(363));var n=0,r=[];e=[Ui(e),0];for(var o=0;o<e.length;){var i=e[o++],s=e[o++],l=t[s];if((5!==i.tag||!le(i))&&(Fi(i,l)&&(r.push(Hi(l)),++s>n&&(n=s)),s<t.length))for(i=i.child;null!==i;)e.push(i,s),i=i.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Hi(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},t.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?k(e.child.stateNode):e.child.stateNode:null},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:s.ReactCurrentDispatcher,findHostInstanceByFiber:hs,findFiberByHostInstance:e.findFiberByHostInstance||ps,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Gt=t.inject(e),qt=t}catch{}e=!!t.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,t,n,r){if(!oe)throw Error(a(363));e=Gi(e,t);var o=de(e,n,r).disconnect;return{disconnect:function(){o()}}},t.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},t.runWithPriority=function(e,t){var n=zt;try{return zt=e,t()}finally{zt=n}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,t,n,r){var o=t.current,i=Sa(),a=_a(o);return n=us(n),null===t.context?t.context=n:t.pendingContext=n,(t=vn(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),yn(o,t),null!==(e=Ea(o,a,i))&&bn(e,o,a),a},t};var f=l.exports;const h=(0,r.g)(f),p=e=>"object"==typeof e&&"function"==typeof e.then,m=[];function g(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let o=0;o<r;o++)if(!n(e[o],t[o]))return!1;return!0}const v=(e,t,n)=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===t&&(t=[e]);for(const i of m)if(g(t,i.keys,i.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return r.lifespan&&r.lifespan>0&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.remove,r.lifespan)),i.response;if(!n)throw i.promise}const o={keys:t,equal:r.equal,remove:()=>{const e=m.indexOf(o);-1!==e&&m.splice(e,1)},promise:(p(e)?e:e(...t)).then((e=>{o.response=e,r.lifespan&&r.lifespan>0&&(o.timeout=setTimeout(o.remove,r.lifespan))})).catch((e=>o.error=e))};if(m.push(o),!n)throw o.promise}(e,t,!1,n),y={},b=e=>{Object.assign(y,e)};var x,w;const S=e=>"colorSpace"in e||"outputColorSpace"in e,_=()=>{var e;return null!=(e=y.ColorManagement)?e:null},E=e=>e&&e.isOrthographicCamera,T=typeof window<"u"&&(null!=(x=window.document)&&x.createElement||"ReactNative"===(null==(w=window.navigator)?void 0:w.product))?o.useLayoutEffect:o.useEffect;function A(e){const t=o.useRef(e);return T((()=>{t.current=e}),[e]),t}function P(e){let{set:t}=e;return T((()=>(t(new Promise((()=>null))),()=>t(!1))),[t]),null}class C extends o.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}C.getDerivedStateFromError=()=>({error:!0});const M="__default",L=new Map,R=e=>e&&!!e.memoized&&!!e.changes;function I(e){var t;const n=typeof window<"u"?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const z=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function k(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const N={obj:e=>e===Object(e)&&!N.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:r="reference",strict:o=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!=typeof t||!!e!=!!t)return!1;if(N.str(e)||N.num(e))return e===t;const i=N.obj(e);if(i&&"reference"===r)return e===t;const a=N.arr(e);if(a&&"reference"===n)return e===t;if((a||i)&&e===t)return!0;let s;for(s in e)if(!(s in t))return!1;if(i&&"shallow"===n&&"shallow"===r){for(s in o?t:e)if(!N.equ(e[s],t[s],{strict:o,objects:"reference"}))return!1}else for(s in o?t:e)if(e[s]!==t[s])return!1;if(N.und(s)){if(a&&0===e.length&&0===t.length||i&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function O(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function j(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),o=r.pop();return n=r.reduce(((e,t)=>e[t]),e),{target:n,key:o}}return{target:n,key:t}}const B=/-\d+$/;function D(e,t,n){if(N.str(n)){if(B.test(n)){const t=n.replace(B,""),{target:r,key:o}=j(e,t);Array.isArray(r[o])||(r[o]=[])}const{target:r,key:o}=j(e,n);t.__r3f.previousAttach=r[o],r[o]=t}else t.__r3f.previousAttach=n(e,t)}function U(e,t,n){var r,o;if(N.str(n)){const{target:r,key:o}=j(e,n),i=t.__r3f.previousAttach;void 0===i?delete r[o]:r[o]=i}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(o=t.__r3f)||delete o.previousAttach}function F(e,t){let{children:n,key:r,ref:o,...i}=t,{children:a,key:s,ref:l,...u}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var d;const f=null!=(d=e?.__r3f)?d:{},h=Object.entries(i),p=[];if(c){const e=Object.keys(u);for(let t=0;t<e.length;t++)i.hasOwnProperty(e[t])||h.unshift([e[t],M+"remove"])}h.forEach((t=>{let[n,r]=t;var o;if(null!=(o=e.__r3f)&&o.primitive&&"object"===n||N.equ(r,u[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return p.push([n,r,!0,[]]);let a=[];n.includes("-")&&(a=n.split("-")),p.push([n,r,!1,a]);for(const e in i){const t=i[e];e.startsWith(`${n}-`)&&p.push([e,t,!1,e.split("-")])}}));const m={...i};return f.memoizedProps&&f.memoizedProps.args&&(m.args=f.memoizedProps.args),f.memoizedProps&&f.memoizedProps.attach&&(m.attach=f.memoizedProps.attach),{memoized:m,changes:p}}const H=typeof process<"u"&&!1;function V(e,t){var n,o,i;const a=null!=(n=e.__r3f)?n:{},s=a.root,l=null!=(o=null==s||null==s.getState?void 0:s.getState())?o:{},{memoized:u,changes:c}=R(t)?t:F(e,t),d=a.eventCount;e.__r3f&&(e.__r3f.memoizedProps=u);for(let f=0;f<c.length;f++){let[t,n,o,i]=c[f];if(S(e)){const e="srgb",r="srgb-linear";"encoding"===t?(t="colorSpace",n=3001===n?e:r):"outputEncoding"===t&&(t="outputColorSpace",n=3001===n?e:r)}let s=e,u=s[t];if(i.length&&(u=i.reduce(((e,t)=>e[t]),e),!u||!u.set)){const[n,...r]=i.reverse();s=r.reverse().reduce(((e,t)=>e[t]),e),t=n}if(n===M+"remove")if(s.constructor){let e=L.get(s.constructor);e||(e=new s.constructor,L.set(s.constructor,e)),n=e[t]}else n=0;if(o)n?a.handlers[t]=n:delete a.handlers[t],a.eventCount=Object.keys(a.handlers).length;else if(u&&u.set&&(u.copy||u instanceof r.L)){if(Array.isArray(n))u.fromArray?u.fromArray(n):u.set(...n);else if(u.copy&&n&&n.constructor&&(H?u.constructor.name===n.constructor.name:u.constructor===n.constructor))u.copy(n);else if(void 0!==n){const e=u instanceof r.i;!e&&u.setScalar?u.setScalar(n):u instanceof r.L&&n instanceof r.L?u.mask=n.mask:u.set(n),!_()&&!l.linear&&e&&u.convertSRGBToLinear()}}else if(s[t]=n,s[t]instanceof r.T&&s[t].format===r.d&&s[t].type===r.U){const e=s[t];S(e)&&S(l.gl)?e.colorSpace=l.gl.outputColorSpace:e.encoding=l.gl.outputEncoding}G(e)}if(a.parent&&e.raycast&&d!==a.eventCount){const t=k(e).getState().internal,n=t.interaction.indexOf(e);n>-1&&t.interaction.splice(n,1),a.eventCount&&t.interaction.push(e)}return!(1===c.length&&"onUpdate"===c[0][0])&&c.length&&null!=(i=e.__r3f)&&i.parent&&q(e),e}function G(e){var t,n;const r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function q(e){null==e.onUpdate||e.onUpdate(e)}function W(e,t){e.manual||(E(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function X(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Y(e,t,n,r){const o=n.get(t);o&&(n.delete(t),0===n.size&&(e.delete(r),o.target.releasePointerCapture(r)))}function K(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const r=e.eventObject.__r3f,o=r?.handlers;if(n.hovered.delete(X(e)),null!=r&&r.eventCount){const n={...e,intersections:t};null==o.onPointerOut||o.onPointerOut(n),null==o.onPointerLeave||o.onPointerLeave(n)}}}function o(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))}))}}return function(a){const{onPointerMissed:s,internal:l}=e.getState();l.lastEvent.current=a;const u="onPointerMove"===i,c="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,d=function(t,n){const r=e.getState(),o=new Set,i=[],a=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<a.length;e++){const t=z(a[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let s=a.flatMap((function(e){const n=z(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r})).sort(((e,t)=>{const n=z(e.object),r=z(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=X(e);return!o.has(t)&&(o.add(t),!0)}));r.events.filter&&(s=r.events.filter(s,r));for(const e of s){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&i.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())o.has(X(e.intersection))||i.push(e.intersection);return i}(a,u?t:void 0),f=c?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],o=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}(a):0;"onPointerDown"===i&&(l.initialClick=[a.offsetX,a.offsetY],l.initialHits=d.map((e=>e.eventObject))),c&&!d.length&&f<=2&&(o(a,l.interaction),s&&s(a)),u&&n(d),function(t,o,i,a){const s=e.getState();if(t.length){const e={stopped:!1};for(const l of t){const u=z(l.object)||s,{raycaster:c,pointer:d,camera:f,internal:h}=u,p=new r.b(d.x,d.y,0).unproject(f),m=e=>{var t,n;return null!=(t=null==(n=h.capturedMap.get(e))?void 0:n.has(l.eventObject))&&t},g=e=>{const t={intersection:l,target:o.target};h.capturedMap.has(e)?h.capturedMap.get(e).set(l.eventObject,t):h.capturedMap.set(e,new Map([[l.eventObject,t]])),o.target.setPointerCapture(e)},v=e=>{const t=h.capturedMap.get(e);t&&Y(h.capturedMap,l.eventObject,t,e)};let y={};for(let e in o){let t=o[e];"function"!=typeof t&&(y[e]=t)}let b={...l,...y,pointer:d,intersections:t,stopped:e.stopped,delta:i,unprojectedPoint:p,ray:c.ray,camera:f,stopPropagation(){const r="pointerId"in o&&h.capturedMap.get(o.pointerId);(!r||r.has(l.eventObject))&&(b.stopped=e.stopped=!0,h.hovered.size&&Array.from(h.hovered.values()).find((e=>e.eventObject===l.eventObject)))&&n([...t.slice(0,t.indexOf(l)),l])},target:{hasPointerCapture:m,setPointerCapture:g,releasePointerCapture:v},currentTarget:{hasPointerCapture:m,setPointerCapture:g,releasePointerCapture:v},nativeEvent:o};if(a(b),!0===e.stopped)break}}}(d,a,f,(function(e){const t=e.eventObject,n=t.__r3f,r=n?.handlers;if(null!=n&&n.eventCount)if(u){if(r.onPointerOver||r.onPointerEnter||r.onPointerOut||r.onPointerLeave){const t=X(e),n=l.hovered.get(t);n?n.stopped&&e.stopPropagation():(l.hovered.set(t,e),null==r.onPointerOver||r.onPointerOver(e),null==r.onPointerEnter||r.onPointerEnter(e))}null==r.onPointerMove||r.onPointerMove(e)}else{const n=r[i];n?(!c||l.initialHits.includes(t))&&(o(a,l.interaction.filter((e=>!l.initialHits.includes(e)))),n(e)):c&&l.initialHits.includes(t)&&o(a,l.interaction.filter((e=>!l.initialHits.includes(e))))}}))}}}}const Q=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],$=e=>!(null==e||!e.render),J=o.createContext(null);let Z,ee,te,ne=new Set,re=new Set,oe=new Set;function ie(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function ae(e,t){switch(e){case"before":return ie(ne,t);case"after":return ie(re,t);case"tail":return ie(oe,t)}}function se(e,t,n){let r=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),ee=t.internal.subscribers,Z=0;Z<ee.length;Z++)te=ee[Z],te.ref.current(te.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function le(){const e=o.useContext(J);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function ue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return le()(e,t)}function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=le(),r=n.getState().internal.subscribe,o=A(e);return T((()=>r(o,t,n)),[t,r,n]),null}const de=new Map,{invalidate:fe,advance:he}=function(e){let t,n,r,o=!1;function i(a){n=requestAnimationFrame(i),o=!0,t=0,ae("before",a);for(const n of e.values()){var s;r=n.store.getState(),r.internal.active&&("always"===r.frameloop||r.internal.frames>0)&&(null==(s=r.gl.xr)||!s.isPresenting)&&(t+=se(a,r))}if(ae("after",a),0===t)return ae("tail",a),o=!1,cancelAnimationFrame(n)}return{loop:i,invalidate:function t(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var a;if(!n)return e.forEach((e=>t(e.store.getState(),r)));null!=(a=n.gl.xr)&&a.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=Math.min(60,n.internal.frames+r),o||(o=!0,requestAnimationFrame(i)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;if(n&&ae("before",t),r)se(t,r,o);else for(const i of e.values())se(t,i.store.getState());n&&ae("after",t)}}}(de),{reconciler:pe,applyProps:me}=function(e,t){function n(e,t,n){let o,{args:i=[],attach:a,...s}=t,l=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===s.object)throw new Error("R3F: Primitives without 'object' are invalid!");o=O(s.object,{type:e,root:n,attach:a,primitive:!0})}else{const t=y[l];if(!t)throw new Error(`R3F: ${l} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(i))throw new Error("R3F: The args prop must be an array!");o=O(new t(...i),{type:e,root:n,attach:a,memoizedProps:{args:i}})}return void 0===o.__r3f.attach&&(o instanceof r.h?o.__r3f.attach="geometry":o instanceof r.M&&(o.__r3f.attach="material")),"inject"!==l&&V(o,s),o}function o(e,t){let n=!1;var r,o;t&&(null!=(r=t.__r3f)&&r.attach?D(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(o=e.__r3f)||o.objects.push(t),t.__r3f||O(t,{}),t.__r3f.parent=e,q(t),G(t))}function i(e,t,n){let r=!1;if(t){var o,i;if(null!=(o=t.__r3f)&&o.attach)D(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});const o=e.children.filter((e=>e!==t)),i=o.indexOf(n);e.children=[...o.slice(0,i),t,...o.slice(i)],r=!0}r||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||O(t,{}),t.__r3f.parent=e,q(t),G(t)}}function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach((e=>l(t,e,n)))}function l(e,t,n){if(t){var r,o,i;if(t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(o=t.__r3f)&&o.attach)U(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var s;e.remove(t),null!=(s=t.__r3f)&&s.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,r)=>{(e.eventObject===t||e.object===t)&&n.hovered.delete(r)})),n.capturedMap.forEach(((e,r)=>{Y(n.capturedMap,t,e,r)}))}(k(t),t)}const u=null==(i=t.__r3f)?void 0:i.primitive,c=!u&&(void 0===n?null!==t.dispose:n);var l;if(!u)a(null==(l=t.__r3f)?void 0:l.objects,t,c),a(t.children,t,c);if(delete t.__r3f,c&&t.dispose&&"Scene"!==t.type){const e=()=>{try{t.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?d.unstable_scheduleCallback(d.unstable_IdlePriority,e):e()}G(e)}}const u=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:h({createInstance:n,removeChild:l,appendChild:o,appendInitialChild:o,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,o(n,t))},removeChildFromContainer:(e,t)=>{t&&l(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const r=e.getState().scene;r.__r3f&&i(r,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;return!!(null!=(t=e?.__r3f)?t:{}).handlers},prepareUpdate(e,t,n,r){var o;if((null!=(o=e?.__r3f)?o:{}).primitive&&r.object&&r.object!==e)return[!0];{const{args:t=[],children:o,...i}=r,{args:a=[],children:s,...l}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==a[t])))return[!0];const u=F(e,i,l,!0);return u.changes.length?[!1,u]:null}},commitUpdate(e,t,r,i,a,s){let[u,c]=t;u?function(e,t,r,i){var a;const s=null==(a=e.__r3f)?void 0:a.parent;if(!s)return;const u=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&o(u,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>o(u,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||l(s,e),u.parent&&(u.__r3f.autoRemovedBeforeAppend=!0),o(s,u),u.raycast&&u.__r3f.eventCount&&k(u).getState().internal.interaction.push(u),[i,i.alternate].forEach((e=>{null!==e&&(e.stateNode=u,e.ref&&("function"==typeof e.ref?e.ref(u):e.ref.current=u))}))}(e,r,a,s):V(e,c)},commitMount(e,t,n,r){var o;const i=null!=(o=e.__r3f)?o:{};e.raycast&&i.handlers&&i.eventCount&&k(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>O(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:r}=null!=(t=e.__r3f)?t:{};n&&r&&U(r,e,n),e.isObject3D&&(e.visible=!1),G(e)},unhideInstance(e,t){var n;const{attach:r,parent:o}=null!=(n=e.__r3f)?n:{};r&&o&&D(o,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),G(e)},createTextInstance:u,hideTextInstance:u,unhideTextInstance:u,getCurrentEventPriority:()=>t?t():s.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&N.fun(performance.now)?performance.now:N.fun(Date.now)?Date.now:()=>0,scheduleTimeout:N.fun(setTimeout)?setTimeout:void 0,cancelTimeout:N.fun(clearTimeout)?clearTimeout:void 0}),applyProps:V}}(0,(function(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return s.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return s.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return s.ContinuousEventPriority;default:return s.DefaultEventPriority}})),ge={objects:"shallow",strict:!1},ve=(e,t)=>{const n="function"==typeof e?e(t):e;return $(n)?n:new r.W({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function ye(e){const t=de.get(e),n=t?.fiber,i=t?.store;t&&console.warn("R3F.createRoot should only be called once!");const a="function"==typeof reportError?reportError:console.error,l=i||((e,t)=>{const n=(0,r.c)(((n,i)=>{const a=new r.b,s=new r.b,l=new r.b;function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i().size;const{width:o,height:u,top:c,left:d}=n,f=o/u;t instanceof r.b?l.copy(t):l.set(...t);const h=e.getWorldPosition(a).distanceTo(l);if(E(e))return{width:o/e.zoom,height:u/e.zoom,top:c,left:d,factor:1,distance:h,aspect:f};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*h,r=n*(o/u);return{width:r,height:n,top:c,left:d,factor:o/r,distance:h,aspect:f}}}let c;const d=e=>n((t=>({performance:{...t.performance,current:e}}))),f=new r.V;return{set:n,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(i(),t)},advance:(e,n)=>t(e,n,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new r.j,pointer:f,mouse:f,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=i();c&&clearTimeout(c),e.performance.current!==e.performance.min&&d(e.performance.min),c=setTimeout((()=>d(i().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:u},setEvents:e=>n((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,r,o,a)=>{const l=i().camera,c={width:e,height:t,top:o||0,left:a||0,updateStyle:r};n((e=>({size:c,viewport:{...e.viewport,...u(l,s,c)}})))},setDpr:e=>n((t=>{const n=I(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=i().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:o.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const r=i().internal;return r.priority=r.priority+(t>0?1:0),r.subscribers.push({ref:e,priority:t,store:n}),r.subscribers=r.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=i().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}}})),i=n.getState();let a=i.size,s=i.viewport.dpr,l=i.camera;return n.subscribe((()=>{const{camera:e,size:t,viewport:r,gl:o,set:i}=n.getState();if(t.width!==a.width||t.height!==a.height||r.dpr!==s){var u;a=t,s=r.dpr,W(e,t),o.setPixelRatio(r.dpr);const n=null!=(u=t.updateStyle)?u:typeof HTMLCanvasElement<"u"&&o.domElement instanceof HTMLCanvasElement;o.setSize(t.width,t.height,n)}e!==l&&(l=e,i((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),n.subscribe((t=>e(t))),n})(fe,he),u=n||pe.createContainer(l,s.ConcurrentRoot,null,!1,null,"",a,null);t||de.set(e,{fiber:u,store:l});let c,d,f=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:o,scene:i,events:a,onCreated:s,shadows:u=!1,linear:h=!1,flat:p=!1,legacy:m=!1,orthographic:g=!1,frameloop:v="always",dpr:y=[1,2],performance:b,raycaster:x,camera:w,onPointerMissed:S}=t,E=l.getState(),T=E.gl;E.gl||E.set({gl:T=ve(n,e)});let A=E.raycaster;A||E.set({raycaster:A=new r.R});const{params:P,...C}=x||{};if(N.equ(C,A,ge)||me(A,{...C}),N.equ(P,A.params,ge)||me(A,{params:{...A.params,...P}}),!E.camera||E.camera===d&&!N.equ(d,w,ge)){d=w;const e=w instanceof r.C,t=e?w:g?new r.O(0,0,0,0,.1,1e3):new r.P(75,0,.1,1e3);e||(t.position.z=5,w&&me(t,w),!E.camera&&!(null!=w&&w.rotation)&&t.lookAt(0,0,0)),E.set({camera:t}),A.camera=t}if(!E.scene){let e;i instanceof r.S?e=i:(e=new r.S,i&&me(e,i)),E.set({scene:O(e)})}if(!E.xr){var M;const e=(e,t)=>{const n=l.getState();"never"!==n.frameloop&&he(e,!0,n,t)},t=()=>{const t=l.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||fe(t)},n={connect(){const e=l.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=l.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(M=T.xr)?void 0:M.addEventListener)&&n.connect(),E.set({xr:n})}if(T.shadowMap){const e=T.shadowMap.enabled,t=T.shadowMap.type;if(T.shadowMap.enabled=!!u,N.boo(u))T.shadowMap.type=r.a;else if(N.str(u)){var L;const e={basic:r.B,percentage:r.e,soft:r.a,variance:r.f};T.shadowMap.type=null!=(L=e[u])?L:r.a}else N.obj(u)&&Object.assign(T.shadowMap,u);(e!==T.shadowMap.enabled||t!==T.shadowMap.type)&&(T.shadowMap.needsUpdate=!0)}const R=_();R&&("enabled"in R?R.enabled=!m:"legacyMode"in R&&(R.legacyMode=m)),f||me(T,{outputEncoding:h?3e3:3001,toneMapping:p?r.N:r.A}),E.legacy!==m&&E.set((()=>({legacy:m}))),E.linear!==h&&E.set((()=>({linear:h}))),E.flat!==p&&E.set((()=>({flat:p}))),n&&!N.fun(n)&&!$(n)&&!N.equ(n,T,ge)&&me(T,n),a&&!E.events.handlers&&E.set({events:a(l)});const z=function(e,t){const n=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:e,height:r,top:o,left:i,updateStyle:a=n}=t;return{width:e,height:r,top:o,left:i,updateStyle:a}}if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:r,top:o,left:i}=e.parentElement.getBoundingClientRect();return{width:t,height:r,top:o,left:i,updateStyle:n}}return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(e,o);return N.equ(z,E.size,ge)||E.setSize(z.width,z.height,z.updateStyle,z.top,z.left),y&&E.viewport.dpr!==I(y)&&E.setDpr(y),E.frameloop!==v&&E.setFrameloop(v),E.onPointerMissed||E.set({onPointerMissed:S}),b&&!N.equ(b,E.performance,ge)&&E.set((e=>({performance:{...e.performance,...b}}))),c=s,f=!0,this},render(t){return f||this.configure(),pe.updateContainer(o.createElement(be,{store:l,children:t,onCreated:c,rootElement:e}),u,null,(()=>{})),l},unmount(){xe(e)}}}function be(e){let{store:t,children:n,onCreated:r,rootElement:i}=e;return T((()=>{const e=t.getState();e.set((e=>({internal:{...e.internal,active:!0}}))),r&&r(e),t.getState().events.connected||null==e.events.connect||e.events.connect(i)}),[]),o.createElement(J.Provider,{value:t},n)}function xe(e,t){const n=de.get(e),r=n?.fiber;if(r){const o=n?.store.getState();o&&(o.internal.active=!1),pe.updateContainer(null,r,null,(()=>{o&&setTimeout((()=>{try{var n,r,i,a;null==o.events.disconnect||o.events.disconnect(),null==(n=o.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(i=o.gl)||null==i.forceContextLoss||i.forceContextLoss(),null!=(a=o.gl)&&a.xr&&o.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(o),de.delete(e),t&&t(e)}catch{}}),500)}))}}function we(e,t,n){return o.createElement(Se,{key:t.uuid,children:e,container:t,state:n})}function Se(e){let{state:t={},children:n,container:i}=e;const{events:a,size:s,...l}=t,u=le(),[c]=o.useState((()=>new r.R)),[d]=o.useState((()=>new r.V)),f=o.useCallback(((e,t)=>{const n={...e};let o;if(Object.keys(e).forEach((r=>{(Q.includes(r)||e[r]!==t[r]&&t[r])&&delete n[r]})),t&&s){const n=t.camera;o=e.viewport.getCurrentViewport(n,new r.b,s),n!==e.camera&&W(n,s)}return{...n,scene:i,raycaster:c,pointer:d,mouse:d,previousRoot:u,events:{...e.events,...t?.events,...a},size:{...e.size,...s},viewport:{...e.viewport,...o},...l}}),[t]),[h]=o.useState((()=>{const e=u.getState();return(0,r.c)(((t,n)=>({...e,scene:i,raycaster:c,pointer:d,mouse:d,previousRoot:u,events:{...e.events,...a},size:{...e.size,...s},...l,set:t,get:n,setEvents:e=>t((t=>({...t,events:{...t.events,...e}})))})))}));return o.useEffect((()=>{const e=u.subscribe((e=>h.setState((t=>f(e,t)))));return()=>{e(),h.destroy()}}),[]),o.useEffect((()=>{h.setState((e=>f(u.getState(),e)))}),[f]),o.createElement(o.Fragment,null,pe.createPortal(o.createElement(J.Provider,{value:h},n),h,null))}function _e(e,t,n){var r,o,i,a,s;function l(){var u=Date.now()-a;u<t&&u>=0?r=setTimeout(l,t-u):(r=null,n||(s=e.apply(i,o),i=o=null))}null==t&&(t=100);var u=function(){i=this,o=arguments,a=Date.now();var u=n&&!r;return r||(r=setTimeout(l,t)),u&&(s=e.apply(i,o),i=o=null),s};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(s=e.apply(i,o),i=o=null,clearTimeout(r),r=null)},u}pe.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:o.version}),_e.debounce=_e;var Ee=_e;const Te=(0,r.g)(Ee);function Ae(e){let{debounce:t,scroll:n,polyfill:r,offsetSize:i}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e;const a=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,l]=(0,o.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=(0,o.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s}),c=t?"number"==typeof t?t:t.scroll:null,d=t?"number"==typeof t?t:t.resize:null,f=(0,o.useRef)(!1);(0,o.useEffect)((()=>(f.current=!0,()=>{f.current=!1})));const[h,p,m]=(0,o.useMemo)((()=>{const e=()=>{if(!u.current.element)return;const{left:e,top:t,width:n,height:r,bottom:o,right:a,x:s,y:c}=u.current.element.getBoundingClientRect(),d={left:e,top:t,width:n,height:r,bottom:o,right:a,x:s,y:c};u.current.element instanceof HTMLElement&&i&&(d.height=u.current.element.offsetHeight,d.width=u.current.element.offsetWidth),Object.freeze(d),f.current&&!Me(u.current.lastBounds,d)&&l(u.current.lastBounds=d)};return[e,d?Te(e,d):e,c?Te(e,c):e]}),[l,i,c,d]);function g(){u.current.scrollContainers&&(u.current.scrollContainers.forEach((e=>e.removeEventListener("scroll",m,!0))),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null)}function v(){u.current.element&&(u.current.resizeObserver=new a(m),u.current.resizeObserver.observe(u.current.element),n&&u.current.scrollContainers&&u.current.scrollContainers.forEach((e=>e.addEventListener("scroll",m,{capture:!0,passive:!0}))))}return function(e,t){(0,o.useEffect)((()=>{if(t){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}}),[e,t])}(m,!!n),function(e){(0,o.useEffect)((()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[e])}(p),(0,o.useEffect)((()=>{g(),v()}),[n,m,p]),(0,o.useEffect)((()=>g),[]),[e=>{!e||e===u.current.element||(g(),u.current.element=e,u.current.scrollContainers=Pe(e),v())},s,h]}function Pe(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:o}=window.getComputedStyle(e);return[n,r,o].some((e=>"auto"===e||"scroll"===e))&&t.push(e),[...t,...Pe(e.parentElement)]}const Ce=["x","y","top","bottom","left","right","width","height"],Me=(e,t)=>Ce.every((n=>e[n]===t[n]));var Le=Object.defineProperty,Re=Object.defineProperties,Ie=Object.getOwnPropertyDescriptors,ze=Object.getOwnPropertySymbols,ke=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable,Oe=(e,t,n)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,je=(e,t)=>{for(var n in t||(t={}))ke.call(t,n)&&Oe(e,n,t[n]);if(ze)for(var n of ze(t))Ne.call(t,n)&&Oe(e,n,t[n]);return e};function Be(e,t,n){if(!e)return;if(!0===n(e))return e;let r=t?e.return:e.child;for(;r;){const e=Be(r,t,n);if(e)return e;r=t?null:r.sibling}}function De(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch{return e}}const Ue=De(o.createContext(null));class Fe extends o.Component{render(){return o.createElement(Ue.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:He,ReactCurrentDispatcher:Ve}=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Ge(){var e,t;const n=function(){const e=o.useContext(Ue);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=o.useId();return o.useMemo((()=>{for(const n of[He?.current,e,e?.alternate]){if(!n)continue;const e=Be(n,!1,(e=>{let n=e.memoizedState;for(;n;){if(n.memoizedState===t)return!0;n=n.next}}));if(e)return e}}),[e,t])}(),[r]=o.useState((()=>new Map));r.clear();let i=n;for(;i;){const n=null==(e=i.type)?void 0:e._context;n&&n!==Ue&&!r.has(n)&&r.set(n,null==(t=Ve?.current)?void 0:t.readContext(De(n))),i=i.return}return r}function qe(){const e=Ge();return o.useMemo((()=>Array.from(e.keys()).reduce(((t,n)=>r=>o.createElement(t,null,o.createElement(n.Provider,((e,t)=>Re(e,Ie(t)))(je({},r),{value:e.get(n)})))),(e=>o.createElement(Fe,je({},e))))),[e])}const We={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Xe(e){const{handlePointer:t}=K(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(We).reduce(((e,n)=>({...e,[n]:t(n)})),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:o}=e.getState();null==o.disconnect||o.disconnect(),r((e=>({events:{...e.events,connected:t}}))),Object.entries(null!=(n=o.handlers)?n:[]).forEach((e=>{let[n,r]=e;const[o,i]=We[n];t.addEventListener(o,r,{passive:i})}))},disconnect:()=>{const{set:t,events:n}=e.getState();var r;n.connected&&(Object.entries(null!=(r=n.handlers)?r:[]).forEach((e=>{let[t,r]=e;if(n&&n.connected instanceof HTMLElement){const[e]=We[t];n.connected.removeEventListener(e,r)}})),t((e=>({events:{...e.events,connected:void 0}}))))}}}const Ye=o.forwardRef((function(e,t){let{children:n,fallback:i,resize:a,style:s,gl:l,events:u=Xe,eventSource:c,eventPrefix:d,shadows:f,linear:h,flat:p,legacy:m,orthographic:g,frameloop:v,dpr:y,performance:x,raycaster:w,camera:S,scene:_,onPointerMissed:E,onCreated:M,...L}=e;o.useMemo((()=>b(r.k)),[]);const R=qe(),[I,z]=Ae({scroll:!0,debounce:{scroll:50,resize:0},...a}),k=o.useRef(null),N=o.useRef(null);o.useImperativeHandle(t,(()=>k.current));const O=A(E),[j,B]=o.useState(!1),[D,U]=o.useState(!1);if(j)throw j;if(D)throw D;const F=o.useRef(null);T((()=>{const e=k.current;z.width>0&&z.height>0&&e&&(F.current||(F.current=ye(e)),F.current.configure({gl:l,events:u,shadows:f,linear:h,flat:p,legacy:m,orthographic:g,frameloop:v,dpr:y,performance:x,raycaster:w,camera:S,scene:_,size:z,onPointerMissed:function(){return null==O.current?void 0:O.current(...arguments)},onCreated:e=>{var t;null==e.events.connect||e.events.connect(c?(t=c)&&t.hasOwnProperty("current")?c.current:c:N.current),d&&e.setEvents({compute:(e,t)=>{const n=e[d+"X"],r=e[d+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),M?.(e)}}),F.current.render(o.createElement(R,null,o.createElement(C,{set:U},o.createElement(o.Suspense,{fallback:o.createElement(P,{set:B})},n)))))})),o.useEffect((()=>{const e=k.current;if(e)return()=>xe(e)}),[]);const H=c?"none":"auto";return o.createElement("div",(0,r._)({ref:N,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:H,...s}},L),o.createElement("div",{ref:I,style:{width:"100%",height:"100%"}},o.createElement("canvas",{ref:k,style:{display:"block"}},i)))})),Ke=o.forwardRef((function(e,t){return o.createElement(Fe,null,o.createElement(Ye,(0,r._)({},e,{ref:t})))}));class Qe extends r.G{constructor(e,t){super(),this.inputSource=null,this.xrControllerModel=null,this.index=e,this.controller=t.xr.getController(e),this.grip=t.xr.getControllerGrip(e),this.hand=t.xr.getHand(e),this.grip.userData.name="grip",this.controller.userData.name="controller",this.hand.userData.name="hand",this.visible=!1,this.add(this.controller,this.grip,this.hand),this._onConnected=this._onConnected.bind(this),this._onDisconnected=this._onDisconnected.bind(this),this.controller.addEventListener("connected",this._onConnected),this.controller.addEventListener("disconnected",this._onDisconnected)}_onConnected(e){e.fake||e.data&&(this.visible=!0,this.inputSource=e.data,this.dispatchEvent(e))}_onDisconnected(e){e.fake||(this.visible=!1,this.inputSource=null,this.dispatchEvent(e))}dispose(){this.controller.removeEventListener("connected",this._onConnected),this.controller.removeEventListener("disconnected",this._onDisconnected)}}var $e,Je;const Ze=e=>Array.from(new Set(e)),et=typeof window<"u"&&(null!=($e=window.document)&&$e.createElement||"ReactNative"===(null==(Je=window.navigator)?void 0:Je.product))?o.useLayoutEffect:o.useEffect;function tt(e){const t=o.useRef(e);return et((()=>{t.current=e}),[e]),t}function nt(e,t){let{handedness:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=tt(t),o=gt((e=>e.controllers));et((()=>{const t=o.map((t=>{if(n&&t.inputSource&&t.inputSource.handedness!==n)return;const o=e=>r.current({nativeEvent:e,target:t});return t.controller.addEventListener(e,o),()=>t.controller.removeEventListener(e,o)}));return()=>t.forEach((e=>e?.()))}),[o,n,e])}const rt=new r.l;function ot(e){let{children:t}=e;const n=ue((e=>e.events)),r=ue((e=>e.get)),i=ue((e=>e.raycaster)),a=gt((e=>e.controllers)),s=gt((e=>e.interactions)),l=gt((e=>e.hoverState)),u=gt((e=>e.hasInteraction)),c=gt((e=>e.getInteraction)),d=o.useCallback((e=>{const t=Array.from(s.keys());return rt.identity().extractRotation(e.matrixWorld),i.ray.origin.setFromMatrixPosition(e.matrixWorld),i.ray.direction.set(0,0,-1).applyMatrix4(rt),i.intersectObjects(t,!0)}),[s,i]);ce((()=>{var e;if(0!==s.size)for(const t of a){if(null==(e=t.inputSource)||!e.handedness)return;const o=l[t.inputSource.handedness],i=new Set;let a=d(t.controller);if(n.filter)a=n.filter(a,r());else{const e=a.find((e=>e?.object));e&&(a=[e])}for(const e of a){let n=e.object;for(;n;){if(u(n,"onHover")&&!o.has(n)){const r=c(n,"onHover");for(const n of r)n({target:t,intersection:e,intersections:a})}const r=c(n,"onMove");r?.forEach((n=>n({target:t,intersection:e,intersections:a}))),o.set(n,e),i.add(n.id),n=n.parent}}for(const e of o.keys())if(!i.has(e.id)){o.delete(e);const n=c(e,"onBlur");if(!n)continue;for(const e of n)e({target:t,intersections:a})}}}));const f=o.useCallback((e=>t=>{var n;if(null==(n=t.target.inputSource)||!n.handedness)return;const r=l[t.target.inputSource.handedness],o=Array.from(new Set(r.values()));s.forEach(((n,i)=>{var a,s,l;if(r.has(i)){if(!n[e])return;for(const s of n[e])null==(a=s.current)||a.call(s,{target:t.target,intersection:r.get(i),intersections:o})}else if("onSelect"===e&&n.onSelectMissed)for(const e of n.onSelectMissed)null==(s=e.current)||s.call(e,{target:t.target,intersections:o});else if("onSqueeze"===e&&n.onSqueezeMissed)for(const e of n.onSqueezeMissed)null==(l=e.current)||l.call(e,{target:t.target,intersections:o})}))}),[l,s]);return nt("select",f("onSelect")),nt("selectstart",f("onSelectStart")),nt("selectend",f("onSelectEnd")),nt("squeeze",f("onSqueeze")),nt("squeezeend",f("onSqueezeEnd")),nt("squeezestart",f("onSqueezeStart")),o.createElement(o.Fragment,null,t)}function it(e,t,n){const r=gt((e=>e.addInteraction)),o=gt((e=>e.removeInteraction)),i=tt(n);et((()=>{const n=e.current;if(n&&i.current)return r(n,t,i),()=>o(n,t,i)}),[e,t,r,o])}const at=o.forwardRef((function(e,t){let{onHover:n,onBlur:r,onSelectStart:i,onSelectEnd:a,onSelectMissed:s,onSelect:l,onSqueezeStart:u,onSqueezeEnd:c,onSqueezeMissed:d,onSqueeze:f,onMove:h,children:p}=e;const m=o.useRef(null);return o.useImperativeHandle(t,(()=>m.current)),it(m,"onHover",n),it(m,"onBlur",r),it(m,"onSelectStart",i),it(m,"onSelectEnd",a),it(m,"onSelectMissed",s),it(m,"onSelect",l),it(m,"onSqueezeStart",u),it(m,"onSqueezeEnd",c),it(m,"onSqueezeMissed",d),it(m,"onSqueeze",f),it(m,"onMove",h),o.createElement("group",{ref:m},p)})),st=o.forwardRef((function(e,t){let{onSelectStart:n,onSelectEnd:i,children:a,...s}=e;const l=o.useRef(),u=o.useRef(null),c=o.useMemo((()=>new r.l),[]);return o.useImperativeHandle(t,(()=>u.current)),ce((()=>{const e=l.current,t=u.current;e&&(t.applyMatrix4(c),t.applyMatrix4(e.matrixWorld),t.updateMatrixWorld(),c.copy(e.matrixWorld).invert())})),o.createElement(at,{ref:u,onSelectStart:e=>{l.current=e.target.controller,c.copy(e.target.controller.matrixWorld).invert(),n?.(e)},onSelectEnd:e=>{e.target.controller===l.current&&(l.current=void 0),i?.(e)},...s},a)})),lt=o.createContext(null),ut=(0,r.c)(((e,t)=>({set:e,get:t,session:null,referenceSpaceType:null})));function ct(e){let{foveation:t=0,frameRate:n,referenceSpace:r="local-floor",onSessionStart:i,onSessionEnd:a,onVisibilityChange:s,onInputSourcesChange:l,children:u}=e;const c=ue((e=>e.gl)),d=ue((e=>e.camera)),f=gt((e=>e.player)),h=gt((e=>e.get)),p=gt((e=>e.set)),m=gt((e=>e.session)),g=gt((e=>e.controllers)),v=tt(i),y=tt(a),b=tt(s),x=tt(l);return et((()=>{const e=[0,1].map((e=>{const t=new Qe(e,c),n=()=>p((e=>({controllers:[...e.controllers,t]}))),r=()=>p((e=>({controllers:e.controllers.filter((e=>e!==t))})));return t.addEventListener("connected",n),t.addEventListener("disconnected",r),()=>{t.removeEventListener("connected",n),t.removeEventListener("disconnected",r)}}));return()=>e.forEach((e=>e()))}),[c,p]),et((()=>ut.subscribe((e=>{let{session:t}=e;return p((()=>({session:t})))}))),[c.xr,p]),et((()=>{c.xr.setFoveation(t),p((()=>({foveation:t})))}),[c.xr,t,p]),et((()=>{var e;try{n&&(null==(e=m?.updateTargetFrameRate)||e.call(m,n))}catch{}p((()=>({frameRate:n})))}),[m,n,p]),et((()=>{const e=ut.getState();c.xr.setReferenceSpaceType(r),p((()=>({referenceSpace:r}))),e.set({referenceSpaceType:r})}),[c.xr,r,p]),et((()=>{if(!m)return void c.xr.setSession(null);const e=e=>{var t;p((()=>({isPresenting:!0}))),null==(t=v.current)||t.call(v,{nativeEvent:{...e,target:m},target:m})},t=e=>{var t;p((()=>({isPresenting:!1,session:null}))),ut.setState((()=>({session:null}))),null==(t=y.current)||t.call(y,{nativeEvent:{...e,target:m},target:m})},n=e=>{var t;null==(t=b.current)||t.call(b,{nativeEvent:e,target:m})},r=e=>{var t;const n=Object.values(m.inputSources).some((e=>e.hand));p((()=>({isHandTracking:n}))),null==(t=x.current)||t.call(x,{nativeEvent:e,target:m})};return c.xr.addEventListener("sessionstart",e),c.xr.addEventListener("sessionend",t),m.addEventListener("visibilitychange",n),m.addEventListener("inputsourceschange",r),c.xr.setSession(m).then((()=>{c.xr.setFoveation(h().foveation)})),()=>{c.xr.removeEventListener("sessionstart",e),c.xr.removeEventListener("sessionend",t),m.removeEventListener("visibilitychange",n),m.removeEventListener("inputsourceschange",r)}}),[m,c.xr,p,h]),o.createElement(ot,null,o.createElement("primitive",{object:f},o.createElement("primitive",{object:d}),g.map((e=>o.createElement("primitive",{key:e.index,object:e})))),u)}function dt(e){const t=o.useMemo((()=>(0,r.c)(((e,t)=>({set:e,get:t,controllers:[],isPresenting:!1,isHandTracking:!1,player:new r.G,session:null,foveation:0,referenceSpace:"local-floor",hoverState:{left:new Map,right:new Map,none:new Map},interactions:new Map,hasInteraction(e,n){var r;return!(null==(r=t().interactions.get(e))||!r[n].some((e=>e.current)))},getInteraction(e,n){var r;return null==(r=t().interactions.get(e))?void 0:r[n].reduce(((e,t)=>(t.current&&e.push(t.current),e)),[])},addInteraction(e,n,r){const o=t().interactions;o.has(e)||o.set(e,{onHover:[],onBlur:[],onSelect:[],onSelectEnd:[],onSelectStart:[],onSelectMissed:[],onSqueeze:[],onSqueezeEnd:[],onSqueezeStart:[],onSqueezeMissed:[],onMove:[]}),o.get(e)[n].push(r)},removeInteraction(e,n,r){const o=t().interactions.get(e);if(o){const e=o[n].indexOf(r);-1!==e&&o[n].splice(e,1)}}})))),[]);return o.createElement(lt.Provider,{value:t},o.createElement(ct,{...e}))}const ft=async(e,t)=>{const n=ut.getState();if(n.session)return void console.warn("@react-three/xr: session already started, please stop it first");const r=((e,t)=>{var n;if(e||t)return e&&!t?{optionalFeatures:[e]}:e&&t?{...t,optionalFeatures:Ze([...null!=(n=t.optionalFeatures)?n:[],e])}:t})(n.referenceSpaceType,t),o=await navigator.xr.requestSession(e,r);return n.set((()=>({session:o}))),o},ht=async function(e){let{sessionInit:t,enterOnly:n,exitOnly:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=ut.getState();if((!o.session||!n)&&(o.session||!r))return o.session?await(async()=>{const e=ut.getState();e.session?(await e.session.end(),e.set({session:null})):console.warn("@react-three/xr: no session to stop, please start it first")})():await ft(e,t)},pt=o.forwardRef((function(e,t){let{mode:n,sessionInit:r,enterOnly:i=!1,exitOnly:a=!1,onClick:s,onError:l,children:u,...c}=e;var d;const[f,h]=o.useState("exited"),[p,m]=o.useState("unknown"),g=((e,t,n)=>{switch(e){case"entered":return`Exit ${t}`;case"exited":return`Enter ${t}`;default:switch(n){case"https":return"HTTPS needed";case"security":return`${t} blocked`;default:return`${t} unsupported`}}})(f,n,p),v="inline"===n?n:`immersive-${n.toLowerCase()}`,y=tt(l);et((()=>{navigator?.xr?navigator.xr.isSessionSupported(v).then((e=>{if(e)h("exited");else{const e="https:"===location.protocol;h("unsupported"),m(e?"unknown":"https")}})).catch((e=>{h("unsupported"),"name"in e&&"SecurityError"===e.name?m("security"):m("unknown")})):h("unsupported")}),[v]),et((()=>ut.subscribe((e=>{e.session?h("entered"):"unsupported"!==f&&h("exited")}))),[f]);const b=o.useCallback((async e=>{s?.(e);try{ht(v,{sessionInit:r,enterOnly:i,exitOnly:a})}catch(t){const e=y.current;if(!(e&&t instanceof Error))throw t;e(t)}}),[s,v,r,i,a,y]);return o.createElement("button",{...c,ref:t,onClick:"unsupported"===f?s:b},null!=(d="function"==typeof u?u(f):u)?d:g)})),mt={position:"absolute",bottom:"24px",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",border:"1px solid white",borderRadius:"4px",background:"rgba(0, 0, 0, 0.1)",color:"white",font:"normal 0.8125rem sans-serif",outline:"none",zIndex:99999,cursor:"pointer"};function gt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;const n=o.useContext(lt);if(!n)throw new Error("useXR must be used within an <XR /> component!");return n(e,t)}function vt(e,t){if(t===r.m)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===r.n||t===r.o){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const o=n.count-2,i=[];if(n)if(t===r.n)for(let e=1;e<=o;e++)i.push(n.getX(0)),i.push(n.getX(e)),i.push(n.getX(e+1));else for(let e=0;e<o;e++)e%2===0?(i.push(n.getX(e)),i.push(n.getX(e+1)),i.push(n.getX(e+2))):(i.push(n.getX(e+2)),i.push(n.getX(e+1)),i.push(n.getX(e)));i.length/3!==o&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=e.clone();return a.setIndex(i),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}o.forwardRef(((e,t)=>{let{style:n=mt,sessionInit:r={domOverlay:typeof document<"u"?{root:document.body}:void 0,optionalFeatures:["hit-test","dom-overlay","dom-overlay-for-handheld-ar"]},children:i,...a}=e;return o.createElement(pt,{...a,ref:t,mode:"AR",style:n,sessionInit:r},i)})),o.forwardRef(((e,t)=>{let{style:n=mt,sessionInit:r={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]},children:i,...a}=e;return o.createElement(pt,{...a,ref:t,mode:"VR",style:n,sessionInit:r},i)}));const yt=parseInt(r.p.replace(/\D+/g,""));var bt=Object.defineProperty,xt=(e,t,n)=>(((e,t,n)=>{t in e?bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const wt=new r.q,St=new r.r,_t=Math.cos(Math.PI/180*70),Et=(e,t)=>(e%t+t)%t;let Tt=class extends r.E{constructor(e,t){super(),xt(this,"object"),xt(this,"domElement"),xt(this,"enabled",!0),xt(this,"target",new r.b),xt(this,"minDistance",0),xt(this,"maxDistance",1/0),xt(this,"minZoom",0),xt(this,"maxZoom",1/0),xt(this,"minPolarAngle",0),xt(this,"maxPolarAngle",Math.PI),xt(this,"minAzimuthAngle",-1/0),xt(this,"maxAzimuthAngle",1/0),xt(this,"enableDamping",!1),xt(this,"dampingFactor",.05),xt(this,"enableZoom",!0),xt(this,"zoomSpeed",1),xt(this,"enableRotate",!0),xt(this,"rotateSpeed",1),xt(this,"enablePan",!0),xt(this,"panSpeed",1),xt(this,"screenSpacePanning",!0),xt(this,"keyPanSpeed",7),xt(this,"zoomToCursor",!1),xt(this,"autoRotate",!1),xt(this,"autoRotateSpeed",2),xt(this,"reverseOrbit",!1),xt(this,"reverseHorizontalOrbit",!1),xt(this,"reverseVerticalOrbit",!1),xt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),xt(this,"mouseButtons",{LEFT:r.s.ROTATE,MIDDLE:r.s.DOLLY,RIGHT:r.s.PAN}),xt(this,"touches",{ONE:r.t.ROTATE,TWO:r.t.DOLLY_PAN}),xt(this,"target0"),xt(this,"position0"),xt(this,"zoom0"),xt(this,"_domElementKeyEvents",null),xt(this,"getPolarAngle"),xt(this,"getAzimuthalAngle"),xt(this,"setPolarAngle"),xt(this,"setAzimuthalAngle"),xt(this,"getDistance"),xt(this,"listenToKeyEvents"),xt(this,"stopListenToKeyEvents"),xt(this,"saveState"),xt(this,"reset"),xt(this,"update"),xt(this,"connect"),xt(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=Et(e,2*Math.PI),r=c.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let o=Math.abs(t-r);2*Math.PI-o<o&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=Et(e,2*Math.PI),r=c.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let o=Math.abs(t-r);2*Math.PI-o<o&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",$),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",$),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(o),n.update(),l=s.NONE},this.update=(()=>{const t=new r.b,i=new r.b(0,1,0),a=(new r.Q).setFromUnitVectors(e.up,i),p=a.clone().invert(),m=new r.b,g=new r.Q,v=2*Math.PI;return function(){const y=n.object.position;a.setFromUnitVectors(e.up,i),p.copy(a).invert(),t.copy(y).sub(n.target),t.applyQuaternion(a),c.setFromVector3(t),n.autoRotate&&l===s.NONE&&M(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=d.theta*n.dampingFactor,c.phi+=d.phi*n.dampingFactor):(c.theta+=d.theta,c.phi+=d.phi);let b=n.minAzimuthAngle,x=n.maxAzimuthAngle;isFinite(b)&&isFinite(x)&&(b<-Math.PI?b+=v:b>Math.PI&&(b-=v),x<-Math.PI?x+=v:x>Math.PI&&(x-=v),c.theta=b<=x?Math.max(b,Math.min(x,c.theta)):c.theta>(b+x)/2?Math.max(b,c.theta):Math.min(x,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),n.zoomToCursor&&T||n.object.isOrthographicCamera?c.radius=j(c.radius):c.radius=j(c.radius*f),t.setFromSpherical(c),t.applyQuaternion(p),y.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),h.set(0,0,0));let w=!1;if(n.zoomToCursor&&T){let o=null;if(n.object instanceof r.P&&n.object.isPerspectiveCamera){const e=t.length();o=j(e*f);const r=e-o;n.object.position.addScaledVector(_,r),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new r.b(E.x,E.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix(),w=!0;const i=new r.b(E.x,E.y,0);i.unproject(n.object),n.object.position.sub(i).add(e),n.object.updateMatrixWorld(),o=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==o&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(o).add(n.object.position):(wt.origin.copy(n.object.position),wt.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(wt.direction))<_t?e.lookAt(n.target):(St.setFromNormalAndCoplanarPoint(n.object.up,n.target),wt.intersectPlane(St,n.target))))}else n.object instanceof r.O&&n.object.isOrthographicCamera&&(w=1!==f,w&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix()));return f=1,T=!1,!!(w||m.distanceToSquared(n.object.position)>u||8*(1-g.dot(n.object.quaternion))>u)&&(n.dispatchEvent(o),m.copy(n.object.position),g.copy(n.object.quaternion),w=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",J),n.domElement.addEventListener("pointerdown",W),n.domElement.addEventListener("pointercancel",K),n.domElement.addEventListener("wheel",Q)},this.dispose=()=>{var e,t,r,o,i,a;null==(e=n.domElement)||e.removeEventListener("contextmenu",J),null==(t=n.domElement)||t.removeEventListener("pointerdown",W),null==(r=n.domElement)||r.removeEventListener("pointercancel",K),null==(o=n.domElement)||o.removeEventListener("wheel",Q),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",X),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointerup",Y),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",$)};const n=this,o={type:"change"},i={type:"start"},a={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=s.NONE;const u=1e-6,c=new r.u,d=new r.u;let f=1;const h=new r.b,p=new r.V,m=new r.V,g=new r.V,v=new r.V,y=new r.V,b=new r.V,x=new r.V,w=new r.V,S=new r.V,_=new r.b,E=new r.V;let T=!1;const A=[],P={};function C(){return Math.pow(.95,n.zoomSpeed)}function M(e){n.reverseOrbit||n.reverseHorizontalOrbit?d.theta+=e:d.theta-=e}function L(e){n.reverseOrbit||n.reverseVerticalOrbit?d.phi+=e:d.phi-=e}const R=(()=>{const e=new r.b;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),h.add(e)}})(),I=(()=>{const e=new r.b;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),h.add(e)}})(),z=(()=>{const e=new r.b;return function(t,o){const i=n.domElement;if(i&&n.object instanceof r.P&&n.object.isPerspectiveCamera){const r=n.object.position;e.copy(r).sub(n.target);let a=e.length();a*=Math.tan(n.object.fov/2*Math.PI/180),R(2*t*a/i.clientHeight,n.object.matrix),I(2*o*a/i.clientHeight,n.object.matrix)}else i&&n.object instanceof r.O&&n.object.isOrthographicCamera?(R(t*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),I(o*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function k(e){n.object instanceof r.P&&n.object.isPerspectiveCamera||n.object instanceof r.O&&n.object.isOrthographicCamera?f/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(e){n.object instanceof r.P&&n.object.isPerspectiveCamera||n.object instanceof r.O&&n.object.isOrthographicCamera?f*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function O(e){if(!n.zoomToCursor||!n.domElement)return;T=!0;const t=n.domElement.getBoundingClientRect(),r=e.clientX-t.left,o=e.clientY-t.top,i=t.width,a=t.height;E.x=r/i*2-1,E.y=-o/a*2+1,_.set(E.x,E.y,1).unproject(n.object).sub(n.object.position).normalize()}function j(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function B(e){p.set(e.clientX,e.clientY)}function D(e){v.set(e.clientX,e.clientY)}function U(){if(1==A.length)p.set(A[0].pageX,A[0].pageY);else{const e=.5*(A[0].pageX+A[1].pageX),t=.5*(A[0].pageY+A[1].pageY);p.set(e,t)}}function F(){if(1==A.length)v.set(A[0].pageX,A[0].pageY);else{const e=.5*(A[0].pageX+A[1].pageX),t=.5*(A[0].pageY+A[1].pageY);v.set(e,t)}}function H(){const e=A[0].pageX-A[1].pageX,t=A[0].pageY-A[1].pageY,n=Math.sqrt(e*e+t*t);x.set(0,n)}function V(e){if(1==A.length)m.set(e.pageX,e.pageY);else{const t=te(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);m.set(n,r)}g.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(M(2*Math.PI*g.x/t.clientHeight),L(2*Math.PI*g.y/t.clientHeight)),p.copy(m)}function G(e){if(1==A.length)y.set(e.pageX,e.pageY);else{const t=te(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);y.set(n,r)}b.subVectors(y,v).multiplyScalar(n.panSpeed),z(b.x,b.y),v.copy(y)}function q(e){const t=te(e),r=e.pageX-t.x,o=e.pageY-t.y,i=Math.sqrt(r*r+o*o);w.set(0,i),S.set(0,Math.pow(w.y/x.y,n.zoomSpeed)),k(S.y),x.copy(w)}function W(e){var t,o;!1!==n.enabled&&(0===A.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",X),null==(o=n.domElement)||o.ownerDocument.addEventListener("pointerup",Y)),function(e){A.push(e)}(e),"touch"===e.pointerType?function(e){switch(ee(e),A.length){case 1:switch(n.touches.ONE){case r.t.ROTATE:if(!1===n.enableRotate)return;U(),l=s.TOUCH_ROTATE;break;case r.t.PAN:if(!1===n.enablePan)return;F(),l=s.TOUCH_PAN;break;default:l=s.NONE}break;case 2:switch(n.touches.TWO){case r.t.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&H(),n.enablePan&&F(),l=s.TOUCH_DOLLY_PAN;break;case r.t.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&H(),n.enableRotate&&U(),l=s.TOUCH_DOLLY_ROTATE;break;default:l=s.NONE}break;default:l=s.NONE}l!==s.NONE&&n.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case r.s.DOLLY:if(!1===n.enableZoom)return;(function(e){O(e),x.set(e.clientX,e.clientY)})(e),l=s.DOLLY;break;case r.s.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;D(e),l=s.PAN}else{if(!1===n.enableRotate)return;B(e),l=s.ROTATE}break;case r.s.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;B(e),l=s.ROTATE}else{if(!1===n.enablePan)return;D(e),l=s.PAN}break;default:l=s.NONE}l!==s.NONE&&n.dispatchEvent(i)}(e))}function X(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(ee(e),l){case s.TOUCH_ROTATE:if(!1===n.enableRotate)return;V(e),n.update();break;case s.TOUCH_PAN:if(!1===n.enablePan)return;G(e),n.update();break;case s.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function(e){n.enableZoom&&q(e),n.enablePan&&G(e)})(e),n.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function(e){n.enableZoom&&q(e),n.enableRotate&&V(e)})(e),n.update();break;default:l=s.NONE}}(e):function(e){if(!1!==n.enabled)switch(l){case s.ROTATE:if(!1===n.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),g.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(M(2*Math.PI*g.x/t.clientHeight),L(2*Math.PI*g.y/t.clientHeight)),p.copy(m),n.update()}(e);break;case s.DOLLY:if(!1===n.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),S.subVectors(w,x),S.y>0?k(C()):S.y<0&&N(C()),x.copy(w),n.update()}(e);break;case s.PAN:if(!1===n.enablePan)return;!function(e){y.set(e.clientX,e.clientY),b.subVectors(y,v).multiplyScalar(n.panSpeed),z(b.x,b.y),v.copy(y),n.update()}(e)}}(e))}function Y(e){var t,r,o;Z(e),0===A.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",X),null==(o=n.domElement)||o.ownerDocument.removeEventListener("pointerup",Y)),n.dispatchEvent(a),l=s.NONE}function K(e){Z(e)}function Q(e){!1===n.enabled||!1===n.enableZoom||l!==s.NONE&&l!==s.ROTATE||(e.preventDefault(),n.dispatchEvent(i),function(e){O(e),e.deltaY<0?N(C()):e.deltaY>0&&k(C()),n.update()}(e),n.dispatchEvent(a))}function $(e){!1===n.enabled||!1===n.enablePan||function(e){let t=!1;switch(e.code){case n.keys.UP:z(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:z(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:z(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:z(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function J(e){!1!==n.enabled&&e.preventDefault()}function Z(e){delete P[e.pointerId];for(let t=0;t<A.length;t++)if(A[t].pointerId==e.pointerId)return void A.splice(t,1)}function ee(e){let t=P[e.pointerId];void 0===t&&(t=new r.V,P[e.pointerId]=t),t.set(e.pageX,e.pageY)}function te(e){const t=e.pointerId===A[0].pointerId?A[1]:A[0];return P[t.pointerId]}void 0!==t&&this.connect(t),this.update()}};class At extends r.v{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new It(e)})),this.register((function(e){return new Ut(e)})),this.register((function(e){return new Ft(e)})),this.register((function(e){return new Ht(e)})),this.register((function(e){return new kt(e)})),this.register((function(e){return new Nt(e)})),this.register((function(e){return new Ot(e)})),this.register((function(e){return new jt(e)})),this.register((function(e){return new Rt(e)})),this.register((function(e){return new Bt(e)})),this.register((function(e){return new zt(e)})),this.register((function(e){return new Dt(e)})),this.register((function(e){return new Mt(e)})),this.register((function(e){return new Vt(e)})),this.register((function(e){return new Gt(e)}))}load(e,t,n,o){const i=this;let a;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:r.w.extractUrlBase(e),this.manager.itemStart(e);const s=function(t){o?o(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},l=new r.F(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(n){try{i.parse(n,a,(function(n){t(n),i.manager.itemEnd(e)}),s)}catch(r){s(r)}}),n,s)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,o){let i;const a={},s={};if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer)if(r.w.decodeText(new Uint8Array(e.slice(0,4)))===qt){try{a[Ct.KHR_BINARY_GLTF]=new Yt(e)}catch(u){return void(o&&o(u))}i=JSON.parse(a[Ct.KHR_BINARY_GLTF].content)}else i=JSON.parse(r.w.decodeText(new Uint8Array(e)));else i=e;if(void 0===i.asset||i.asset.version[0]<2)return void(o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new xn(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let r=0;r<this.pluginCallbacks.length;r++){const e=this.pluginCallbacks[r](l);s[e.name]=e,a[e.name]=!0}if(i.extensionsUsed)for(let r=0;r<i.extensionsUsed.length;++r){const e=i.extensionsUsed[r],t=i.extensionsRequired||[];switch(e){case Ct.KHR_MATERIALS_UNLIT:a[e]=new Lt;break;case Ct.KHR_DRACO_MESH_COMPRESSION:a[e]=new Kt(i,this.dracoLoader);break;case Ct.KHR_TEXTURE_TRANSFORM:a[e]=new Qt;break;case Ct.KHR_MESH_QUANTIZATION:a[e]=new $t;break;default:t.indexOf(e)>=0&&void 0===s[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}l.setExtensions(a),l.setPlugins(s),l.parse(n,o)}parseAsync(e,t){const n=this;return new Promise((function(r,o){n.parse(e,t,r,o)}))}}function Pt(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Ct={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Mt{constructor(e){this.parser=e,this.name=Ct.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let o=t.cache.get(n);if(o)return o;const i=t.json,a=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let s;const l=new r.i(16777215);void 0!==a.color&&l.fromArray(a.color);const u=void 0!==a.range?a.range:0;switch(a.type){case"directional":s=new r.D(l),s.target.position.set(0,0,-1),s.add(s.target);break;case"point":s=new r.y(l),s.distance=u;break;case"spot":s=new r.x(l),s.distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,s.angle=a.spot.outerConeAngle,s.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,s.target.position.set(0,0,-1),s.add(s.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return s.position.set(0,0,0),s.decay=2,pn(s,a),void 0!==a.intensity&&(s.intensity=a.intensity),s.name=t.createUniqueName(a.name||"light_"+e),o=Promise.resolve(s),t.cache.add(n,o),o}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(e){return n._getNodeRef(t.cache,o,e)}))}}class Lt{constructor(){this.name=Ct.KHR_MATERIALS_UNLIT}getMaterialType(){return r.z}extendParams(e,t,n){const o=[];e.color=new r.i(1,1,1),e.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const t=i.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==i.baseColorTexture&&o.push(n.assignTexture(e,"map",i.baseColorTexture,3001))}return Promise.all(o)}}class Rt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class It{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],a=o.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new r.V(e,e)}return Promise.all(i)}}class zt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&o.push(n.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&o.push(n.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(o)}}class kt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new r.i(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=o.extensions[this.name];return void 0!==a.sheenColorFactor&&t.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,3001)),void 0!==a.sheenRoughnessTexture&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}class Nt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&o.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(o)}}class Ot{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],a=o.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const s=a.attenuationColor||[1,1,1];return t.attenuationColor=new r.i(s[0],s[1],s[2]),Promise.all(i)}}class jt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class Bt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],a=o.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const s=a.specularColorFactor||[1,1,1];return t.specularColor=new r.i(s[0],s[1],s[2]),void 0!==a.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,3001)),Promise.all(i)}}class Dt{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.H:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&o.push(n.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(o)}}class Ut{constructor(e){this.parser=e,this.name=Ct.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=r.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,i)}}class Ft{constructor(e){this.parser=e,this.name=Ct.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const i=o.extensions[t],a=r.images[i.source];let s=n.textureLoader;if(a.uri){const e=n.options.manager.getHandler(a.uri);null!==e&&(s=e)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,i.source,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Ht{constructor(e){this.parser=e,this.name=Ct.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const i=o.extensions[t],a=r.images[i.source];let s=n.textureLoader;if(a.uri){const e=n.options.manager.getHandler(a.uri);null!==e&&(s=e)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,i.source,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Vt{constructor(e){this.name=Ct.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,i=e.count,a=e.byteStride,s=new Uint8Array(t,n,r);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(i,a,s,e.mode,e.filter).then((function(e){return e.buffer})):o.ready.then((function(){const t=new ArrayBuffer(i*a);return o.decodeGltfBuffer(new Uint8Array(t),i,a,s,e.mode,e.filter),t}))}))}return null}}class Gt{constructor(e){this.name=Ct.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const o=t.meshes[n.mesh];for(const r of o.primitives)if(r.mode!==tn.TRIANGLES&&r.mode!==tn.TRIANGLE_STRIP&&r.mode!==tn.TRIANGLE_FAN&&void 0!==r.mode)return null;const i=n.extensions[this.name].attributes,a=[],s={};for(const r in i)a.push(this.parser.getDependency("accessor",i[r]).then((e=>(s[r]=e,s[r]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],o=e[0].count,i=[];for(const a of n){const e=new r.l,t=new r.b,n=new r.Q,l=new r.b(1,1,1),u=new r.I(a.geometry,a.material,o);for(let r=0;r<o;r++)s.TRANSLATION&&t.fromBufferAttribute(s.TRANSLATION,r),s.ROTATION&&n.fromBufferAttribute(s.ROTATION,r),s.SCALE&&l.fromBufferAttribute(s.SCALE,r),u.setMatrixAt(r,e.compose(t,n,l));for(const r in s)"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&a.geometry.setAttribute(r,s[r]);r.J.prototype.copy.call(u,a),this.parser.assignFinalMaterial(u),i.push(u)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]})))}}const qt="glTF",Wt=1313821514,Xt=5130562;class Yt{constructor(e){this.name=Ct.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:r.w.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==qt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,o=new DataView(e,12);let i=0;for(;i<n;){const t=o.getUint32(i,!0);i+=4;const n=o.getUint32(i,!0);if(i+=4,n===Wt){const n=new Uint8Array(e,12+i,t);this.content=r.w.decodeText(n)}else if(n===Xt){const n=12+i;this.body=e.slice(n,n+t)}i+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Kt{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ct.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,a={},s={},l={};for(const u in i){const e=sn[u]||u.toLowerCase();a[e]=i[u]}for(const u in e.attributes){const t=sn[u]||u.toLowerCase();if(void 0!==i[u]){const r=n.accessors[e.attributes[u]],o=nn[r.componentType];l[t]=o.name,s[t]=!0===r.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=s[t];void 0!==r&&(n.normalized=r)}t(e)}),a,l)}))}))}}class Qt{constructor(){this.name=Ct.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class $t{constructor(){this.name=Ct.KHR_MESH_QUANTIZATION}}class Jt extends r.aw{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let i=0;i!==r;i++)t[i]=n[o+i];return t}interpolate_(e,t,n,r){const o=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,u=r-t,c=(n-t)/u,d=c*c,f=d*c,h=e*l,p=h-l,m=-2*f+3*d,g=f-d,v=1-m,y=g-d+c;for(let b=0;b!==a;b++){const e=i[p+b+a],t=i[p+b+s]*u,n=i[h+b+a],r=i[h+b]*u;o[b]=v*e+y*t+m*n+g*r}return o}}const Zt=new r.Q;class en extends Jt{interpolate_(e,t,n,r){const o=super.interpolate_(e,t,n,r);return Zt.fromArray(o).normalize().toArray(o),o}}const tn={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},nn={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},rn={9728:r.ai,9729:r.$,9984:r.aj,9985:r.ak,9986:r.al,9987:r.a0},on={33071:r.am,33648:r.an,10497:r.a1},an={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...yt>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ln={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},un={CUBICSPLINE:void 0,LINEAR:r.af,STEP:r.ao},cn="OPAQUE",dn="MASK",fn="BLEND";function hn(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function pn(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function mn(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function gn(e){let t;const n=e.extensions&&e.extensions[Ct.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+vn(n.attributes):e.indices+":"+vn(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,o=e.targets.length;r<o;r++)t+=":"+vn(e.targets[r]);return t}function vn(e){let t="";const n=Object.keys(e).sort();for(let r=0,o=n.length;r<o;r++)t+=n[r]+":"+e[n[r]]+";";return t}function yn(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const bn=new r.l;class xn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Pt,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,o=!1,i=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),o=navigator.userAgent.indexOf("Firefox")>-1,i=o?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||o&&i<98?this.textureLoader=new r.K(this.options.manager):this.textureLoader=new r.X(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new r.F(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};hn(o,i,r),pn(i,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(i)}))).then((function(){e(i)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let r=0,o=e.length;r<o;r++){const t=e[r];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),o=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[r,i]of e.children.entries())o(i,t.children[r])};return o(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&n.push(o)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Ct.KHR_BINARY_GLTF].body);const o=this.options;return new Promise((function(e,i){n.load(r.w.resolveURL(t.uri,o.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}loadAccessor(e){const t=this,n=this.json,o=this.json.accessors[e];if(void 0===o.bufferView&&void 0===o.sparse){const e=an[o.type],t=nn[o.componentType],n=!0===o.normalized,i=new t(o.count*e);return Promise.resolve(new r.Y(i,e,n))}const i=[];return void 0!==o.bufferView?i.push(this.getDependency("bufferView",o.bufferView)):i.push(null),void 0!==o.sparse&&(i.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(i).then((function(e){const i=e[0],a=an[o.type],s=nn[o.componentType],l=s.BYTES_PER_ELEMENT,u=l*a,c=o.byteOffset||0,d=void 0!==o.bufferView?n.bufferViews[o.bufferView].byteStride:void 0,f=!0===o.normalized;let h,p;if(d&&d!==u){const e=Math.floor(c/d),n="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+e+":"+o.count;let u=t.cache.get(n);u||(h=new s(i,e*d,o.count*d/l),u=new r.Z(h,d/l),t.cache.add(n,u)),p=new r.aq(u,a,c%d/l,f)}else h=null===i?new s(o.count*a):new s(i,c,o.count*a),p=new r.Y(h,a,f);if(void 0!==o.sparse){const t=an.SCALAR,n=nn[o.sparse.indices.componentType],l=o.sparse.indices.byteOffset||0,u=o.sparse.values.byteOffset||0,c=new n(e[1],l,o.sparse.count*t),d=new s(e[2],u,o.sparse.count*a);null!==i&&(p=new r.Y(p.array.slice(),p.itemSize,p.normalized));for(let e=0,r=c.length;e<r;e++){const t=c[e];if(p.setX(t,d[e*a]),a>=2&&p.setY(t,d[e*a+1]),a>=3&&p.setZ(t,d[e*a+2]),a>=4&&p.setW(t,d[e*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,o=t.images[r];let i=this.textureLoader;if(o.uri){const e=n.manager.getHandler(o.uri);null!==e&&(i=e)}return this.loadTextureImage(e,r,i)}loadTextureImage(e,t,n){const o=this,i=this.json,a=i.textures[e],s=i.images[t],l=(s.uri||s.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=a.name||s.name||"",""===t.name&&"string"==typeof s.uri&&!1===s.uri.startsWith("data:image/")&&(t.name=s.uri);const n=(i.samplers||{})[a.sampler]||{};return t.magFilter=rn[n.magFilter]||r.$,t.minFilter=rn[n.minFilter]||r.a0,t.wrapS=on[n.wrapS]||r.a1,t.wrapT=on[n.wrapT]||r.a1,o.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[l]=u,u}loadImageSource(e,t){const n=this.json,o=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const i=n.images[e],a=self.URL||self.webkitURL;let s=i.uri||"",l=!1;if(void 0!==i.bufferView)s=this.getDependency("bufferView",i.bufferView).then((function(e){l=!0;const t=new Blob([e],{type:i.mimeType});return s=a.createObjectURL(t),s}));else if(void 0===i.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(s).then((function(e){return new Promise((function(n,i){let a=n;!0===t.isImageBitmapLoader&&(a=function(e){const t=new r.T(e);t.needsUpdate=!0,n(t)}),t.load(r.w.resolveURL(e,o.path),a,void 0,i)}))})).then((function(e){return!0===l&&a.revokeObjectURL(s),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e;var t})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",s),e}));return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const o=this;return this.getDependency("texture",n.index).then((function(i){if(!i)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((i=i.clone()).channel=n.texCoord),o.extensions[Ct.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[Ct.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=o.associations.get(i);i=o.extensions[Ct.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),o.associations.set(i,t)}}return void 0!==r&&("colorSpace"in i?i.colorSpace=3001===r?"srgb":"srgb-linear":i.encoding=r),e[t]=i,i}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const o=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new r.a2,r.M.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new r.a3,r.M.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(o||i||a){let e="ClonedMaterial:"+n.uuid+":";o&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),o&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return r.a4}loadMaterial(e){const t=this,n=this.json,o=this.extensions,i=n.materials[e];let a;const s={},l=[];if((i.extensions||{})[Ct.KHR_MATERIALS_UNLIT]){const e=o[Ct.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),l.push(e.extendParams(s,i,t))}else{const n=i.pbrMetallicRoughness||{};if(s.color=new r.i(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;s.color.fromArray(e),s.opacity=e[3]}void 0!==n.baseColorTexture&&l.push(t.assignTexture(s,"map",n.baseColorTexture,3001)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(l.push(t.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),l.push(t.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture))),a=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),l.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)}))))}!0===i.doubleSided&&(s.side=r.a5);const u=i.alphaMode||cn;if(u===fn?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,u===dn&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&a!==r.z&&(l.push(t.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new r.V(1,1),void 0!==i.normalTexture.scale)){const e=i.normalTexture.scale;s.normalScale.set(e,e)}return void 0!==i.occlusionTexture&&a!==r.z&&(l.push(t.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&a!==r.z&&(s.emissive=(new r.i).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&a!==r.z&&l.push(t.assignTexture(s,"emissiveMap",i.emissiveTexture,3001)),Promise.all(l).then((function(){const n=new a(s);return i.name&&(n.name=i.name),pn(n,i),t.associations.set(n,{materials:e}),i.extensions&&hn(o,n,i),n}))}createUniqueName(e){const t=r.a6.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,o=this.primitiveCache;function i(e){return n[Ct.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return wn(n,e,t)}))}const a=[];for(let s=0,l=e.length;s<l;s++){const n=e[s],l=gn(n),u=o[l];if(u)a.push(u.promise);else{let e;e=n.extensions&&n.extensions[Ct.KHR_DRACO_MESH_COMPRESSION]?i(n):wn(new r.h,n,t),o[l]={primitive:n,promise:e},a.push(e)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,o=this.extensions,i=n.meshes[e],a=i.primitives,s=[];for(let u=0,c=a.length;u<c;u++){const e=void 0===a[u].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new r.a4({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.ap})),l.DefaultMaterial):this.getDependency("material",a[u].material);s.push(e)}var l;return s.push(t.loadGeometries(a)),Promise.all(s).then((function(n){const s=n.slice(0,n.length-1),l=n[n.length-1],u=[];for(let d=0,f=l.length;d<f;d++){const n=l[d],c=a[d];let f;const h=s[d];if(c.mode===tn.TRIANGLES||c.mode===tn.TRIANGLE_STRIP||c.mode===tn.TRIANGLE_FAN||void 0===c.mode)f=!0===i.isSkinnedMesh?new r.a7(n,h):new r.a8(n,h),!0===f.isSkinnedMesh&&f.normalizeSkinWeights(),c.mode===tn.TRIANGLE_STRIP?f.geometry=vt(f.geometry,r.o):c.mode===tn.TRIANGLE_FAN&&(f.geometry=vt(f.geometry,r.n));else if(c.mode===tn.LINES)f=new r.a9(n,h);else if(c.mode===tn.LINE_STRIP)f=new r.aa(n,h);else if(c.mode===tn.LINE_LOOP)f=new r.ab(n,h);else{if(c.mode!==tn.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);f=new r.ac(n,h)}Object.keys(f.geometry.morphAttributes).length>0&&mn(f,i),f.name=t.createUniqueName(i.name||"mesh_"+e),pn(f,i),c.extensions&&hn(o,f,c),t.assignFinalMaterial(f),u.push(f)}for(let r=0,o=u.length;r<o;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return i.extensions&&hn(o,u[0],i),u[0];const c=new r.G;i.extensions&&hn(o,c,i),t.associations.set(c,{meshes:e});for(let e=0,t=u.length;e<t;e++)c.add(u[e]);return c}))}loadCamera(e){let t;const n=this.json.cameras[e],o=n[n.type];if(o)return"perspective"===n.type?t=new r.P(r.ad.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===n.type&&(t=new r.O(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),pn(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,o=t.joints.length;r<o;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),o=e,i=[],a=[];for(let s=0,l=o.length;s<l;s++){const e=o[s];if(e){i.push(e);const t=new r.l;null!==n&&t.fromArray(n.array,16*s),a.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[s])}return new r.ae(i,a)}))}loadAnimation(e){const t=this.json.animations[e],n=t.name?t.name:"animation_"+e,o=[],i=[],a=[],s=[],l=[];for(let r=0,u=t.channels.length;r<u;r++){const e=t.channels[r],n=t.samplers[e.sampler],u=e.target,c=u.node,d=void 0!==t.parameters?t.parameters[n.input]:n.input,f=void 0!==t.parameters?t.parameters[n.output]:n.output;void 0!==u.node&&(o.push(this.getDependency("node",c)),i.push(this.getDependency("accessor",d)),a.push(this.getDependency("accessor",f)),s.push(n),l.push(u))}return Promise.all([Promise.all(o),Promise.all(i),Promise.all(a),Promise.all(s),Promise.all(l)]).then((function(e){const t=e[0],o=e[1],i=e[2],a=e[3],s=e[4],l=[];for(let n=0,u=t.length;n<u;n++){const e=t[n],u=o[n],c=i[n],d=a[n],f=s[n];if(void 0===e)continue;let h;switch(e.updateMatrix(),ln[f.path]){case ln.weights:h=r.at;break;case ln.rotation:h=r.as;break;default:h=r.ar}const p=e.name?e.name:e.uuid,m=void 0!==d.interpolation?un[d.interpolation]:r.af,g=[];ln[f.path]===ln.weights?e.traverse((function(e){e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)})):g.push(p);let v=c.array;if(c.normalized){const e=yn(v.constructor),t=new Float32Array(v.length);for(let n=0,r=v.length;n<r;n++)t[n]=v[n]*e;v=t}for(let t=0,n=g.length;t<n;t++){const e=new h(g[t]+"."+ln[f.path],u.array,v,m);"CUBICSPLINE"===d.interpolation&&(e.createInterpolant=function(e){return new(this instanceof r.as?en:Jt)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(e)}}return new r.ag(n,void 0,l)}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),o=[],i=n.children||[];for(let s=0,l=i.length;s<l;s++)o.push(t.getDependency("node",i[s]));const a=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(o),a]).then((function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,bn)}));for(let o=0,i=n.length;o<i;o++)t.add(n[o]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,o=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const i=t.nodes[e],a=i.name?o.createUniqueName(i.name):"",s=[],l=o._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return l&&s.push(l),void 0!==i.camera&&s.push(o.getDependency("camera",i.camera).then((function(e){return o._getNodeRef(o.cameraCache,i.camera,e)}))),o._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){s.push(e)})),this.nodeCache[e]=Promise.all(s).then((function(t){let s;if(s=!0===i.isBone?new r.ah:t.length>1?new r.G:1===t.length?t[0]:new r.J,s!==t[0])for(let e=0,n=t.length;e<n;e++)s.add(t[e]);if(i.name&&(s.userData.name=i.name,s.name=a),pn(s,i),i.extensions&&hn(n,s,i),void 0!==i.matrix){const e=new r.l;e.fromArray(i.matrix),s.applyMatrix4(e)}else void 0!==i.translation&&s.position.fromArray(i.translation),void 0!==i.rotation&&s.quaternion.fromArray(i.rotation),void 0!==i.scale&&s.scale.fromArray(i.scale);return o.associations.has(s)||o.associations.set(s,{}),o.associations.get(s).nodes=e,s})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],o=this,i=new r.G;n.name&&(i.name=o.createUniqueName(n.name)),pn(i,n),n.extensions&&hn(t,i,n);const a=n.nodes||[],s=[];for(let r=0,l=a.length;r<l;r++)s.push(o.getDependency("node",a[r]));return Promise.all(s).then((function(e){for(let t=0,n=e.length;t<n;t++)i.add(e[t]);return o.associations=(e=>{const t=new Map;for(const[n,i]of o.associations)(n instanceof r.M||n instanceof r.T)&&t.set(n,i);return e.traverse((e=>{const n=o.associations.get(e);null!=n&&t.set(e,n)})),t})(i),i}))}}function wn(e,t,n){const o=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const r in o){const t=sn[r]||r.toLowerCase();t in e.attributes||i.push(a(o[r],t))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(r)}return pn(e,t),function(e,t,n){const o=t.attributes,i=new r.au;if(void 0===o.POSITION)return;{const e=n.json.accessors[o.POSITION],t=e.min,a=e.max;if(void 0===t||void 0===a)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new r.b(t[0],t[1],t[2]),new r.b(a[0],a[1],a[2])),e.normalized){const t=yn(nn[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}const a=t.targets;if(void 0!==a){const e=new r.b,t=new r.b;for(let r=0,o=a.length;r<o;r++){const o=a[r];if(void 0!==o.POSITION){const r=n.json.accessors[o.POSITION],i=r.min,a=r.max;if(void 0!==i&&void 0!==a){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(a[2]))),r.normalized){const e=yn(nn[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;const s=new r.av;i.getCenter(s.center),s.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=s}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){let r=!1,o=!1,i=!1;for(let u=0,c=t.length;u<c;u++){const e=t[u];if(void 0!==e.POSITION&&(r=!0),void 0!==e.NORMAL&&(o=!0),void 0!==e.COLOR_0&&(i=!0),r&&o&&i)break}if(!r&&!o&&!i)return Promise.resolve(e);const a=[],s=[],l=[];for(let u=0,c=t.length;u<c;u++){const c=t[u];if(r){const t=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):e.attributes.position;a.push(t)}if(o){const t=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):e.attributes.normal;s.push(t)}if(i){const t=void 0!==c.COLOR_0?n.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(s),Promise.all(l)]).then((function(t){const n=t[0],a=t[1],s=t[2];return r&&(e.morphAttributes.position=n),o&&(e.morphAttributes.normal=a),i&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}var Sn=Object.defineProperty,_n=(e,t,n)=>(((e,t,n)=>{t in e?Sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const En={Handedness:{NONE:"none",LEFT:"left",RIGHT:"right"},ComponentState:{DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"},ComponentProperty:{BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"},ComponentType:{TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"},ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:{TRANSFORM:"transform",VISIBILITY:"visibility"}};async function Tn(e){const t=await fetch(e);if(t.ok)return t.json();throw new Error(t.statusText)}async function An(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No basePath supplied");const o=await async function(e){if(!e)throw new Error("No basePath supplied");return await Tn(`${e}/profilesList.json`)}(t);let i;if(e.profiles.some((e=>{const n=o[e];return n&&(i={profileId:e,profilePath:`${t}/${n.path}`,deprecated:!!n.deprecated}),!!i})),!i){if(!n)throw new Error("No matching profile name found");const e=o[n];if(!e)throw new Error(`No matching profile name found and default profile "${n}" missing.`);i={profileId:n,profilePath:`${t}/${e.path}`,deprecated:!!e.deprecated}}const a=await Tn(i.profilePath);let s;if(r){let t;if(t="any"===e.handedness?a.layouts[Object.keys(a.layouts)[0]]:a.layouts[e.handedness],!t)throw new Error(`No matching handedness, ${e.handedness}, in profile ${i.profileId}`);t.assetPath&&(s=i.profilePath.replace("profile.json",t.assetPath))}return{profile:a,assetPath:s}}const Pn={xAxis:0,yAxis:0,button:0,state:En.ComponentState.DEFAULT};class Cn{constructor(e){_n(this,"value"),_n(this,"componentProperty"),_n(this,"states"),_n(this,"valueNodeName"),_n(this,"valueNodeProperty"),_n(this,"minNodeName"),_n(this,"maxNodeName"),_n(this,"valueNode"),_n(this,"minNode"),_n(this,"maxNode"),this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===En.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(Pn)}updateFromComponent(e){let{xAxis:t,yAxis:n,button:r,state:o}=e;const{normalizedXAxis:i,normalizedYAxis:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=t;if(Math.sqrt(e*e+t*t)>1){const o=Math.atan2(t,e);n=Math.cos(o),r=Math.sin(o)}return{normalizedXAxis:.5*n+.5,normalizedYAxis:.5*r+.5}}(t,n);switch(this.componentProperty){case En.ComponentProperty.X_AXIS:this.value=this.states.includes(o)?i:.5;break;case En.ComponentProperty.Y_AXIS:this.value=this.states.includes(o)?a:.5;break;case En.ComponentProperty.BUTTON:this.value=this.states.includes(o)&&r?r:0;break;case En.ComponentProperty.STATE:this.valueNodeProperty===En.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(o):this.value=this.states.includes(o)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Mn{constructor(e,t){if(_n(this,"id"),_n(this,"values"),_n(this,"type"),_n(this,"gamepadIndices"),_n(this,"rootNodeName"),_n(this,"visualResponses"),_n(this,"touchPointNodeName"),_n(this,"touchPointNode"),!e||!t||!t.visualResponses||!t.gamepadIndices||0===Object.keys(t.gamepadIndices).length)throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach((e=>{const n=new Cn(t.visualResponses[e]);this.visualResponses[e]=n})),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:En.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=En.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=En.ComponentState.PRESSED:(t.touched||this.values.button>En.ButtonTouchThreshold)&&(this.values.state=En.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===En.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>En.AxisTouchThreshold&&(this.values.state=En.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===En.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>En.AxisTouchThreshold&&(this.values.state=En.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((e=>{e.updateFromComponent(this.values)}))}}class Ln{constructor(e,t,n){if(_n(this,"xrInputSource"),_n(this,"assetUrl"),_n(this,"layoutDescription"),_n(this,"id"),_n(this,"components"),!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");if(!t.layouts[e.handedness])throw new Error("No layout for "+e.handedness+" handedness");this.xrInputSource=e,this.assetUrl=n,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((e=>{const t=this.layoutDescription.components[e];this.components[e]=new Mn(e,t)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach((t=>{e.push(t.data)})),e}updateFromGamepad(){Object.values(this.components).forEach((e=>{e.updateFromGamepad(this.xrInputSource.gamepad)}))}}const Rn=new r.au,In=new r.b;class zn extends r.ax{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new r.ay([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new r.ay([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new r.az(t,6,1);return this.setAttribute("instanceStart",new r.aq(n,3,0)),this.setAttribute("instanceEnd",new r.aq(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const o=new r.az(t,2*n,1);return this.setAttribute("instanceColorStart",new r.aq(o,n,0)),this.setAttribute("instanceColorEnd",new r.aq(o,n,n)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new r.aA(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new r.au);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Rn.setFromBufferAttribute(t),this.boundingBox.union(Rn))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new r.av),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let o=0,i=e.count;o<i;o++)In.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(In)),In.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(In));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class kn extends zn{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;const n=e.length-t,r=new Float32Array(2*n);if(3===t)for(let o=0;o<n;o+=t)r[2*o]=e[o],r[2*o+1]=e[o+1],r[2*o+2]=e[o+2],r[2*o+3]=e[o+3],r[2*o+4]=e[o+4],r[2*o+5]=e[o+5];else for(let o=0;o<n;o+=t)r[2*o]=e[o],r[2*o+1]=e[o+1],r[2*o+2]=e[o+2],r[2*o+3]=e[o+3],r[2*o+4]=e[o+4],r[2*o+5]=e[o+5],r[2*o+6]=e[o+6],r[2*o+7]=e[o+7];return super.setColors(r,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Nn extends r.aB{constructor(e){super({type:"LineMaterial",uniforms:r.aC.clone(r.aC.merge([r.aD.common,r.aD.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new r.V(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:"\n\t\t\t\t#include <common>\n\t\t\t\t#include <fog_pars_vertex>\n\t\t\t\t#include <logdepthbuf_pars_vertex>\n\t\t\t\t#include <clipping_planes_pars_vertex>\n\n\t\t\t\tuniform float linewidth;\n\t\t\t\tuniform vec2 resolution;\n\n\t\t\t\tattribute vec3 instanceStart;\n\t\t\t\tattribute vec3 instanceEnd;\n\n\t\t\t\t#ifdef USE_COLOR\n\t\t\t\t\t#ifdef USE_LINE_COLOR_ALPHA\n\t\t\t\t\t\tvarying vec4 vLineColor;\n\t\t\t\t\t\tattribute vec4 instanceColorStart;\n\t\t\t\t\t\tattribute vec4 instanceColorEnd;\n\t\t\t\t\t#else\n\t\t\t\t\t\tvarying vec3 vLineColor;\n\t\t\t\t\t\tattribute vec3 instanceColorStart;\n\t\t\t\t\t\tattribute vec3 instanceColorEnd;\n\t\t\t\t\t#endif\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t\tvarying vec4 worldPos;\n\t\t\t\t\tvarying vec3 worldStart;\n\t\t\t\t\tvarying vec3 worldEnd;\n\n\t\t\t\t\t#ifdef USE_DASH\n\n\t\t\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#else\n\n\t\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef USE_DASH\n\n\t\t\t\t\tuniform float dashScale;\n\t\t\t\t\tattribute float instanceDistanceStart;\n\t\t\t\t\tattribute float instanceDistanceEnd;\n\t\t\t\t\tvarying float vLineDistance;\n\n\t\t\t\t#endif\n\n\t\t\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t\t\t// conservative estimate of the near plane\n\t\t\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#ifdef USE_COLOR\n\n\t\t\t\t\t\tvLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef USE_DASH\n\n\t\t\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\t\t\tvUv = uv;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t\t\t// camera space\n\t\t\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t\t\tworldStart = start.xyz;\n\t\t\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tvUv = uv;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\t\t\tif ( perspective ) {\n\n\t\t\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// clip space\n\t\t\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t\t\t// ndc space\n\t\t\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t\t\t// direction\n\t\t\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t\t\t// account for clip-space aspect ratio\n\t\t\t\t\tdir.x *= aspect;\n\t\t\t\t\tdir = normalize( dir );\n\n\t\t\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t\t\t// get the offset direction as perpendicular to the view vector\n\t\t\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\t\t\tvec3 offset;\n\t\t\t\t\t\tif ( position.y < 0.5 ) {\n\n\t\t\t\t\t\t\toffset = normalize( cross( start.xyz, worldDir ) );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\toffset = normalize( cross( end.xyz, worldDir ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// sign flip\n\t\t\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t\t\tfloat forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n\t\t\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t\t\t// extend the line bounds to encompass  endcaps\n\t\t\t\t\t\t\tstart.xyz += - worldDir * linewidth * 0.5;\n\t\t\t\t\t\t\tend.xyz += worldDir * linewidth * 0.5;\n\n\t\t\t\t\t\t\t// shift the position of the quad so it hugs the forward edge of the line\n\t\t\t\t\t\t\toffset.xy -= dir * forwardOffset;\n\t\t\t\t\t\t\toffset.z += 0.5;\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// endcaps\n\t\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\t\toffset.xy += dir * 2.0 * forwardOffset;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// adjust for linewidth\n\t\t\t\t\t\toffset *= linewidth * 0.5;\n\n\t\t\t\t\t\t// set the world position\n\t\t\t\t\t\tworldPos = ( position.y < 0.5 ) ? start : end;\n\t\t\t\t\t\tworldPos.xyz += offset;\n\n\t\t\t\t\t\t// project the worldpos\n\t\t\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t\t\t// segments overlap neatly\n\t\t\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\t\t\tdir.x /= aspect;\n\t\t\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t\t\t// sign flip\n\t\t\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t\t\t// endcaps\n\t\t\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\t\t\toffset += - dir;\n\n\t\t\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\t\t\toffset += dir;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// adjust for linewidth\n\t\t\t\t\t\toffset *= linewidth;\n\n\t\t\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t\t\t// select end\n\t\t\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t\t\t// back to clip space\n\t\t\t\t\t\toffset *= clip.w;\n\n\t\t\t\t\t\tclip.xy += offset;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\tgl_Position = clip;\n\n\t\t\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t\t\t#include <logdepthbuf_vertex>\n\t\t\t\t\t#include <clipping_planes_vertex>\n\t\t\t\t\t#include <fog_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:`\n\t\t\t\tuniform vec3 diffuse;\n\t\t\t\tuniform float opacity;\n\t\t\t\tuniform float linewidth;\n\n\t\t\t\t#ifdef USE_DASH\n\n\t\t\t\t\tuniform float dashOffset;\n\t\t\t\t\tuniform float dashSize;\n\t\t\t\t\tuniform float gapSize;\n\n\t\t\t\t#endif\n\n\t\t\t\tvarying float vLineDistance;\n\n\t\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t\tvarying vec4 worldPos;\n\t\t\t\t\tvarying vec3 worldStart;\n\t\t\t\t\tvarying vec3 worldEnd;\n\n\t\t\t\t\t#ifdef USE_DASH\n\n\t\t\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#else\n\n\t\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\t#endif\n\n\t\t\t\t#include <common>\n\t\t\t\t#include <fog_pars_fragment>\n\t\t\t\t#include <logdepthbuf_pars_fragment>\n\t\t\t\t#include <clipping_planes_pars_fragment>\n\n\t\t\t\t#ifdef USE_COLOR\n\t\t\t\t\t#ifdef USE_LINE_COLOR_ALPHA\n\t\t\t\t\t\tvarying vec4 vLineColor;\n\t\t\t\t\t#else\n\t\t\t\t\t\tvarying vec3 vLineColor;\n\t\t\t\t\t#endif\n\t\t\t\t#endif\n\n\t\t\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\t\t\tfloat mua;\n\t\t\t\t\tfloat mub;\n\n\t\t\t\t\tvec3 p13 = p1 - p3;\n\t\t\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\t\t\tmua = numer / denom;\n\t\t\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\t\t\treturn vec2( mua, mub );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t\t\t#ifdef USE_DASH\n\n\t\t\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\tfloat alpha = opacity;\n\n\t\t\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\t\t\tfloat len = length( delta );\n\t\t\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t\t\t#else\n\n\t\t\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t#else\n\n\t\t\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\t\t\t\t\t#ifdef USE_COLOR\n\t\t\t\t\t\t#ifdef USE_LINE_COLOR_ALPHA\n\t\t\t\t\t\t\tdiffuseColor *= vLineColor;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tdiffuseColor.rgb *= vLineColor;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\t\t\tgl_FragColor = diffuseColor;\n\n\t\t\t\t\t#include <tonemapping_fragment>\n\t\t\t\t\t#include <${parseInt(r.p.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>\n\t\t\t\t\t#include <fog_fragment>\n\t\t\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t\t\t}\n\t\t\t`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(e){!!e!="USE_DASH"in this.defines&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(e){!!e!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const On=new r.b,jn=new r.b,Bn=new r.aE,Dn=new r.aE,Un=new r.aE,Fn=new r.b,Hn=new r.l,Vn=new r.aF,Gn=new r.b,qn=new r.au,Wn=new r.av,Xn=new r.aE;let Yn,Kn,Qn,$n;function Jn(e,t,n){return Xn.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),Xn.multiplyScalar(1/Xn.w),Xn.x=$n/n.width,Xn.y=$n/n.height,Xn.applyMatrix4(e.projectionMatrixInverse),Xn.multiplyScalar(1/Xn.w),Math.abs(Math.max(Xn.x,Xn.y))}class Zn extends r.a8{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zn,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Nn({color:16777215*Math.random()})),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,o=new Float32Array(2*t.count);for(let r=0,a=0,s=t.count;r<s;r++,a+=2)On.fromBufferAttribute(t,r),jn.fromBufferAttribute(n,r),o[a]=0===a?0:o[a-1],o[a+1]=o[a]+On.distanceTo(jn);const i=new r.az(o,2,1);return e.setAttribute("instanceDistanceStart",new r.aq(i,1,0)),e.setAttribute("instanceDistanceEnd",new r.aq(i,1,1)),this}raycast(e,t){const n=this.material.worldUnits,o=e.camera;null===o&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const i=void 0!==e.params.Line2&&e.params.Line2.threshold||0;Yn=e.ray;const a=this.matrixWorld,s=this.geometry,l=this.material;let u,c;if($n=l.linewidth+i,Kn=s.attributes.instanceStart,Qn=s.attributes.instanceEnd,null===s.boundingSphere&&s.computeBoundingSphere(),Wn.copy(s.boundingSphere).applyMatrix4(a),n)u=.5*$n;else{u=Jn(o,Math.max(o.near,Wn.distanceToPoint(Yn.origin)),l.resolution)}if(Wn.radius+=u,!1!==Yn.intersectsSphere(Wn)){if(null===s.boundingBox&&s.computeBoundingBox(),qn.copy(s.boundingBox).applyMatrix4(a),n)c=.5*$n;else{c=Jn(o,Math.max(o.near,qn.distanceToPoint(Yn.origin)),l.resolution)}qn.expandByScalar(c),!1!==Yn.intersectsBox(qn)&&(n?function(e,t){for(let n=0,o=Kn.count;n<o;n++){Vn.start.fromBufferAttribute(Kn,n),Vn.end.fromBufferAttribute(Qn,n);const o=new r.b,i=new r.b;Yn.distanceSqToSegment(Vn.start,Vn.end,i,o),i.distanceTo(o)<.5*$n&&t.push({point:i,pointOnLine:o,distance:Yn.origin.distanceTo(i),object:e,face:null,faceIndex:n,uv:null,uv2:null})}}(this,t):function(e,t,n){const o=t.projectionMatrix,i=e.material.resolution,a=e.matrixWorld,s=e.geometry,l=s.attributes.instanceStart,u=s.attributes.instanceEnd,c=-t.near;Yn.at(1,Un),Un.w=1,Un.applyMatrix4(t.matrixWorldInverse),Un.applyMatrix4(o),Un.multiplyScalar(1/Un.w),Un.x*=i.x/2,Un.y*=i.y/2,Un.z=0,Fn.copy(Un),Hn.multiplyMatrices(t.matrixWorldInverse,a);for(let d=0,f=l.count;d<f;d++){if(Bn.fromBufferAttribute(l,d),Dn.fromBufferAttribute(u,d),Bn.w=1,Dn.w=1,Bn.applyMatrix4(Hn),Dn.applyMatrix4(Hn),Bn.z>c&&Dn.z>c)continue;if(Bn.z>c){const e=Bn.z-Dn.z,t=(Bn.z-c)/e;Bn.lerp(Dn,t)}else if(Dn.z>c){const e=Dn.z-Bn.z,t=(Dn.z-c)/e;Dn.lerp(Bn,t)}Bn.applyMatrix4(o),Dn.applyMatrix4(o),Bn.multiplyScalar(1/Bn.w),Dn.multiplyScalar(1/Dn.w),Bn.x*=i.x/2,Bn.y*=i.y/2,Dn.x*=i.x/2,Dn.y*=i.y/2,Vn.start.copy(Bn),Vn.start.z=0,Vn.end.copy(Dn),Vn.end.z=0;const t=Vn.closestPointToPointParameter(Fn,!0);Vn.at(t,Gn);const s=r.ad.lerp(Bn.z,Dn.z,t),f=s>=-1&&s<=1,h=Fn.distanceTo(Gn)<.5*$n;if(f&&h){Vn.start.fromBufferAttribute(l,d),Vn.end.fromBufferAttribute(u,d),Vn.start.applyMatrix4(a),Vn.end.applyMatrix4(a);const t=new r.b,o=new r.b;Yn.distanceSqToSegment(Vn.start,Vn.end,o,t),n.push({point:o,pointOnLine:t,distance:Yn.origin.distanceTo(o),object:e,face:null,faceIndex:d,uv:null,uv2:null})}}}(this,o,t))}}}class er extends Zn{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new kn,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Nn({color:16777215*Math.random()})),this.isLine2=!0,this.type="Line2"}}const tr=e=>"envMap"in e,nr=(e,t)=>{e.envMap=t,e.needsUpdate=!0},rr=(e,t)=>{t instanceof r.a8&&(Array.isArray(t.material)?t.material.forEach((t=>tr(t)?nr(t,e):void 0)):tr(t.material)&&nr(t.material,e))},or=e=>"envMapIntensity"in e,ir=(e,t)=>{e.envMapIntensity=t,e.needsUpdate=!0},ar=(e,t)=>{t instanceof r.a8&&(Array.isArray(t.material)?t.material.forEach((t=>or(t)?ir(t,e):void 0)):or(t.material)&&ir(t.material,e))};function sr(e,t){(function(e,t){Object.values(e.components).forEach((e=>{const{type:n,touchPointNodeName:o,visualResponses:i}=e;if(n===En.ComponentType.TOUCHPAD&&o)if(e.touchPointNode=t.getObjectByName(o),e.touchPointNode){const t=new r.aG(.001),n=new r.z({color:255}),o=new r.a8(t,n);e.touchPointNode.add(o)}else console.warn(`Could not find touch dot, ${e.touchPointNodeName}, in touchpad component ${e.id}`);Object.values(i).forEach((e=>{const{valueNodeName:n,minNodeName:r,maxNodeName:o,valueNodeProperty:i}=e;if(i===En.VisualResponseProperty.TRANSFORM&&r&&o){if(e.minNode=t.getObjectByName(r),e.maxNode=t.getObjectByName(o),!e.minNode)return void console.warn(`Could not find ${r} in the model`);if(!e.maxNode)return void console.warn(`Could not find ${o} in the model`)}e.valueNode=t.getObjectByName(n),e.valueNode||console.warn(`Could not find ${n} in the model`)}))}))})(e.motionController,t),(e.envMap||null!=e.envMapIntensity)&&t.traverse((t=>{e.envMap&&rr(e.envMap,t),null!=e.envMapIntensity&&ar(e.envMapIntensity,t)})),e.add(t)}class lr extends r.G{constructor(){super(),this.motionController=null,this.envMap=null,this.envMapIntensity=1,this.scene=null}setEnvironmentMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var n;return this.envMap===e&&this.envMapIntensity===t||(this.envMap=e,this.envMapIntensity=t,null==(n=this.scene)||n.traverse((n=>{rr(e,n),ar(t,n)}))),this}setEnvironmentMapIntensity(e){var t;return this.envMapIntensity===e||(this.envMapIntensity=e,null==(t=this.scene)||t.traverse((t=>ar(e,t)))),this}connectModel(e){this.motionController?(this.scene=e,sr(this,e),this.dispatchEvent({type:"modelconnected",data:e})):console.warn("scene tried to add, but no motion controller")}connectMotionController(e){this.motionController=e,this.dispatchEvent({type:"motionconnected",data:e})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((e=>{Object.values(e.visualResponses).forEach((e=>{const{valueNode:t,minNode:n,maxNode:r,value:o,valueNodeProperty:i}=e;t&&(i===En.VisualResponseProperty.VISIBILITY&&"boolean"==typeof o?t.visible=o:i===En.VisualResponseProperty.TRANSFORM&&n&&r&&"number"==typeof o&&(t.quaternion.slerpQuaternions(n.quaternion,r.quaternion,o),t.position.lerpVectors(n.position,r.position,o)))}))})))}disconnect(){this.dispatchEvent({type:"motiondisconnected",data:this.motionController}),this.dispatchEvent({type:"modeldisconnected",data:this.scene}),this.motionController=null,this.scene&&this.remove(this.scene),this.scene=null}dispose(){this.disconnect()}}const ur=o.forwardRef((function(e,t){let{target:n,hideOnBlur:i=!1,...a}=e;const s=gt((e=>e.hoverState)),l=o.useRef(null),u=o.useMemo((()=>(new r.h).setFromPoints([new r.b(0,0,0),new r.b(0,0,-1)])),[]);return o.useImperativeHandle(t,(()=>l.current)),ce((()=>{if(!n.inputSource)return;let e=1;const t=s[n.inputSource.handedness].values().next().value;t&&"none"!==n.inputSource.handedness?(e=t.distance,i&&(l.current.visible=!1)):i&&(l.current.visible=!0);l.current.scale.z=e+-.01})),o.createElement("line",{ref:l,geometry:u,"material-opacity":.8,"material-transparent":!0,...a})})),cr=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles";this.gltfLoader=e??new At,this.path=t,this._assetCache={}}initializeControllerModel(e,t){return"tracked-pointer"===t.targetRayMode&&t.gamepad?An(t,this.path,"generic-trigger").then((n=>{let{profile:r,assetPath:o}=n;if(!o)throw new Error("no asset path");const i=new Ln(t,r,o);e.connectMotionController(i);const a=i.assetUrl,s=this._assetCache[a];if(s){const t=s.scene.clone();e.connectModel(t)}else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(a,(t=>{if(!e.motionController)return void console.warn("motionController gone while gltf load, bailing...");this._assetCache[a]=t;const n=t.scene.clone();e.connectModel(n)}),void 0,(()=>{throw new Error(`Asset ${a} missing or malformed.`)}))}})).catch((e=>{console.warn(e)})):Promise.resolve()}},dr=e=>{let{target:t,envMap:n,envMapIntensity:r}=e;const i=o.useRef(null),a=tt((e=>{null!=n&&e.setEnvironmentMap(n)})),s=tt((e=>e.setEnvironmentMap(null))),l=tt((e=>{null!=r&&e.setEnvironmentMapIntensity(r)})),u=o.useCallback((e=>{var n,r,o;if(i.current=e,e){if(t.xrControllerModel=e,null!=(n=t.inputSource)&&n.hand)return;a.current(e),l.current(e),t.inputSource?cr.initializeControllerModel(e,t.inputSource):console.warn("no input source on XRController when handleControllerModel")}else{if(null!=(r=t.inputSource)&&r.hand)return;null==(o=t.xrControllerModel)||o.disconnect(),t.xrControllerModel=null}}),[t,l,a]);return o.useLayoutEffect((()=>{i.current&&(n?a.current(i.current):s.current(i.current))}),[n,a,s]),o.useLayoutEffect((()=>{i.current&&l.current(i.current)}),[r,l]),o.createElement("xRControllerModel",{ref:u})};function fr(e){let{rayMaterial:t={},hideRaysOnBlur:n=!1,envMap:r,envMapIntensity:i}=e;const a=gt((e=>e.controllers)),s=gt((e=>e.isHandTracking)),l=o.useMemo((()=>Object.entries(t).reduce(((e,t)=>{let[n,r]=t;return{...e,[`material-${n}`]:r}}),{})),[JSON.stringify(t)]);return o.useMemo((()=>b({XRControllerModel:lr})),[]),o.createElement(o.Fragment,null,a.map(((e,t)=>o.createElement(o.Fragment,{key:t},we(o.createElement(dr,{target:e,envMap:r,envMapIntensity:i}),e.grip),we(o.createElement(ur,{visible:!s,hideOnBlur:n,target:e,...l}),e.controller)))))}class hr{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/",r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.controller=t,this.handModel=e,this.bones=[];const i=new At;o||i.setPath(n),i.load(o??`${r}.glb`,(e=>{const t=e.scene.children[0];this.handModel.add(t),this.scene=t;const n=t.getObjectByProperty("type","SkinnedMesh");n.frustumCulled=!1,n.castShadow=!0,n.receiveShadow=!0,["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"].forEach((e=>{const n=t.getObjectByName(e);void 0!==n?n.jointName=e:console.warn(`Couldn't find ${e} in ${r} hand mesh`),this.bones.push(n)}))}))}updateMesh(){const e=this.controller.joints;let t=!0;for(let n=0;n<this.bones.length;n++){const r=this.bones[n];if(r){const n=e[r.jointName];if(n.visible){const e=n.position;r.position.copy(e),r.quaternion.copy(n.quaternion),t=!1}}}t&&this.scene?this.scene.visible=!1:this.scene&&(this.scene.visible=!0)}dispose(){this.scene&&this.handModel.remove(this.scene)}}class pr extends r.J{constructor(e,t,n){super(),this._onConnected=e=>{const t=e.data;t.hand&&!this.motionController&&(this.xrInputSource=t,this.motionController=new hr(this,this.controller,void 0,t.handedness,"left"===t.handedness?this.leftModelPath:this.rightModelPath))},this._onDisconnected=()=>{var e;null!=(e=this.xrInputSource)&&e.hand&&this.motionControllerCleanup()},this.controller=e,this.motionController=null,this.envMap=null,this.leftModelPath=t,this.rightModelPath=n,this.mesh=null,this.xrInputSource=null,e.addEventListener("connected",this._onConnected),e.addEventListener("disconnected",this._onDisconnected)}motionControllerCleanup(){var e;this.clear(),null==(e=this.motionController)||e.dispose(),this.motionController=null}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&this.motionController.updateMesh()}getPointerPosition(){const e=this.controller.joints["index-finger-tip"];return e?e.position:null}intersectBoxObject(e){const t=this.getPointerPosition();if(t){const n=new r.av(t,.01),o=(new r.au).setFromObject(e);return n.intersectsBox(o)}return!1}checkButton(e){this.intersectBoxObject(e)?e.onPress():e.onClear(),e.isPressed()&&e.whilePressed()}dispose(){this.motionControllerCleanup(),this.controller.removeEventListener("connected",this._onConnected),this.controller.removeEventListener("disconnected",this._onDisconnected)}}function mr(e){let{modelLeft:t,modelRight:n}=e;const r=gt((e=>e.controllers));return o.useMemo((()=>b({OculusHandModel:pr})),[]),et((()=>{for(const e of r)e.hand.dispatchEvent({type:"connected",data:e.inputSource,fake:!0})}),[r,t,n]),o.createElement(o.Fragment,null,r.map((e=>{let{hand:r}=e;return we(o.createElement("oculusHandModel",{args:[r,t,n]}),r)})))}const gr=o.forwardRef((function(e,t){let{points:n,color:i=16777215,vertexColors:a,linewidth:s,lineWidth:l,segments:u,dashed:c,...d}=e;var f;const h=ue((e=>e.size)),p=o.useMemo((()=>u?new Zn:new er),[u]),[m]=o.useState((()=>new Nn)),g=4===(null==a||null==(f=a[0])?void 0:f.length)?4:3,v=o.useMemo((()=>{const e=u?new zn:new kn,t=n.map((e=>{const t=Array.isArray(e);return e instanceof r.b||e instanceof r.aE?[e.x,e.y,e.z]:e instanceof r.V?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}));if(e.setPositions(t.flat()),a){i=16777215;const t=a.map((e=>e instanceof r.i?e.toArray():e));e.setColors(t.flat(),g)}return e}),[n,u,a,g]);return o.useLayoutEffect((()=>{p.computeLineDistances()}),[n,p]),o.useLayoutEffect((()=>{c?m.defines.USE_DASH="":delete m.defines.USE_DASH,m.needsUpdate=!0}),[c,m]),o.useEffect((()=>()=>v.dispose()),[v]),o.createElement("primitive",(0,r._)({object:p,ref:t},d),o.createElement("primitive",{object:v,attach:"geometry"}),o.createElement("primitive",(0,r._)({object:m,attach:"material",color:i,vertexColors:!!a,resolution:[h.width,h.height],linewidth:s??l,dashed:c,transparent:4===g},d)))})),vr=o.forwardRef(((e,t)=>{let{sdfGlyphSize:i=64,anchorX:a="center",anchorY:s="middle",font:l,fontSize:u=1,children:c,characters:d,onSync:f,...h}=e;const{Text:p,preloadFont:m}=v((async()=>n.e(690).then(n.bind(n,690))),[]),g=ue((e=>{let{invalidate:t}=e;return t})),[y]=o.useState((()=>new p)),[b,x]=o.useMemo((()=>{const e=[];let t="";return o.Children.forEach(c,(n=>{"string"==typeof n||"number"==typeof n?t+=n:e.push(n)})),[e,t]}),[c]);return v((()=>new Promise((e=>m({font:l,characters:d},e)))),["troika-text",l,d]),o.useLayoutEffect((()=>{y.sync((()=>{g(),f&&f(y)}))})),o.useEffect((()=>()=>y.dispose()),[y]),o.createElement("primitive",(0,r._)({object:y,ref:t,font:l,text:x,anchorX:a,anchorY:s,fontSize:u,sdfGlyphSize:i},h),b)})),yr=o.forwardRef(((e,t)=>{let{makeDefault:n,camera:i,regress:a,domElement:s,enableDamping:l=!0,keyEvents:u=!1,onChange:c,onStart:d,onEnd:f,...h}=e;const p=ue((e=>e.invalidate)),m=ue((e=>e.camera)),g=ue((e=>e.gl)),v=ue((e=>e.events)),y=ue((e=>e.setEvents)),b=ue((e=>e.set)),x=ue((e=>e.get)),w=ue((e=>e.performance)),S=i||m,_=s||v.connected||g.domElement,E=o.useMemo((()=>new Tt(S)),[S]);return ce((()=>{E.enabled&&E.update()}),-1),o.useEffect((()=>(u&&E.connect(!0===u?_:u),E.connect(_),()=>{E.dispose()})),[u,_,a,E,p]),o.useEffect((()=>{const e=e=>{p(),a&&w.regress(),c&&c(e)},t=e=>{d&&d(e)},n=e=>{f&&f(e)};return E.addEventListener("change",e),E.addEventListener("start",t),E.addEventListener("end",n),()=>{E.removeEventListener("start",t),E.removeEventListener("end",n),E.removeEventListener("change",e)}}),[c,d,f,E,p,y]),o.useEffect((()=>{if(n){const e=x().controls;return b({controls:E}),()=>b({controls:e})}}),[n,E]),o.createElement("primitive",(0,r._)({ref:t,object:E,enableDamping:l},h))})),br=0,xr=1,wr=2,Sr=2,_r=1.25,Er=1,Tr=32,Ar=65535,Pr=Math.pow(2,-24),Cr=Symbol("SKIP_GENERATION");function Mr(e){return function(e){return e.index?e.index.count:e.attributes.position.count}(e)/3}function Lr(e,t){if(!e.index){const n=e.attributes.position.count,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ArrayBuffer;return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}(n,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new r.Y(o,1));for(let e=0;e<n;e++)o[e]=e}}function Rr(e){const t=Mr(e),n=e.drawRange,r=n.start/3,o=(n.start+n.count)/3,i=Math.max(0,r),a=Math.min(t,o)-i;return[{offset:Math.floor(i),count:Math.floor(a)}]}function Ir(e){if(!e.groups||!e.groups.length)return Rr(e);const t=[],n=new Set,r=e.drawRange,o=r.start/3,i=(r.start+r.count)/3;for(const s of e.groups){const e=s.start/3,t=(s.start+s.count)/3;n.add(Math.max(o,e)),n.add(Math.min(i,t))}const a=Array.from(n.values()).sort(((e,t)=>e-t));for(let s=0;s<a.length-1;s++){const e=a[s],n=a[s+1];t.push({offset:Math.floor(e),count:Math.floor(n-e)})}return t}function zr(e,t,n,r,o){let i=1/0,a=1/0,s=1/0,l=-1/0,u=-1/0,c=-1/0,d=1/0,f=1/0,h=1/0,p=-1/0,m=-1/0,g=-1/0;for(let v=6*t,y=6*(t+n);v<y;v+=6){const t=e[v+0],n=e[v+1],r=t-n,o=t+n;r<i&&(i=r),o>l&&(l=o),t<d&&(d=t),t>p&&(p=t);const y=e[v+2],b=e[v+3],x=y-b,w=y+b;x<a&&(a=x),w>u&&(u=w),y<f&&(f=y),y>m&&(m=y);const S=e[v+4],_=e[v+5],E=S-_,T=S+_;E<s&&(s=E),T>c&&(c=T),S<h&&(h=S),S>g&&(g=S)}r[0]=i,r[1]=a,r[2]=s,r[3]=l,r[4]=u,r[5]=c,o[0]=d,o[1]=f,o[2]=h,o[3]=p,o[4]=m,o[5]=g}function kr(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function Nr(e){let t=-1,n=-1/0;for(let r=0;r<3;r++){const o=e[r+3]-e[r];o>n&&(n=o,t=r)}return t}function Or(e,t){t.set(e)}function jr(e,t,n){let r,o;for(let i=0;i<3;i++){const a=i+3;r=e[i],o=t[i],n[i]=r<o?r:o,r=e[a],o=t[a],n[a]=r>o?r:o}}function Br(e,t,n){for(let r=0;r<3;r++){const o=t[e+2*r],i=t[e+2*r+1],a=o-i,s=o+i;a<n[r]&&(n[r]=a),s>n[r+3]&&(n[r+3]=s)}}function Dr(e){const t=e[3]-e[0],n=e[4]-e[1],r=e[5]-e[2];return 2*(t*n+n*r+r*t)}const Ur=32,Fr=(e,t)=>e.candidate-t.candidate,Hr=new Array(Ur).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),Vr=new Float32Array(6);class Gr{constructor(){this.boundingData=new Float32Array(6)}}function qr(e,t,n,r,o,i){let a=r,s=r+o-1;const l=i.pos,u=2*i.axis;for(;;){for(;a<=s&&n[6*a+u]<l;)a++;for(;a<=s&&n[6*s+u]>=l;)s--;if(!(a<s))return a;for(let e=0;e<3;e++){let n=t[3*a+e];t[3*a+e]=t[3*s+e],t[3*s+e]=n}for(let e=0;e<6;e++){let t=n[6*a+e];n[6*a+e]=n[6*s+e],n[6*s+e]=t}a++,s--}}function Wr(e,t,n,r,o,i){let a=r,s=r+o-1;const l=i.pos,u=2*i.axis;for(;;){for(;a<=s&&n[6*a+u]<l;)a++;for(;a<=s&&n[6*s+u]>=l;)s--;if(!(a<s))return a;{let t=e[a];e[a]=e[s],e[s]=t;for(let e=0;e<6;e++){let t=n[6*a+e];n[6*a+e]=n[6*s+e],n[6*s+e]=t}a++,s--}}}function Xr(e,t){return 65535===t[e+15]}function Yr(e,t){return t[e+6]}function Kr(e,t){return t[e+14]}function Qr(e){return e+8}function $r(e,t){return t[e+6]}function Jr(e,t){return t[e+7]}let Zr,eo,to,no;const ro=Math.pow(2,32);function oo(e){return"count"in e?1:1+oo(e.left)+oo(e.right)}function io(e,t,n){return Zr=new Float32Array(n),eo=new Uint32Array(n),to=new Uint16Array(n),no=new Uint8Array(n),ao(e,t)}function ao(e,t){const n=e/4,r=e/2,o="count"in t,i=t.boundingData;for(let a=0;a<6;a++)Zr[n+a]=i[a];if(o){if(t.buffer){const r=t.buffer;no.set(new Uint8Array(r),e);for(let t=e,o=e+r.byteLength;t<o;t+=Tr){Xr(t/2,to)||(eo[t/4+6]+=n)}return e+r.byteLength}{const o=t.offset,i=t.count;return eo[n+6]=o,to[r+14]=i,to[r+15]=Ar,e+Tr}}{const r=t.left,o=t.right,i=t.splitAxis;let a;if(a=ao(e+Tr,r),a/4>ro)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return eo[n+6]=a/4,a=ao(a,o),eo[n+7]=i,a}}function so(e,t,n,r,o){const{maxDepth:i,verbose:a,maxLeafTris:s,strategy:l,onProgress:u,indirect:c}=o,d=e._indirectBuffer,f=e.geometry,h=f.index?f.index.array:null,p=c?Wr:qr,m=Mr(f),g=new Float32Array(6);let v=!1;const y=new Gr;return zr(t,n,r,y.boundingData,g),function e(n,r,o){let u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!v&&c>=i&&(v=!0,a&&(console.warn(`MeshBVH: Max depth of ${i} reached when generating BVH. Consider increasing maxDepth.`),console.warn(f))),o<=s||c>=i)return b(r+o),n.offset=r,n.count=o,n;const m=function(e,t,n,r,o,i){let a=-1,s=0;if(i===br)a=Nr(t),-1!==a&&(s=(t[a]+t[a+3])/2);else if(i===xr)a=Nr(e),-1!==a&&(s=function(e,t,n,r){let o=0;for(let i=t,a=t+n;i<a;i++)o+=e[6*i+2*r];return o/n}(n,r,o,a));else if(i===wr){const i=Dr(e);let l=_r*o;const u=6*r,c=6*(r+o);for(let e=0;e<3;e++){const r=t[e],d=(t[e+3]-r)/Ur;if(o<Ur/4){const t=[...Hr];t.length=o;let r=0;for(let o=u;o<c;o+=6,r++){const i=t[r];i.candidate=n[o+2*e],i.count=0;const{bounds:a,leftCacheBounds:s,rightCacheBounds:l}=i;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0;Br(o,n,a)}t.sort(Fr);let d=o;for(let e=0;e<d;e++){const n=t[e];for(;e+1<d&&t[e+1].candidate===n.candidate;)t.splice(e+1,1),d--}for(let o=u;o<c;o+=6){const r=n[o+2*e];for(let e=0;e<d;e++){const i=t[e];r>=i.candidate?Br(o,n,i.rightCacheBounds):(Br(o,n,i.leftCacheBounds),i.count++)}}for(let n=0;n<d;n++){const r=t[n],u=r.count,c=o-r.count,d=r.leftCacheBounds,f=r.rightCacheBounds;let h=0;0!==u&&(h=Dr(d)/i);let p=0;0!==c&&(p=Dr(f)/i);const m=Er+_r*(h*u+p*c);m<l&&(a=e,l=m,s=r.candidate)}}else{for(let e=0;e<Ur;e++){const t=Hr[e];t.count=0,t.candidate=r+d+e*d;const n=t.bounds;for(let e=0;e<3;e++)n[e]=1/0,n[e+3]=-1/0}for(let o=u;o<c;o+=6){let t=~~((n[o+2*e]-r)/d);t>=Ur&&(t=Ur-1);const i=Hr[t];i.count++,Br(o,n,i.bounds)}const t=Hr[Ur-1];Or(t.bounds,t.rightCacheBounds);for(let e=Ur-2;e>=0;e--){const t=Hr[e],n=Hr[e+1];jr(t.bounds,n.rightCacheBounds,t.rightCacheBounds)}let f=0;for(let n=0;n<Ur-1;n++){const t=Hr[n],r=t.count,u=t.bounds,c=Hr[n+1].rightCacheBounds;0!==r&&(0===f?Or(u,Vr):jr(u,Vr,Vr)),f+=r;let d=0,h=0;0!==f&&(d=Dr(Vr)/i);const p=o-f;0!==p&&(h=Dr(c)/i);const m=Er+_r*(d*f+h*p);m<l&&(a=e,l=m,s=t.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${i} used.`);return{axis:a,pos:s}}(n.boundingData,u,t,r,o,l);if(-1===m.axis)return b(r+o),n.offset=r,n.count=o,n;const y=p(d,h,t,r,o,m);if(y===r||y===r+o)b(r+o),n.offset=r,n.count=o;else{n.splitAxis=m.axis;const i=new Gr,a=r,s=y-r;n.left=i,zr(t,a,s,i.boundingData,g),e(i,a,s,g,c+1);const l=new Gr,u=y,d=o-s;n.right=l,zr(t,u,d,l.boundingData,g),e(l,u,d,g,c+1)}return n}(y,n,r,g),y;function b(e){u&&u(e/m)}}function lo(e,t){const n=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){const n=(e.index?e.index.count:e.attributes.position.count)/3,r=n>65536,o=r?4:2,i=t?new SharedArrayBuffer(n*o):new ArrayBuffer(n*o),a=r?new Uint32Array(i):new Uint16Array(i);for(let s=0,l=a.length;s<l;s++)a[s]=s;return a}(n,t.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;const t=Mr(e),n=Ir(e).sort(((e,t)=>e.offset-t.offset)),r=n[n.length-1];r.count=Math.min(t-r.offset,r.count);let o=0;return n.forEach((e=>{let{count:t}=e;return o+=t})),t!==o}(n)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||Lr(n,t);const r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=e.attributes.position,i=e.index?e.index.array:null,a=Mr(e),s=o.normalized;let l;null===t?(l=new Float32Array(6*a*4),n=0,r=a):(l=t,n=n||0,r=r||a);const u=o.array,c=o.offset||0;let d=3;o.isInterleavedBufferAttribute&&(d=o.data.stride);const f=["getX","getY","getZ"];for(let h=n;h<n+r;h++){const e=3*h,t=6*h;let n=e+0,r=e+1,a=e+2;i&&(n=i[n],r=i[r],a=i[a]),s||(n=n*d+c,r=r*d+c,a=a*d+c);for(let i=0;i<3;i++){let e,c,d;s?(e=o[f[i]](n),c=o[f[i]](r),d=o[f[i]](a)):(e=u[n+i],c=u[r+i],d=u[a+i]);let h=e;c<h&&(h=c),d<h&&(h=d);let p=e;c>p&&(p=c),d>p&&(p=d);const m=(p-h)/2,g=2*i;l[t+g+0]=h+m,l[t+g+1]=m+(Math.abs(h)+m)*Pr}}return l}(n),i=t.indirect?Rr(n):Ir(n);e._roots=i.map((n=>{const i=so(e,o,n.offset,n.count,t),a=oo(i),s=new r(Tr*a);return io(0,i,s),s}))}class uo{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,r=-1/0;for(let o=0,i=e.length;o<i;o++){const i=e[o][t];n=i<n?i:n,r=i>r?i:r}this.min=n,this.max=r}setFromPoints(e,t){let n=1/0,r=-1/0;for(let o=0,i=t.length;o<i;o++){const i=t[o],a=e.dot(i);n=a<n?a:n,r=a>r?a:r}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}}uo.prototype.setFromBox=function(){const e=new r.b;return function(t,n){const r=n.min,o=n.max;let i=1/0,a=-1/0;for(let s=0;s<=1;s++)for(let n=0;n<=1;n++)for(let l=0;l<=1;l++){e.x=r.x*s+o.x*(1-s),e.y=r.y*n+o.y*(1-n),e.z=r.z*l+o.z*(1-l);const u=t.dot(e);i=Math.min(u,i),a=Math.max(u,a)}this.min=i,this.max=a}}();const co=function(){const e=new r.b,t=new r.b,n=new r.b;return function(r,o,i){const a=r.start,s=e,l=o.start,u=t;n.subVectors(a,l),e.subVectors(r.end,r.start),t.subVectors(o.end,o.start);const c=n.dot(u),d=u.dot(s),f=u.dot(u),h=n.dot(s),p=s.dot(s)*f-d*d;let m,g;m=0!==p?(c*d-h*f)/p:0,g=(c+m*d)/f,i.x=m,i.y=g}}(),fo=function(){const e=new r.V,t=new r.b,n=new r.b;return function(r,o,i,a){co(r,o,e);let s=e.x,l=e.y;if(s>=0&&s<=1&&l>=0&&l<=1)return r.at(s,i),void o.at(l,a);if(s>=0&&s<=1)return l<0?o.at(0,a):o.at(1,a),void r.closestPointToPoint(a,!0,i);if(l>=0&&l<=1)return s<0?r.at(0,i):r.at(1,i),void o.closestPointToPoint(i,!0,a);{let e,u;e=s<0?r.start:r.end,u=l<0?o.start:o.end;const c=t,d=n;return r.closestPointToPoint(u,!0,t),o.closestPointToPoint(e,!0,n),c.distanceToSquared(u)<=d.distanceToSquared(e)?(i.copy(c),void a.copy(u)):(i.copy(e),void a.copy(d))}}}(),ho=function(){const e=new r.b,t=new r.b,n=new r.r,o=new r.aF;return function(r,i){const{radius:a,center:s}=r,{a:l,b:u,c:c}=i;if(o.start=l,o.end=u,o.closestPointToPoint(s,!0,e).distanceTo(s)<=a||(o.start=l,o.end=c,o.closestPointToPoint(s,!0,e).distanceTo(s)<=a)||(o.start=u,o.end=c,o.closestPointToPoint(s,!0,e).distanceTo(s)<=a))return!0;const d=i.getPlane(n);if(Math.abs(d.distanceToPoint(s))<=a){const e=d.projectPoint(s,t);if(i.containsPoint(e))return!0}return!1}}();function po(e){return Math.abs(e)<1e-15}class mo extends r.aH{constructor(){super(...arguments),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new r.b)),this.satBounds=new Array(4).fill().map((()=>new uo)),this.points=[this.a,this.b,this.c],this.sphere=new r.av,this.plane=new r.r,this.needsUpdate=!0}intersectsSphere(e){return ho(e,this)}update(){const e=this.a,t=this.b,n=this.c,r=this.points,o=this.satAxes,i=this.satBounds,a=o[0],s=i[0];this.getNormal(a),s.setFromPoints(a,r);const l=o[1],u=i[1];l.subVectors(e,t),u.setFromPoints(l,r);const c=o[2],d=i[2];c.subVectors(t,n),d.setFromPoints(c,r);const f=o[3],h=i[3];f.subVectors(n,e),h.setFromPoints(f,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}}mo.prototype.closestPointToSegment=function(){const e=new r.b,t=new r.b,n=new r.aF;return function(r){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{start:a,end:s}=r,l=this.points;let u,c=1/0;for(let d=0;d<3;d++){const a=(d+1)%3;n.start.copy(l[d]),n.end.copy(l[a]),fo(n,r,e,t),u=e.distanceToSquared(t),u<c&&(c=u,o&&o.copy(e),i&&i.copy(t))}return this.closestPointToPoint(a,e),u=a.distanceToSquared(e),u<c&&(c=u,o&&o.copy(e),i&&i.copy(a)),this.closestPointToPoint(s,e),u=s.distanceToSquared(e),u<c&&(c=u,o&&o.copy(e),i&&i.copy(s)),Math.sqrt(c)}}(),mo.prototype.intersectsTriangle=function(){const e=new mo,t=new Array(3),n=new Array(3),o=new uo,i=new uo,a=new r.b,s=new r.b,l=new r.b,u=new r.b,c=new r.b,d=new r.aF,f=new r.aF,h=new r.aF,p=new r.b;function m(e,t,n){const r=e.points;let o=0,i=-1;for(let a=0;a<3;a++){const{start:e,end:l}=d;e.copy(r[a]),l.copy(r[(a+1)%3]),d.delta(s);const u=po(t.distanceToPoint(e));if(po(t.normal.dot(s))&&u){n.copy(d),o=2;break}const c=t.intersectLine(d,p);if(!c&&u&&p.copy(e),(c||u)&&!po(p.distanceTo(l))){if(o<=1)(1===o?n.start:n.end).copy(p),u&&(i=o);else if(o>=2){(1===i?n.start:n.end).copy(p),o=2;break}if(o++,2===o&&-1===i)break}}return o}return function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),r.isExtendedTriangle?r.needsUpdate&&r.update():(e.copy(r),e.update(),r=e);const p=this.plane,g=r.plane;if(Math.abs(p.normal.dot(g.normal))>1-1e-10){const e=this.satBounds,l=this.satAxes;n[0]=r.a,n[1]=r.b,n[2]=r.c;for(let t=0;t<4;t++){const r=e[t],i=l[t];if(o.setFromPoints(i,n),r.isSeparated(o))return!1}const u=r.satBounds,c=r.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let n=0;n<4;n++){const e=u[n],r=c[n];if(o.setFromPoints(r,t),e.isSeparated(o))return!1}for(let r=0;r<4;r++){const e=l[r];for(let r=0;r<4;r++){const s=c[r];if(a.crossVectors(e,s),o.setFromPoints(a,t),i.setFromPoints(a,n),o.isSeparated(i))return!1}}return s&&(d||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),s.start.set(0,0,0),s.end.set(0,0,0)),!0}{const e=m(this,g,f);if(1===e&&r.containsPoint(f.end))return s&&(s.start.copy(f.end),s.end.copy(f.end)),!0;if(2!==e)return!1;const t=m(r,p,h);if(1===t&&this.containsPoint(h.end))return s&&(s.start.copy(h.end),s.end.copy(h.end)),!0;if(2!==t)return!1;if(f.delta(l),h.delta(u),l.dot(u)<0){let e=h.start;h.start=h.end,h.end=e}const n=f.start.dot(l),o=f.end.dot(l),i=h.start.dot(l),a=h.end.dot(l);return(n===a||i===o||o<i!==n<a)&&(s&&(c.subVectors(f.start,h.start),c.dot(l)>0?s.start.copy(f.start):s.start.copy(h.start),c.subVectors(f.end,h.end),c.dot(l)<0?s.end.copy(f.end):s.end.copy(h.end)),!0)}}}(),mo.prototype.distanceToPoint=function(){const e=new r.b;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),mo.prototype.distanceToTriangle=function(){const e=new r.b,t=new r.b,n=["a","b","c"],o=new r.aF,i=new r.aF;return function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const l=a||s?o:null;if(this.intersectsTriangle(r,l))return(a||s)&&(a&&l.getCenter(a),s&&l.getCenter(s)),0;let u=1/0;for(let t=0;t<3;t++){let o;const i=n[t],l=r[i];this.closestPointToPoint(l,e),o=l.distanceToSquared(e),o<u&&(u=o,a&&a.copy(e),s&&s.copy(l));const c=this[i];r.closestPointToPoint(c,e),o=c.distanceToSquared(e),o<u&&(u=o,a&&a.copy(c),s&&s.copy(e))}for(let c=0;c<3;c++){const l=n[c],d=n[(c+1)%3];o.set(this[l],this[d]);for(let c=0;c<3;c++){const l=n[c],d=n[(c+1)%3];i.set(r[l],r[d]),fo(o,i,e,t);const f=e.distanceToSquared(t);f<u&&(u=f,a&&a.copy(e),s&&s.copy(t))}}return Math.sqrt(u)}}();class go{constructor(e,t,n){this.isOrientedBox=!0,this.min=new r.b,this.max=new r.b,this.matrix=new r.l,this.invMatrix=new r.l,this.points=new Array(8).fill().map((()=>new r.b)),this.satAxes=new Array(3).fill().map((()=>new r.b)),this.satBounds=new Array(3).fill().map((()=>new uo)),this.alignedSatBounds=new Array(3).fill().map((()=>new uo)),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),n&&this.matrix.copy(n)}set(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}go.prototype.update=function(){const e=this.matrix,t=this.min,n=this.max,r=this.points;for(let l=0;l<=1;l++)for(let o=0;o<=1;o++)for(let i=0;i<=1;i++){const a=r[1*l|2*o|4*i];a.x=l?n.x:t.x,a.y=o?n.y:t.y,a.z=i?n.z:t.z,a.applyMatrix4(e)}const o=this.satBounds,i=this.satAxes,a=r[0];for(let l=0;l<3;l++){const e=i[l],t=o[l],n=r[1<<l];e.subVectors(a,n),t.setFromPoints(e,r)}const s=this.alignedSatBounds;s[0].setFromPointsField(r,"x"),s[1].setFromPointsField(r,"y"),s[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},go.prototype.intersectsBox=function(){const e=new uo;return function(t){this.needsUpdate&&this.update();const n=t.min,r=t.max,o=this.satBounds,i=this.satAxes,a=this.alignedSatBounds;if(e.min=n.x,e.max=r.x,a[0].isSeparated(e)||(e.min=n.y,e.max=r.y,a[1].isSeparated(e))||(e.min=n.z,e.max=r.z,a[2].isSeparated(e)))return!1;for(let s=0;s<3;s++){const n=i[s],r=o[s];if(e.setFromBox(n,t),r.isSeparated(e))return!1}return!0}}(),go.prototype.intersectsTriangle=function(){const e=new mo,t=new Array(3),n=new uo,o=new uo,i=new r.b;return function(r){this.needsUpdate&&this.update(),r.isExtendedTriangle?r.needsUpdate&&r.update():(e.copy(r),e.update(),r=e);const a=this.satBounds,s=this.satAxes;t[0]=r.a,t[1]=r.b,t[2]=r.c;for(let e=0;e<3;e++){const r=a[e],o=s[e];if(n.setFromPoints(o,t),r.isSeparated(n))return!1}const l=r.satBounds,u=r.satAxes,c=this.points;for(let e=0;e<3;e++){const t=l[e],r=u[e];if(n.setFromPoints(r,c),t.isSeparated(n))return!1}for(let e=0;e<3;e++){const r=s[e];for(let e=0;e<4;e++){const a=u[e];if(i.crossVectors(r,a),n.setFromPoints(i,t),o.setFromPoints(i,c),n.isSeparated(o))return!1}}return!0}}(),go.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},go.prototype.distanceToPoint=function(){const e=new r.b;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),go.prototype.distanceToBox=function(){const e=["x","y","z"],t=new Array(12).fill().map((()=>new r.aF)),n=new Array(12).fill().map((()=>new r.aF)),o=new r.b,i=new r.b;return function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(r))return(s||l)&&(r.getCenter(i),this.closestPointToPoint(i,o),r.closestPointToPoint(o,i),s&&s.copy(o),l&&l.copy(i)),0;const u=a*a,c=r.min,d=r.max,f=this.points;let h=1/0;for(let e=0;e<8;e++){const t=f[e];i.copy(t).clamp(c,d);const n=t.distanceToSquared(i);if(n<h&&(h=n,s&&s.copy(t),l&&l.copy(i),n<u))return Math.sqrt(n)}let p=0;for(let o=0;o<3;o++)for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){const a=(o+1)%3,s=(o+2)%3,l=1<<o|r<<a|i<<s,u=f[r<<a|i<<s],h=f[l];t[p].set(u,h);const m=e[o],g=e[a],v=e[s],y=n[p],b=y.start,x=y.end;b[m]=c[m],b[g]=r?c[g]:d[g],b[v]=i?c[v]:d[g],x[m]=d[m],x[g]=r?c[g]:d[g],x[v]=i?c[v]:d[g],p++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){i.x=e?d.x:c.x,i.y=t?d.y:c.y,i.z=n?d.z:c.z,this.closestPointToPoint(i,o);const r=i.distanceToSquared(o);if(r<h&&(h=r,s&&s.copy(o),l&&l.copy(i),r<u))return Math.sqrt(r)}for(let e=0;e<12;e++){const r=t[e];for(let e=0;e<12;e++){const t=n[e];fo(r,t,o,i);const a=o.distanceToSquared(i);if(a<h&&(h=a,s&&s.copy(o),l&&l.copy(i),a<u))return Math.sqrt(a)}}return Math.sqrt(h)}}();class vo{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class yo extends vo{constructor(){super((()=>new mo))}}const bo=new yo;const xo=new class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let t=null;this.setBuffer=n=>{t&&e.push(t),t=n,this.float32Array=new Float32Array(n),this.uint16Array=new Uint16Array(n),this.uint32Array=new Uint32Array(n)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}};let wo,So;const _o=[],Eo=new vo((()=>new r.au));function To(e,t,n,r,o,i){wo=Eo.getPrimitive(),So=Eo.getPrimitive(),_o.push(wo,So),xo.setBuffer(e._roots[t]);const a=Ao(0,e.geometry,n,r,o,i);xo.clearBuffer(),Eo.releasePrimitive(wo),Eo.releasePrimitive(So),_o.pop(),_o.pop();const s=_o.length;return s>0&&(So=_o[s-1],wo=_o[s-2]),a}function Ao(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const{float32Array:s,uint16Array:l,uint32Array:u}=xo;let c=2*e;if(Xr(c,l)){const t=Yr(e,u),n=Kr(c,l);return kr(e,s,wo),r(t,n,!1,a,i+e,wo)}{let c=function(e){const{uint16Array:t,uint32Array:n}=xo;let r=2*e;for(;!Xr(r,t);)r=2*(e=Qr(e));return Yr(e,n)},d=function(e){const{uint16Array:t,uint32Array:n}=xo;let r=2*e;for(;!Xr(r,t);)r=2*(e=$r(e,n));return Yr(e,n)+Kr(r,t)};const f=Qr(e),h=$r(e,u);let p,m,g,v,y=f,b=h;if(o&&(g=wo,v=So,kr(y,s,g),kr(b,s,v),p=o(g),m=o(v),m<p)){y=h,b=f;const e=p;p=m,m=e,g=v}g||(g=wo,kr(y,s,g));const x=n(g,Xr(2*y,l),p,a+1,i+y);let w;if(x===Sr){const e=c(y);w=r(e,d(y)-e,!0,a+1,i+y,g)}else w=x&&Ao(y,t,n,r,o,i,a+1);if(w)return!0;v=So,kr(b,s,v);const S=n(v,Xr(2*b,l),m,a+1,i+b);let _;if(S===Sr){const e=c(b);_=r(e,d(b)-e,!0,a+1,i+b,v)}else _=S&&Ao(b,t,n,r,o,i,a+1);return!!_}}const Po=new r.b,Co=new r.b;const Mo=new r.b,Lo=new r.b,Ro=new r.b,Io=new r.V,zo=new r.V,ko=new r.V,No=new r.b,Oo=new r.b,jo=new r.b,Bo=new r.b;function Do(e,t,n,o,i,a,s,l,u){Mo.fromBufferAttribute(t,a),Lo.fromBufferAttribute(t,s),Ro.fromBufferAttribute(t,l);const c=function(e,t,n,o,i,a){let s;return s=a===r.aI?e.intersectTriangle(o,n,t,!0,i):e.intersectTriangle(t,n,o,a!==r.a5,i),null===s?null:{distance:e.origin.distanceTo(i),point:i.clone()}}(e,Mo,Lo,Ro,Bo,u);if(c){o&&(Io.fromBufferAttribute(o,a),zo.fromBufferAttribute(o,s),ko.fromBufferAttribute(o,l),c.uv=r.aH.getInterpolation(Bo,Mo,Lo,Ro,Io,zo,ko,new r.V)),i&&(Io.fromBufferAttribute(i,a),zo.fromBufferAttribute(i,s),ko.fromBufferAttribute(i,l),c.uv1=r.aH.getInterpolation(Bo,Mo,Lo,Ro,Io,zo,ko,new r.V)),n&&(No.fromBufferAttribute(n,a),Oo.fromBufferAttribute(n,s),jo.fromBufferAttribute(n,l),c.normal=r.aH.getInterpolation(Bo,Mo,Lo,Ro,No,Oo,jo,new r.b),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));const t={a:a,b:s,c:l,normal:new r.b,materialIndex:0};r.aH.getNormal(Mo,Lo,Ro,t.normal),c.face=t,c.faceIndex=a}return c}function Uo(e,t,n,r,o){const i=3*r;let a=i+0,s=i+1,l=i+2;const u=e.index;e.index&&(a=u.getX(a),s=u.getX(s),l=u.getX(l));const{position:c,normal:d,uv:f,uv1:h}=e.attributes,p=Do(n,c,d,f,h,a,s,l,t);return p?(p.faceIndex=r,o&&o.push(p),p):null}function Fo(e,t,n,r){const o=e.a,i=e.b,a=e.c;let s=t,l=t+1,u=t+2;n&&(s=n.getX(s),l=n.getX(l),u=n.getX(u)),o.x=r.getX(s),o.y=r.getY(s),o.z=r.getZ(s),i.x=r.getX(l),i.y=r.getY(l),i.z=r.getZ(l),a.x=r.getX(u),a.y=r.getY(u),a.z=r.getZ(u)}function Ho(e,t,n,r,o,i,a){const{geometry:s}=n,{index:l}=s,u=s.attributes.position;for(let c=e,d=t+e;c<d;c++){let e;if(e=c,Fo(a,3*e,l,u),a.needsUpdate=!0,r(a,e,o,i))return!0}return!1}function Vo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&Array.isArray(t)&&(t=new Set(t));const n=e.geometry,r=n.index?n.index.array:null,o=n.attributes.position;let i,a,s,l,u=0;const c=e._roots;for(let f=0,h=c.length;f<h;f++)i=c[f],a=new Uint32Array(i),s=new Uint16Array(i),l=new Float32Array(i),d(0,u),u+=i.byteLength;function d(e,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const u=2*e;if(s[u+15]===Ar){const t=a[e+6];let n=1/0,i=1/0,c=1/0,d=-1/0,f=-1/0,h=-1/0;for(let e=3*t,a=3*(t+s[u+14]);e<a;e++){let t=r[e];const a=o.getX(t),s=o.getY(t),l=o.getZ(t);a<n&&(n=a),a>d&&(d=a),s<i&&(i=s),s>f&&(f=s),l<c&&(c=l),l>h&&(h=l)}return(l[e+0]!==n||l[e+1]!==i||l[e+2]!==c||l[e+3]!==d||l[e+4]!==f||l[e+5]!==h)&&(l[e+0]=n,l[e+1]=i,l[e+2]=c,l[e+3]=d,l[e+4]=f,l[e+5]=h,!0)}{const r=e+8,o=a[e+6],s=r+n,u=o+n;let c=i,f=!1,h=!1;t?c||(f=t.has(s),h=t.has(u),c=!f&&!h):(f=!0,h=!0);const p=c||h;let m=!1;(c||f)&&(m=d(r,n,c));let g=!1;p&&(g=d(o,n,c));const v=m||g;if(v)for(let t=0;t<3;t++){const n=r+t,i=o+t,a=l[n],s=l[n+3],u=l[i],c=l[i+3];l[e+t]=a<u?a:u,l[e+t+3]=s>c?s:c}return v}}}const Go=new r.au;function qo(e,t,n,r){return kr(e,t,Go),n.intersectBox(Go,r)}function Wo(e,t,n,r,o,i,a){const{geometry:s}=n,{index:l}=s,u=s.attributes.position;for(let c=e,d=t+e;c<d;c++){let e;if(e=n.resolveTriangleIndex(c),Fo(a,3*e,l,u),a.needsUpdate=!0,r(a,e,o,i))return!0}return!1}const Xo=new r.b;function Yo(e,t,n,r,o){xo.setBuffer(e._roots[t]),Ko(0,e,n,r,o),xo.clearBuffer()}function Ko(e,t,n,r,o){const{float32Array:i,uint16Array:a,uint32Array:s}=xo,l=2*e;if(Xr(l,a)){!function(e,t,n,r,o,i){const{geometry:a,_indirectBuffer:s}=e;for(let l=r,u=r+o;l<u;l++)Uo(a,t,n,l,i)}(t,n,r,Yr(e,s),Kr(l,a),o)}else{const a=Qr(e);qo(a,i,r,Xo)&&Ko(a,t,n,r,o);const l=$r(e,s);qo(l,i,r,Xo)&&Ko(l,t,n,r,o)}}const Qo=new r.b,$o=["x","y","z"];function Jo(e,t,n,r){xo.setBuffer(e._roots[t]);const o=Zo(0,e,n,r);return xo.clearBuffer(),o}function Zo(e,t,n,r){const{float32Array:o,uint16Array:i,uint32Array:a}=xo;let s=2*e;if(Xr(s,i)){return function(e,t,n,r,o){const{geometry:i,_indirectBuffer:a}=e;let s=1/0,l=null;for(let u=r,c=r+o;u<c;u++){let e;e=Uo(i,t,n,u),e&&e.distance<s&&(l=e,s=e.distance)}return l}(t,n,r,Yr(e,a),Kr(s,i))}{const i=Jr(e,a),s=$o[i],l=r.direction[s]>=0;let u,c;l?(u=Qr(e),c=$r(e,a)):(u=$r(e,a),c=Qr(e));const d=qo(u,o,r,Qo)?Zo(u,t,n,r):null;if(d){const e=d.point[s];if(l?e<=o[c+i]:e>=o[c+i+3])return d}const f=qo(c,o,r,Qo)?Zo(c,t,n,r):null;return d&&f?d.distance<=f.distance?d:f:d||f||null}}const ei=new r.au,ti=new mo,ni=new mo,ri=new r.l,oi=new go,ii=new go;function ai(e,t,n,r){xo.setBuffer(e._roots[t]);const o=si(0,e,n,r);return xo.clearBuffer(),o}function si(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const{float32Array:i,uint16Array:a,uint32Array:s}=xo;let l=2*e;if(null===o&&(n.boundingBox||n.computeBoundingBox(),oi.set(n.boundingBox.min,n.boundingBox.max,r),o=oi),!Xr(l,a)){const a=e+8,l=s[e+6];return kr(a,i,ei),!!(o.intersectsBox(ei)&&si(a,t,n,r,o)||(kr(l,i,ei),o.intersectsBox(ei)&&si(l,t,n,r,o)))}{const o=t.geometry,u=o.index,c=o.attributes.position,d=n.index,f=n.attributes.position,h=Yr(e,s),p=Kr(l,a);if(ri.copy(r).invert(),n.boundsTree)return kr(e,i,ii),ii.matrix.copy(ri),ii.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>ii.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let t=3*h,n=3*(p+h);t<n;t+=3)if(Fo(ni,t,u,c),ni.needsUpdate=!0,e.intersectsTriangle(ni))return!0;return!1}});for(let e=3*h,t=3*(p+h);e<t;e+=3){Fo(ti,e,u,c),ti.a.applyMatrix4(ri),ti.b.applyMatrix4(ri),ti.c.applyMatrix4(ri),ti.needsUpdate=!0;for(let e=0,t=d.count;e<t;e+=3)if(Fo(ni,e,d,f),ni.needsUpdate=!0,ti.intersectsTriangle(ni))return!0}}}const li=new r.l,ui=new go,ci=new go,di=new r.b,fi=new r.b,hi=new r.b,pi=new r.b;function mi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),ui.set(t.boundingBox.min,t.boundingBox.max,n),ui.needsUpdate=!0;const s=e.geometry,l=s.attributes.position,u=s.index,c=t.attributes.position,d=t.index,f=bo.getPrimitive(),h=bo.getPrimitive();let p=di,m=fi,g=null,v=null;o&&(g=hi,v=pi);let y=1/0,b=null,x=null;return li.copy(n).invert(),ci.matrix.copy(li),e.shapecast({boundsTraverseOrder:e=>ui.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<a&&(t&&(ci.min.copy(e.min),ci.max.copy(e.max),ci.needsUpdate=!0),!0),intersectsRange:(e,r)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>ci.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<a,intersectsRange:(t,o)=>{for(let a=t,s=t+o;a<s;a++){Fo(h,3*a,d,c),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++){Fo(f,3*t,u,l),f.needsUpdate=!0;const e=f.distanceToTriangle(h,p,g);if(e<y&&(m.copy(p),v&&v.copy(g),y=e,b=t,x=a),e<i)return!0}}}});for(let o=0,a=Mr(t);o<a;o++){Fo(h,3*o,d,c),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++){Fo(f,3*t,u,l),f.needsUpdate=!0;const e=f.distanceToTriangle(h,p,g);if(e<y&&(m.copy(p),v&&v.copy(g),y=e,b=t,x=o),e<i)return!0}}}}),bo.releasePrimitive(f),bo.releasePrimitive(h),y===1/0?null:(r.point?r.point.copy(m):r.point=m.clone(),r.distance=y,r.faceIndex=b,o&&(o.point?o.point.copy(v):o.point=v.clone(),o.point.applyMatrix4(li),m.applyMatrix4(li),o.distance=m.sub(o.point).length(),o.faceIndex=x),r)}function gi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&Array.isArray(t)&&(t=new Set(t));const n=e.geometry,r=n.index?n.index.array:null,o=n.attributes.position;let i,a,s,l,u=0;const c=e._roots;for(let f=0,h=c.length;f<h;f++)i=c[f],a=new Uint32Array(i),s=new Uint16Array(i),l=new Float32Array(i),d(0,u),u+=i.byteLength;function d(n,i){let u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const c=2*n;if(s[c+15]===Ar){const t=a[n+6];let i=1/0,u=1/0,d=1/0,f=-1/0,h=-1/0,p=-1/0;for(let n=t,a=t+s[c+14];n<a;n++){const t=3*e.resolveTriangleIndex(n);for(let e=0;e<3;e++){let n=t+e;n=r?r[n]:n;const a=o.getX(n),s=o.getY(n),l=o.getZ(n);a<i&&(i=a),a>f&&(f=a),s<u&&(u=s),s>h&&(h=s),l<d&&(d=l),l>p&&(p=l)}}return(l[n+0]!==i||l[n+1]!==u||l[n+2]!==d||l[n+3]!==f||l[n+4]!==h||l[n+5]!==p)&&(l[n+0]=i,l[n+1]=u,l[n+2]=d,l[n+3]=f,l[n+4]=h,l[n+5]=p,!0)}{const e=n+8,r=a[n+6],o=e+i,s=r+i;let c=u,f=!1,h=!1;t?c||(f=t.has(o),h=t.has(s),c=!f&&!h):(f=!0,h=!0);const p=c||h;let m=!1;(c||f)&&(m=d(e,i,c));let g=!1;p&&(g=d(r,i,c));const v=m||g;if(v)for(let t=0;t<3;t++){const o=e+t,i=r+t,a=l[o],s=l[o+3],u=l[i],c=l[i+3];l[n+t]=a<u?a:u,l[n+t+3]=s>c?s:c}return v}}}const vi=new r.b;function yi(e,t,n,r,o){xo.setBuffer(e._roots[t]),bi(0,e,n,r,o),xo.clearBuffer()}function bi(e,t,n,r,o){const{float32Array:i,uint16Array:a,uint32Array:s}=xo,l=2*e;if(Xr(l,a)){!function(e,t,n,r,o,i){const{geometry:a,_indirectBuffer:s}=e;for(let l=r,u=r+o;l<u;l++)Uo(a,t,n,s?s[l]:l,i)}(t,n,r,Yr(e,s),Kr(l,a),o)}else{const a=Qr(e);qo(a,i,r,vi)&&bi(a,t,n,r,o);const l=$r(e,s);qo(l,i,r,vi)&&bi(l,t,n,r,o)}}const xi=new r.b,wi=["x","y","z"];function Si(e,t,n,r){xo.setBuffer(e._roots[t]);const o=_i(0,e,n,r);return xo.clearBuffer(),o}function _i(e,t,n,r){const{float32Array:o,uint16Array:i,uint32Array:a}=xo;let s=2*e;if(Xr(s,i)){return function(e,t,n,r,o){const{geometry:i,_indirectBuffer:a}=e;let s=1/0,l=null;for(let u=r,c=r+o;u<c;u++){let e;e=Uo(i,t,n,a?a[u]:u),e&&e.distance<s&&(l=e,s=e.distance)}return l}(t,n,r,Yr(e,a),Kr(s,i))}{const i=Jr(e,a),s=wi[i],l=r.direction[s]>=0;let u,c;l?(u=Qr(e),c=$r(e,a)):(u=$r(e,a),c=Qr(e));const d=qo(u,o,r,xi)?_i(u,t,n,r):null;if(d){const e=d.point[s];if(l?e<=o[c+i]:e>=o[c+i+3])return d}const f=qo(c,o,r,xi)?_i(c,t,n,r):null;return d&&f?d.distance<=f.distance?d:f:d||f||null}}const Ei=new r.au,Ti=new mo,Ai=new mo,Pi=new r.l,Ci=new go,Mi=new go;function Li(e,t,n,r){xo.setBuffer(e._roots[t]);const o=Ri(0,e,n,r);return xo.clearBuffer(),o}function Ri(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const{float32Array:i,uint16Array:a,uint32Array:s}=xo;let l=2*e;if(null===o&&(n.boundingBox||n.computeBoundingBox(),Ci.set(n.boundingBox.min,n.boundingBox.max,r),o=Ci),!Xr(l,a)){const a=e+8,l=s[e+6];return kr(a,i,Ei),!!(o.intersectsBox(Ei)&&Ri(a,t,n,r,o)||(kr(l,i,Ei),o.intersectsBox(Ei)&&Ri(l,t,n,r,o)))}{const o=t.geometry,u=o.index,c=o.attributes.position,d=n.index,f=n.attributes.position,h=Yr(e,s),p=Kr(l,a);if(Pi.copy(r).invert(),n.boundsTree)return kr(e,i,Mi),Mi.matrix.copy(Pi),Mi.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>Mi.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let n=h,r=p+h;n<r;n++)if(Fo(Ai,3*t.resolveTriangleIndex(n),u,c),Ai.needsUpdate=!0,e.intersectsTriangle(Ai))return!0;return!1}});for(let e=h,n=p+h;e<n;e++){const n=t.resolveTriangleIndex(e);Fo(Ti,3*n,u,c),Ti.a.applyMatrix4(Pi),Ti.b.applyMatrix4(Pi),Ti.c.applyMatrix4(Pi),Ti.needsUpdate=!0;for(let e=0,t=d.count;e<t;e+=3)if(Fo(Ai,e,d,f),Ai.needsUpdate=!0,Ti.intersectsTriangle(Ai))return!0}}}const Ii=new r.l,zi=new go,ki=new go,Ni=new r.b,Oi=new r.b,ji=new r.b,Bi=new r.b;function Di(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),zi.set(t.boundingBox.min,t.boundingBox.max,n),zi.needsUpdate=!0;const s=e.geometry,l=s.attributes.position,u=s.index,c=t.attributes.position,d=t.index,f=bo.getPrimitive(),h=bo.getPrimitive();let p=Ni,m=Oi,g=null,v=null;o&&(g=ji,v=Bi);let y=1/0,b=null,x=null;return Ii.copy(n).invert(),ki.matrix.copy(Ii),e.shapecast({boundsTraverseOrder:e=>zi.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<a&&(t&&(ki.min.copy(e.min),ki.max.copy(e.max),ki.needsUpdate=!0),!0),intersectsRange:(r,o)=>{if(t.boundsTree){const s=t.boundsTree;return s.shapecast({boundsTraverseOrder:e=>ki.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<a,intersectsRange:(t,a)=>{for(let w=t,S=t+a;w<S;w++){const t=s.resolveTriangleIndex(w);Fo(h,3*t,d,c),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let n=r,a=r+o;n<a;n++){const t=e.resolveTriangleIndex(n);Fo(f,3*t,u,l),f.needsUpdate=!0;const r=f.distanceToTriangle(h,p,g);if(r<y&&(m.copy(p),v&&v.copy(g),y=r,b=n,x=w),r<i)return!0}}}})}for(let a=0,s=Mr(t);a<s;a++){Fo(h,3*a,d,c),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let t=r,n=r+o;t<n;t++){const n=e.resolveTriangleIndex(t);Fo(f,3*n,u,l),f.needsUpdate=!0;const r=f.distanceToTriangle(h,p,g);if(r<y&&(m.copy(p),v&&v.copy(g),y=r,b=t,x=a),r<i)return!0}}}}),bo.releasePrimitive(f),bo.releasePrimitive(h),y===1/0?null:(r.point?r.point.copy(m):r.point=m.clone(),r.distance=y,r.faceIndex=b,o&&(o.point?o.point.copy(v):o.point=v.clone(),o.point.applyMatrix4(Ii),m.applyMatrix4(Ii),o.distance=m.sub(o.point).length(),o.faceIndex=x),r)}const Ui=new xo.constructor,Fi=new xo.constructor,Hi=new vo((()=>new r.au)),Vi=new r.au,Gi=new r.au,qi=new r.au,Wi=new r.au;let Xi=!1;function Yi(e,t,n,r,o){let i,a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,f=arguments.length>10&&void 0!==arguments[10]&&arguments[10];f?(i=Fi,a=Ui):(i=Ui,a=Fi);const h=i.float32Array,p=i.uint32Array,m=i.uint16Array,g=a.float32Array,v=a.uint32Array,y=a.uint16Array,b=2*t,x=Xr(2*e,m),w=Xr(b,y);let S=!1;if(w&&x)S=f?o(Yr(t,v),Kr(2*t,y),Yr(e,p),Kr(2*e,m),c,l+t,u,s+e):o(Yr(e,p),Kr(2*e,m),Yr(t,v),Kr(2*t,y),u,s+e,c,l+t);else if(w){const i=Hi.getPrimitive();kr(t,g,i),i.applyMatrix4(n);const a=Qr(e),d=$r(e,p);kr(a,h,Vi),kr(d,h,Gi);const m=i.intersectsBox(Vi),v=i.intersectsBox(Gi);S=m&&Yi(t,a,r,n,o,l,s,c,u+1,i,!f)||v&&Yi(t,d,r,n,o,l,s,c,u+1,i,!f),Hi.releasePrimitive(i)}else{const i=Qr(t),a=$r(t,v);kr(i,g,qi),kr(a,g,Wi);const m=d.intersectsBox(qi),y=d.intersectsBox(Wi);if(m&&y)S=Yi(e,i,n,r,o,s,l,u,c+1,d,f)||Yi(e,a,n,r,o,s,l,u,c+1,d,f);else if(m)if(x)S=Yi(e,i,n,r,o,s,l,u,c+1,d,f);else{const t=Hi.getPrimitive();t.copy(qi).applyMatrix4(n);const a=Qr(e),d=$r(e,p);kr(a,h,Vi),kr(d,h,Gi);const m=t.intersectsBox(Vi),g=t.intersectsBox(Gi);S=m&&Yi(i,a,r,n,o,l,s,c,u+1,t,!f)||g&&Yi(i,d,r,n,o,l,s,c,u+1,t,!f),Hi.releasePrimitive(t)}else if(y)if(x)S=Yi(e,a,n,r,o,s,l,u,c+1,d,f);else{const t=Hi.getPrimitive();t.copy(Wi).applyMatrix4(n);const i=Qr(e),d=$r(e,p);kr(i,h,Vi),kr(d,h,Gi);const m=t.intersectsBox(Vi),g=t.intersectsBox(Gi);S=m&&Yi(a,i,r,n,o,l,s,c,u+1,t,!f)||g&&Yi(a,d,r,n,o,l,s,c,u+1,t,!f),Hi.releasePrimitive(t)}}return S}const Ki=new go,Qi=new r.au,$i={strategy:br,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class Ji{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t={cloneBuffers:!0,...t};const n=e.geometry,r=e._roots,o=e._indirectBuffer,i=n.getIndex();let a;return a=t.cloneBuffers?{roots:r.map((e=>e.slice())),index:i.array.slice(),indirectBuffer:o?o.slice():null}:{roots:r,index:i.array,indirectBuffer:o},a}static deserialize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n={setIndex:!0,indirect:!!e.indirectBuffer,...n};const{index:o,roots:i,indirectBuffer:a}=e,s=new Ji(t,{...n,[Cr]:!0});if(s._roots=i,s._indirectBuffer=a||null,n.setIndex){const n=t.getIndex();if(null===n){const n=new r.Y(e.index,1,!1);t.setIndex(n)}else n.array!==o&&(n.array.set(o),n.needsUpdate=!0)}return s}get indirect(){return!!this._indirectBuffer}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if(t=Object.assign({...$i,[Cr]:!1},t),t.useSharedArrayBuffer&&!(typeof SharedArrayBuffer<"u"))throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[Cr]||(lo(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new r.au)));const{_indirectBuffer:n}=this;this.resolveTriangleIndex=t.indirect?e=>n[e]:e=>e}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(this.indirect?gi:Vo)(this,e)}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this._roots[t],r=new Uint32Array(n),o=new Uint16Array(n);!function t(i){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=2*i,l=o[s+15]===Ar;if(l){const t=r[i+6],u=o[s+14];e(a,l,new Float32Array(n,4*i,6),t,u)}else{const o=i+Tr/4,s=r[i+6],u=r[i+7];e(a,l,new Float32Array(n,4*i,6),u)||(t(o,a+1),t(s,a+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ap;const n=this._roots,o=this.geometry,i=[],a=t.isMaterial,s=Array.isArray(t),l=o.groups,u=a?t.side:t,c=this.indirect?yi:Yo;for(let r=0,d=n.length;r<d;r++){const n=s?t[l[r].materialIndex].side:u,o=i.length;if(c(this,r,n,e,i),s){const e=l[r].materialIndex;for(let t=o,n=i.length;t<n;t++)i[t].face.materialIndex=e}}return i}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ap;const n=this._roots,o=this.geometry,i=t.isMaterial,a=Array.isArray(t);let s=null;const l=o.groups,u=i?t.side:t,c=this.indirect?Si:Jo;for(let r=0,d=n.length;r<d;r++){const n=c(this,r,a?t[l[r].materialIndex].side:u,e);null!=n&&(null==s||n.distance<s.distance)&&(s=n,a&&(n.face.materialIndex=l[r].materialIndex))}return s}intersectsGeometry(e,t){let n=!1;const r=this._roots,o=this.indirect?Li:ai;for(let i=0,a=r.length;i<a&&(n=o(this,i,e,t),!n);i++);return n}shapecast(e){const t=bo.getPrimitive(),n=this.indirect?Wo:Ho;let{boundsTraverseOrder:r,intersectsBounds:o,intersectsRange:i,intersectsTriangle:a}=e;if(i&&a){const e=i;i=(r,o,i,s,l)=>!!e(r,o,i,s,l)||n(r,o,this,a,i,s,t)}else i||(i=a?(e,r,o,i)=>n(e,r,this,a,o,i,t):(e,t,n)=>n);let s=!1,l=0;const u=this._roots;for(let c=0,d=u.length;c<d;c++){const e=u[c];if(s=To(this,c,o,i,r,l),s)break;l+=e.byteLength}return bo.releasePrimitive(t),s}bvhcast(e,t,n){let{intersectsRanges:o,intersectsTriangles:i}=n;const a=bo.getPrimitive(),s=this.geometry.index,l=this.geometry.attributes.position,u=this.indirect?e=>{const t=this.resolveTriangleIndex(e);Fo(a,3*t,s,l)}:e=>{Fo(a,3*e,s,l)},c=bo.getPrimitive(),d=e.geometry.index,f=e.geometry.attributes.position,h=e.indirect?t=>{const n=e.resolveTriangleIndex(t);Fo(c,3*n,d,f)}:e=>{Fo(c,3*e,d,f)};if(i){const e=(e,n,r,o,s,l,d,f)=>{for(let p=r,m=r+o;p<m;p++){h(p),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,r=e+n;t<r;t++)if(u(t),a.needsUpdate=!0,i(a,c,t,p,s,l,d,f))return!0}return!1};if(o){const t=o;o=function(n,r,o,i,a,s,l,u){return!!t(n,r,o,i,a,s,l,u)||e(n,r,o,i,a,s,l,u)}}else o=e}return function(e,t,n,o){if(Xi)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Xi=!0;const i=e._roots,a=t._roots;let s,l=0,u=0;const c=(new r.l).copy(n).invert();for(let r=0,d=i.length;r<d;r++){Ui.setBuffer(i[r]),u=0;const e=Hi.getPrimitive();kr(0,Ui.float32Array,e),e.applyMatrix4(c);for(let t=0,i=a.length;t<i&&(Fi.setBuffer(a[r]),s=Yi(0,0,n,c,o,l,u,0,0,e),Fi.clearBuffer(),u+=a[t].length,!s);t++);if(Hi.releasePrimitive(e),Ui.clearBuffer(),l+=i[r].length,s)break}return Xi=!1,s}(this,e,t,o)}intersectsBox(e,t){return Ki.set(e.min,e.max,t),Ki.needsUpdate=!0,this.shapecast({intersectsBounds:e=>Ki.intersectsBox(e),intersectsTriangle:e=>Ki.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;return(this.indirect?Di:mi)(this,e,t,n,r,o,i)}closestPointToPoint(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const i=r*r,a=o*o;let s=1/0,l=null;if(e.shapecast({boundsTraverseOrder:e=>(Po.copy(t).clamp(e.min,e.max),Po.distanceToSquared(t)),intersectsBounds:(e,t,n)=>n<s&&n<a,intersectsTriangle:(e,n)=>{e.closestPointToPoint(t,Po);const r=t.distanceToSquared(Po);return r<s&&(Co.copy(Po),s=r,l=n),r<i}}),s===1/0)return null;const u=Math.sqrt(s);return n.point?n.point.copy(Co):n.point=Co.clone(),n.distance=u,n.faceIndex=l,n}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{kr(0,new Float32Array(t),Qi),e.union(Qi)})),e}}function Zi(e,t,n){return null===e||(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(n.ray.origin),e.object=t,e.distance<n.near||e.distance>n.far)?null:e}const ea=new r.q,ta=new r.l,na=r.a8.prototype.raycast;function ra(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;ta.copy(this.matrixWorld).invert(),ea.copy(e.ray).applyMatrix4(ta);const n=this.geometry.boundsTree;if(!0===e.firstHitOnly){const r=Zi(n.raycastFirst(ea,this.material),this,e);r&&t.push(r)}else{const r=n.raycast(ea,this.material);for(let n=0,o=r.length;n<o;n++){const o=Zi(r[n],this,e);o&&t.push(o)}}}else na.call(this,e,t)}function oa(e){return this.boundsTree=new Ji(this,e),this.boundsTree}function ia(){this.boundsTree=null}const aa=e=>e.isMesh,sa=o.forwardRef(((e,t)=>{let{enabled:n=!0,firstHitOnly:i=!1,children:a,strategy:s=wr,verbose:l=!1,setBoundingBox:u=!0,maxDepth:c=40,maxLeafTris:d=10,indirect:f=!1,...h}=e;const p=o.useRef(null),m=ue((e=>e.raycaster));return o.useImperativeHandle(t,(()=>p.current),[]),o.useEffect((()=>{if(n){const e={strategy:s,verbose:l,setBoundingBox:u,maxDepth:c,maxLeafTris:d,indirect:f},t=p.current;return m.firstHitOnly=i,t.traverse((t=>{aa(t)&&!t.geometry.boundsTree&&t.raycast===r.a8.prototype.raycast&&(t.raycast=ra,t.geometry.computeBoundsTree=oa,t.geometry.disposeBoundsTree=ia,t.geometry.computeBoundsTree(e))})),()=>{delete m.firstHitOnly,t.traverse((e=>{aa(e)&&e.geometry.boundsTree&&(e.geometry.disposeBoundsTree(),e.raycast=r.a8.prototype.raycast)}))}}}),[]),o.createElement("group",(0,r._)({ref:p},h),a)})),la=o.forwardRef((function(e,t){let{children:n,disable:i,disableX:a,disableY:s,disableZ:l,left:u,right:c,top:d,bottom:f,front:h,back:p,onCentered:m,precise:g=!0,cacheKey:v=0,...y}=e;const b=o.useRef(null),x=o.useRef(null),w=o.useRef(null);return o.useLayoutEffect((()=>{x.current.matrixWorld.identity();const e=(new r.au).setFromObject(w.current,g),t=new r.b,n=new r.av,o=e.max.x-e.min.x,v=e.max.y-e.min.y,y=e.max.z-e.min.z;e.getCenter(t),e.getBoundingSphere(n);const S=d?v/2:f?-v/2:0,_=u?-o/2:c?o/2:0,E=h?y/2:p?-y/2:0;x.current.position.set(i||a?0:-t.x+_,i||s?0:-t.y+S,i||l?0:-t.z+E),typeof m<"u"&&m({parent:b.current.parent,container:b.current,width:o,height:v,depth:y,boundingBox:e,boundingSphere:n,center:t,verticalAlignment:S,horizontalAlignment:_,depthAlignment:E})}),[v,m,d,u,h,i,a,s,l,g,c,f,p]),o.useImperativeHandle(t,(()=>b.current),[]),o.createElement("group",(0,r._)({ref:b},y),o.createElement("group",{ref:x},o.createElement("group",{ref:w},n)))}));function ua(){const{controllers:e}=gt(),t=(0,o.useRef)(),n=(0,o.useRef)();return ce((()=>{if(e&&e[0]&&e[1]){if(e[0].controller){const n=e[0].hand.joints["index-finger-tip"].position;t.current.position.copy(n)}if(e[1].controller){const t=e[1].hand.joints["index-finger-tip"].position;n.current.position.copy(t)}}})),r.aJ.jsxs(r.aJ.Fragment,{children:[r.aJ.jsxs("mesh",{name:"leftTipBbox",ref:n,children:[r.aJ.jsx("boxGeometry",{args:[.02,.02,.02]}),r.aJ.jsx("meshStandardMaterial",{color:"blue",transparent:!0,opacity:0})]}),r.aJ.jsxs("mesh",{name:"rightTipBbox",ref:t,children:[r.aJ.jsx("boxGeometry",{args:[.02,.02,.02]}),r.aJ.jsx("meshStandardMaterial",{color:"orange",transparent:!0,opacity:0})]})]})}function ca(e){const{currentLine:t,scale:n}=e,i=(0,o.useRef)();return r.aJ.jsxs("group",{children:[r.aJ.jsx(la,{bottom:!0,right:!0,position:[t.midPoint.x,t.midPoint.y,t.midPoint.z],rotation:[0,0,0],children:r.aJ.jsx(vr,{color:"gray",scale:.05,ref:i,children:`${(t.startPoint.distanceTo(t.endPoint)*n).toFixed(2)} \xb5m`})}),r.aJ.jsx(gr,{points:[t.startPoint,t.endPoint],color:"white",lineWidth:2,dashed:!1,segments:!0})]})}function da(e){const{segmentationGroup:t,segmentationSettings:n,segmentationSceneScale:i,renderingSettings:a,materialRef:s,highlightEntity:l,setObsHighlight:u}=e,c=(0,o.useRef)(),d=(0,o.useRef)(),f=(0,o.useRef)(),{isPresenting:h}=gt();(0,o.useEffect)((()=>{h&&c?.current?null!==s&&(s.current.material.uniforms.u_physical_Pixel.value=.2):h||null!==s&&(s.current.material.uniforms.u_physical_Pixel.value=2.5)}),[h]);const{scene:p}=ue(),{controllers:m}=gt(),[g,v]=(0,o.useState)(!1),[y,b]=(0,o.useState)(!1),[x,w]=(0,o.useState)(!1),[S,_]=(0,o.useState)({startPoint:new r.b,midPoint:new r.b,endPoint:new r.b,setStartPoint:!1,setEndPoint:!1}),[E,T]=(0,o.useState)([]),[A,P]=(0,o.useState)(0);return ce((()=>{if(h){const e=p.getObjectByName("rightTipBbox"),t=p.getObjectByName("leftTipBbox"),n=(new r.au).setFromObject(t),o=(new r.au).setFromObject(e);let i=!1;if(P(A-1),n.intersectsBox(o)&&n.max.x!==-o.min.x&&(v(!0),w(!0),_({startPoint:new r.b,midPoint:new r.b,endPoint:new r.b,setStartPoint:!1,setEndPoint:!1})),g){let e=m[1].hand.joints["index-finger-tip"].position.clone(),t=m[0].hand.joints["index-finger-tip"].position.clone();e=e.applyMatrix4(f.current.matrixWorld.clone().invert()),t=t.applyMatrix4(f.current.matrixWorld.clone().invert());let n=e.clone(),o=t.clone();S.setStartPoint&&(n=S.startPoint),S.setEndPoint&&(o=S.endPoint),_({startPoint:n,midPoint:(new r.b).addVectors(n,o).multiplyScalar(.5),endPoint:o,setStartPoint:S.setStartPoint,setEndPoint:S.setEndPoint}),!0===m[0].hand.inputState.pinching&&_({startPoint:S.startPoint,midPoint:S.midPoint,endPoint:S.endPoint,setStartPoint:S.setStartPoint,setEndPoint:!0}),!0===m[1].hand.inputState.pinching&&_({startPoint:S.startPoint,midPoint:S.midPoint,endPoint:S.endPoint,setStartPoint:!0,setEndPoint:S.setEndPoint}),S.setStartPoint&&S.setEndPoint&&(E.push(S),T(E),w(!1),v(!1),P(8))}else A<=0&&c?.current&&h&&(c.current.children[0].children.forEach(((e,t)=>{const a=c.current.children[0].children[t],s=(new r.au).setFromObject(a),l=n.intersectsBox(s),d=o.intersectsBox(s);(l||d)&&(i=!0,u(a.name),b(!0),void 0!==m[1]&&l&&!0===m[1].hand.inputState.pinching&&(P(10),i=!1,m[1].hand.inputState.pinching=!1),void 0!==m[0]&&d&&!0===m[0].hand.inputState.pinching&&(P(10),i=!1,m[0].hand.inputState.pinching=!1))})),!i&&y&&(u(null),b(!1)))}}),[g,y,S,E,x,A,h]),r.aJ.jsx("group",{children:gt().isPresenting?r.aJ.jsxs(st,{children:[r.aJ.jsxs("group",{ref:f,children:[t?.visible?r.aJ.jsxs("group",{children:[r.aJ.jsx("hemisphereLight",{skyColor:8421504,groundColor:6316128}),r.aJ.jsx("directionalLight",{color:16777215,position:[0,-800,0]}),r.aJ.jsx("primitive",{ref:c,object:t,position:[-.18,1.13,-1],scale:[.002*i[0],.002*i[1],.002*i[2]]})]}):null,a.uniforms&&a.shader?r.aJ.jsx("group",{children:r.aJ.jsxs("mesh",{name:"cube",position:[-.18,1.13,-1],rotation:[0,0,0],scale:[.002*a.meshScale[0],.002*a.meshScale[1],.002*a.meshScale[2]],ref:s,children:[r.aJ.jsx("boxGeometry",{args:a.geometrySize}),r.aJ.jsx("shaderMaterial",{customProgramCacheKey:()=>"1",side:r.ap,uniforms:a.uniforms,needsUpdate:!0,transparent:!0,vertexShader:a.shader.vertexShader,fragmentShader:a.shader.fragmentShader})]})}):null]}),r.aJ.jsx("group",{name:"currentLine",ref:d,children:x?r.aJ.jsx(ca,{currentLine:S,scale:200}):null}),r.aJ.jsx("group",{name:"lines",children:E.map((e=>r.aJ.jsx(ca,{currentLine:e,scale:200})))})]}):r.aJ.jsxs("group",{children:[r.aJ.jsxs("group",{children:[t?.visible?r.aJ.jsxs("group",{children:[r.aJ.jsx("hemisphereLight",{skyColor:8421504,groundColor:6316128}),r.aJ.jsx("directionalLight",{color:16777215,position:[0,-800,0]}),r.aJ.jsx("directionalLight",{color:16777215,position:[0,800,0]}),r.aJ.jsx(sa,{firstHitOnly:!0,children:r.aJ.jsx("primitive",{ref:c,object:t,position:[0,0,0],onClick:e=>{"finalPass"===e.object.parent.userData.name&&l(e.object.name,e.object.userData.layerScope,e.object.userData.channelScope)},onPointerOver:e=>{u(e.object.name)},onPointerOut:e=>u(null)})})]}):null,a.uniforms&&a.shader?r.aJ.jsx("group",{children:r.aJ.jsxs("mesh",{scale:a.meshScale,ref:s,children:[r.aJ.jsx("boxGeometry",{args:a.geometrySize}),r.aJ.jsx("shaderMaterial",{customProgramCacheKey:()=>"1",side:r.ap,uniforms:a.uniforms,needsUpdate:!0,transparent:!0,vertexShader:a.shader.vertexShader,fragmentShader:a.shader.fragmentShader})]})}):null]}),r.aJ.jsx("group",{name:"lines",children:E.map((e=>r.aJ.jsx(ca,{currentLine:e,scale:1})))})]})})}function fa(){const{controllers:e}=gt();return ce((()=>{e?.[0]&&e?.[1]&&(e[0]?.hand?.children?.[25]?.children?.[0]?.children?.[0]&&(e[0].hand.children[25].children[0].children[0].material.transparent=!0,e[0].hand.children[25].children[0].children[0].material.opacity=.5),e[1]?.hand?.children?.[25]?.children?.[0]?.children?.[0]&&(e[1].hand.children[25].children[0].children[0].material.transparent=!0,e[1].hand.children[25].children[0].children[0].material.opacity=.5))})),null}class ha{constructor(e,t,n,o,i){if(this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new r.aK,this.matrix.identity(),this.sliceList=[],this.lowerThresholdValue=-1/0,this.upperThresholdValue=1/0,arguments.length>0){switch(this.xLength=Number(e)||1,this.yLength=Number(t)||1,this.zLength=Number(n)||1,o){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":default:this.data=new Uint8Array(i);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(i);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(i);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(i);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(i);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(i);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw new Error("uint64_t type is not supported in JavaScript");case"Float32":case"float32":case"float":this.data=new Float32Array(i);break;case"Float64":case"float64":case"double":this.data=new Float64Array(i)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw new Error("lengths are not matching arrayBuffer size")}}get lowerThreshold(){return this.lowerThresholdValue}set lowerThreshold(e){this.lowerThresholdValue=e,this.sliceList.forEach((e=>{e.geometryNeedsUpdate=!0}))}get upperThreshold(){return this.upperThresholdValue}set upperThreshold(e){this.upperThresholdValue=e,this.sliceList.forEach((e=>{e.geometryNeedsUpdate=!0}))}getData(e,t,n){return this.data[n*this.xLength*this.yLength+t*this.xLength+e]}access(e,t,n){return n*this.xLength*this.yLength+t*this.xLength+e}reverseAccess(e){const t=Math.floor(e/(this.yLength*this.xLength)),n=Math.floor((e-t*this.yLength*this.xLength)/this.xLength);return[e-t*this.yLength*this.xLength-n*this.xLength,n,t]}map(e,t){const{length:n}=this.data,r=t||this;for(let o=0;o<n;o++)this.data[o]=e.call(r,this.data[o],o,this.data);return this}extractPerpendicularPlane(e,t){const n=(new r.l).identity(),o=this;let i,a,s,l;const u=new r.b,c=new r.b,d=new r.b,f=new r.b(this.xLength,this.yLength,this.zLength);switch(e){case"x":u.set(1,0,0),c.set(0,0,-1),d.set(0,-1,0),i=this.spacing[2],a=this.spacing[1],l=new r.b(t,0,0),n.multiply((new r.l).makeRotationY(Math.PI/2)),s=(o.RASDimensions[0]-1)/2,n.setPosition(new r.b(t-s,0,0));break;case"y":u.set(0,1,0),c.set(1,0,0),d.set(0,0,1),i=this.spacing[0],a=this.spacing[2],l=new r.b(0,t,0),n.multiply((new r.l).makeRotationX(-Math.PI/2)),s=(o.RASDimensions[1]-1)/2,n.setPosition(new r.b(0,t-s,0));break;default:u.set(0,0,1),c.set(1,0,0),d.set(0,-1,0),i=this.spacing[0],a=this.spacing[1],l=new r.b(0,0,t),s=(o.RASDimensions[2]-1)/2,n.setPosition(new r.b(0,0,t-s))}c.applyMatrix4(o.inverseMatrix).normalize(),c.argVar="i",d.applyMatrix4(o.inverseMatrix).normalize(),d.argVar="j",u.applyMatrix4(o.inverseMatrix).normalize();const h=Math.floor(Math.abs(c.dot(f))),p=Math.floor(Math.abs(d.dot(f))),m=Math.abs(h*i),g=Math.abs(p*a);l=Math.abs(Math.round(l.applyMatrix4(o.inverseMatrix).dot(u)));const v=[new r.b(1,0,0),new r.b(0,1,0),new r.b(0,0,1)],y=[c,d,u].find((e=>Math.abs(e.dot(v[0]))>.9)),b=[c,d,u].find((e=>Math.abs(e.dot(v[1]))>.9)),x=[c,d,u].find((e=>Math.abs(e.dot(v[2]))>.9));return{iLength:h,jLength:p,sliceAccess:function(e,t){const n=y===u?l:"i"===y.arglet?e:t,r=b===u?l:"i"===b.arglet?e:t,i=x===u?l:"i"===x.arglet?e:t,a=y.dot(v[0])>0?n:o.xLength-1-n,s=b.dot(v[1])>0?r:o.yLength-1-r,c=x.dot(v[2])>0?i:o.zLength-1-i;return o.access(a,s,c)},matrix:n,planeWidth:m,planeHeight:g}}computeMinMax(){let e=1/0,t=-1/0;const n=this.data.length;let r=0;for(r=0;r<n;r++)if(!Number.isNaN(this.data[r])){const n=this.data[r];e=Math.min(e,n),t=Math.max(t,n)}return this.min=e,this.max=t,[e,t]}}const pa={uniforms:{u_size:{value:new r.b(1,1,1)},u_renderstyle:{value:0},u_renderthreshold:{value:.5},u_opacity:{value:.5},u_clim:{value:new r.V(.2,.8)},u_clim2:{value:new r.V(.2,.8)},u_clim3:{value:new r.V(.2,.8)},u_clim4:{value:new r.V(.2,.8)},u_clim5:{value:new r.V(.2,.8)},u_clim6:{value:new r.V(.2,.8)},u_xClip:{value:new r.V(-1,1e6)},u_yClip:{value:new r.V(-1,1e6)},u_zClip:{value:new r.V(-1,1e6)},u_data:{value:null},u_stop_geom:{value:null},u_geo_color:{value:null},u_window_size:{value:new r.V(1,1)},u_vol_scale:{value:new r.V(1,1,1)},u_physical_Pixel:{value:.5},volumeTex:{value:null},volumeTex2:{value:null},volumeTex3:{value:null},volumeTex4:{value:null},volumeTex5:{value:null},volumeTex6:{value:null},u_color:{value:new r.b(0,0,0)},u_color2:{value:new r.b(0,0,0)},u_color3:{value:new r.b(0,0,0)},u_color4:{value:new r.b(0,0,0)},u_color5:{value:new r.b(0,0,0)},u_color6:{value:new r.b(0,0,0)},u_cmdata:{value:null},near:{value:.1},far:{value:1e4},alphaScale:{value:0},dtScale:{value:1},volumeCount:{value:0},finalGamma:{value:0},boxSize:{value:new r.b(1,1,1)}},vertexShader:["out vec3 rayDirUnnorm;","out vec3 cameraCorrected;","uniform vec3 u_vol_scale;","uniform vec3 u_size;","varying vec3 worldSpaceCoords;","varying vec2 vUv;","varying vec4 glPosition;","uniform highp vec3 boxSize;","void main()","{","   worldSpaceCoords = position / boxSize + vec3(0.5, 0.5, 0.5); //move it from [-0.5;0.5] to [0,1]","   cameraCorrected = (inverse(modelMatrix) * vec4(cameraPosition, 1.)).xyz;","   rayDirUnnorm = position - cameraCorrected;","   gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","   glPosition = gl_Position;","   vUv = uv;","}"].join("\n"),fragmentShader:["#include <packing>","precision highp float;"," precision mediump sampler3D;","in vec3 rayDirUnnorm;","in vec3 cameraCorrected;","uniform sampler3D volumeTex;","uniform sampler3D volumeTex2;","uniform sampler3D volumeTex3;","uniform sampler3D volumeTex4;","uniform sampler3D volumeTex5;","uniform sampler3D volumeTex6;","uniform vec2 u_clim;","uniform vec2 u_clim2;","uniform vec2 u_clim3;","uniform vec2 u_clim4;","uniform vec2 u_clim5;","uniform vec2 u_clim6;","uniform vec2 u_window_size;","uniform vec2 u_xClip;","uniform vec2 u_yClip;","uniform vec2 u_zClip;","uniform sampler2D u_cmdata;","uniform sampler2D u_stop_geom;","uniform sampler2D u_geo_color;","uniform vec3 u_color;","uniform vec3 u_color2;","uniform vec3 u_color3;","uniform vec3 u_color4;","uniform vec3 u_color5;","uniform vec3 u_color6;","uniform float alphaScale;","uniform float dtScale;","uniform float finalGamma;","uniform float volumeCount;","uniform highp vec3 boxSize;","uniform vec3 u_size;","uniform int u_renderstyle;","uniform float u_opacity;","uniform vec3 u_vol_scale;","uniform float near;","uniform float u_physical_Pixel;","varying vec2 vUv;","varying vec4 glPosition;","uniform float far;","varying vec3 worldSpaceCoords;","float linearize_z(float z) {","        return near * far / (far + z * (near - far));","}","vec2 intersect_hit(vec3 orig, vec3 dir) {","  vec3 boxMin = vec3(-0.5) * boxSize;","  vec3 boxMax = vec3( 0.5) * boxSize;","  if(u_xClip.x > -1.0){   boxMin.x = u_xClip.x-(boxSize.x/2.0);","   if(u_xClip.y < boxSize.x)","       boxMax.x = u_xClip.y-(boxSize.x/2.0);","  }","  if(u_yClip.x > -1.0){   boxMin.y = u_yClip.x-(boxSize.y/2.0);","   if(u_yClip.y < boxSize.y)","      boxMax.y = u_yClip.y-(boxSize.y/2.0);","  }","  if(u_zClip.x > -1.0){   boxMin.z = u_zClip.x-(boxSize.z/2.0);","   if(u_zClip.y < boxSize.z)       boxMax.z = u_zClip.y-(boxSize.z/2.0);","  }","  vec3 invDir = 1.0 / dir;","  vec3 tmin0 = (boxMin - orig) * invDir;","  vec3 tmax0 = (boxMax - orig) * invDir;","  vec3 tmin = min(tmin0, tmax0);","  vec3 tmax = max(tmin0, tmax0);","  float t0 = max(tmin.x, max(tmin.y, tmin.z));","  float t1 = min(tmax.x, min(tmax.y, tmax.z));","  return vec2(t0, t1);","}","   // Pseudo-random number gen from","   // http://www.reedbeta.com/blog/quick-and-easy-gpu-random-numbers-in-d3d11/","   // with some tweaks for the range of values","       float wang_hash(int seed) {","     seed = (seed ^ 61) ^ (seed >> 16);","     seed *= 9;","     seed = seed ^ (seed >> 4);","     seed *= 0x27d4eb2d;","     seed = seed ^ (seed >> 15);","     return float(seed % 2147483647) / float(2147483647);","     }","float linear_to_srgb(float x) {","   if (x <= 0.0031308f) {","     return 12.92f * x;","   }","   return 1.055f * pow(x, 1.f / 2.4f) - 0.055f;","}","void main(void) {","  //STEP 1: Normalize the view Ray","  vec3 rayDir = normalize(rayDirUnnorm);","  //STEP 2: Intersect the ray with the volume bounds to find the interval along the ray overlapped by the volume","  vec2 t_hit = intersect_hit(cameraCorrected, rayDir);","  if (t_hit.x >= t_hit.y) {","    discard;","  }","  //No sample behind the eye","  t_hit.x = max(t_hit.x, 0.0);","  //STEP 3: Compute the step size to march through the volume grid","  ivec3 volumeTexSize = textureSize(volumeTex, 0);","  vec3 dt_vec = 1.0 / (vec3(volumeTexSize) * abs(rayDir));","  float dt = min(dt_vec.x, min(dt_vec.y, dt_vec.z));","  dt = max(1.0, dt);","  // Ray starting point, in the real space where the box may not be a cube.","  // Prevents a lost WebGL context."," float offset = wang_hash(int(gl_FragCoord.x + 640.0 * gl_FragCoord.y));"," vec3 p = cameraCorrected + (t_hit.x + offset + dt) * rayDir;","  // Most browsers do not need this initialization, but add it to be safe.","  gl_FragColor = vec4(0.0);","  p = p / boxSize + vec3(0.5);","  vec3 step = (rayDir * dt) / boxSize;","  // ","  // Initialization of some variables.","  float max_val = 0.0;","  float max_val2 = 0.0;","  float max_val3 = 0.0;","  float max_val4 = 0.0;","  float max_val5 = 0.0;","  float max_val6 = 0.0;","  vec3 rgbCombo = vec3(0.0);","  float total = 0.0;","  int max_i = 30000;","  int i = 0;","  float x = gl_FragCoord.x/u_window_size.x;","  float y = gl_FragCoord.y/u_window_size.y;","  vec3 meshPos = texture2D(u_stop_geom, vec2(x,y)).xyz;","  float dist = 1000.0;","  for (float t = t_hit.x; t < t_hit.y; t += dt) {","       if(meshPos != vec3(0.0))           dist = distance(p,meshPos);","      float val = texture(volumeTex, p.xyz).r;","      val = max(0.0, (val - u_clim[0]) / (u_clim[1] - u_clim[0]));","      rgbCombo += max(0.0, min(1.0, val)) * u_color;","      total += val;","      if(volumeCount > 1.0){           float val2 = texture(volumeTex2, p.xyz).r;","           val2 = max(0.0,(val2 - u_clim2[0]) / (u_clim2[1] - u_clim2[0]));","           rgbCombo += max(0.0, min(1.0, val2)) * u_color2;","           total += val2;","       }","       if(volumeCount > 2.0){           float val3 = texture(volumeTex3, p.xyz).r;","           val3 = max(0.0,(val3 - u_clim3[0]) / (u_clim3[1] - u_clim3[0]));","           rgbCombo += max(0.0, min(1.0, val3)) * u_color3;","           total += val3;","       }","       if(volumeCount > 3.0){           float val4 = texture(volumeTex4, p.xyz).r;","           val4 = max(0.0,(val4 - u_clim4[0]) / (u_clim4[1] - u_clim4[0]));","           rgbCombo += max(0.0, min(1.0, val4)) * u_color4;","           total += val4;","       }","       if(volumeCount > 4.0){           float val5 = texture(volumeTex5, p.xyz).r;","           val5 = max(0.0,(val5 - u_clim5[0]) / (u_clim5[1] - u_clim5[0]));","           rgbCombo += max(0.0, min(1.0, val5)) * u_color5;","           total += val5;","        }","        if(volumeCount > 5.0){           float val6 = texture(volumeTex6, p.xyz).r;","           val6 = max(0.0,(val6 - u_clim6[0]) / (u_clim6[1] - u_clim6[0]));","           rgbCombo += max(0.0, min(1.0, val6)) * u_color6;","           total += val6;","       }","       if(total > 0.0 && dist < 0.1){","           break;","       }else if(dist < 0.1){           gl_FragColor = vec4(0.0,0.0,0.0,0.0);","           break;","       }","       if(u_renderstyle == 0 && (max_val > u_clim[1] && max_val2 >= u_clim2[1] && max_val3 >= u_clim3[1] && max_val4 >= u_clim4[1] && max_val5 >= u_clim5[1] &&  max_val6 >= u_clim6[1])) break;","       if(u_renderstyle == 2){           total = min(total, 1.0);","           vec4 val_color = vec4(rgbCombo, total);","           val_color.a = 1.0 - pow(1.0 - val_color.a, 1.0);","           gl_FragColor.rgb += (1.0 - gl_FragColor.a) * val_color.a * val_color.rgb;","           gl_FragColor.a += (1.0 - gl_FragColor.a) * val_color.a * dtScale;","           if (gl_FragColor.a >= 0.95) {","               break;","           }","       }","       p += step;","  }","   gl_FragDepth = distance(worldSpaceCoords,p)*u_physical_Pixel;","   if(u_renderstyle == 0 && (max_val <  u_clim[0] && max_val2 < u_clim2[0] && max_val3 < u_clim3[0] &&   max_val4 <  u_clim4[0] && max_val5 <  u_clim5[0] && max_val6 <  u_clim6[0])){","        gl_FragColor = vec4(0,0,0,0);","   }else if(u_renderstyle == 0){","       max_val = (max_val - u_clim[0]) / (u_clim[1] - u_clim[0]);","       max_val2 = (max_val2 - u_clim2[0]) / (u_clim2[1] - u_clim2[0]);","       max_val3 = (max_val3 - u_clim3[0]) / (u_clim3[1] - u_clim3[0]);","       max_val4 = (max_val4 - u_clim4[0]) / (u_clim4[1] - u_clim4[0]);","       max_val5 = (max_val5 - u_clim5[0]) / (u_clim5[1] - u_clim5[0]);","       max_val6 = (max_val6 - u_clim6[0]) / (u_clim6[1] - u_clim6[0]);","       vec3 color = u_color * max_val;","       if(volumeCount > 1.0) color = color +  u_color2 * max_val2;","       if(volumeCount > 3.0) color = color +  u_color4 * max_val4;","       if(volumeCount > 2.0) color = color +  u_color3 * max_val3;","       if(volumeCount > 4.0) color = color +  u_color5 * max_val5;","       if(volumeCount > 5.0) color = color +  u_color6 * max_val6;","       vec3 colorCorrected = vec3(min(color[0], 1.0), min(color[1],1.0), min(color[2],1.0));","        gl_FragColor = vec4(color,1.0);","    }","    gl_FragColor.r = linear_to_srgb(gl_FragColor.r);","    gl_FragColor.g = linear_to_srgb(gl_FragColor.g);","    gl_FragColor.b = linear_to_srgb(gl_FragColor.b);","}"].join("\n")},ma={maximumIntensityProjection:0,minimumIntensityProjection:1,additive:2};function ga(e,t,n,o,i){const{images:a={},imageLayerScopes:s,imageLayerCoordination:l,imageChannelScopesByLayer:u,imageChannelCoordination:c}=e,d=s[0],f=u[d],h=l[0][d],p=c[0][d],{channelsVisible:m,allChannels:g,channelTargetC:v,resolution:y,data:b,colors:x,contrastLimits:w,is3dMode:S,renderingMode:_,layerTransparency:E,xSlice:T,ySlice:A,zSlice:P}=function(e,t,n,o,i,a){const{spatialRenderingMode:s}=a,l=i?.image?.instance?.getData();if(!l)return{channelsVisible:null,resolution:null,data:null,colors:null,contrastLimits:null,allChannels:null,channelTargetC:null};const u=i.image.instance,c="3D"===s,d="RGB"===t[r.aL.PHOTOMETRIC_INTERPRETATION],f=t[r.aL.VOLUMETRIC_RENDERING_ALGORITHM],h=ma[f],p=t[r.aL.SPATIAL_LAYER_VISIBLE],m=t[r.aL.SPATIAL_LAYER_OPACITY];u.isInterleaved();const g=d?[[255,0,0],[0,255,0],[0,0,255]]:n.map((e=>o[e][r.aL.SPATIAL_CHANNEL_COLOR])),v=d?[[0,255],[0,255],[0,255]]:n.map((e=>o[e][r.aL.SPATIAL_CHANNEL_WINDOW]||[0,255])),y=d?[p&&!0,p&&!0,p&&!0]:n.map((e=>p&&o[e][r.aL.SPATIAL_CHANNEL_VISIBLE])),b=d?[p&&!0,p&&!0,p&&!0]:n.map((e=>p&&o[e][r.aL.SPATIAL_TARGET_C])),x=u.getAutoTargetResolution(),w=t[r.aL.SPATIAL_TARGET_RESOLUTION],S=null===w||Number.isNaN(w)?x:w,_=i.image.loaders[0].channels;let E=t[r.aL.SPATIAL_SLICE_X],T=t[r.aL.SPATIAL_SLICE_Y],A=t[r.aL.SPATIAL_SLICE_Z];return E=null!==E?E:new r.V(-1,1e5),T=null!==T?T:new r.V(-1,1e5),A=null!==A?A:new r.V(-1,1e5),{channelsVisible:y,allChannels:_,channelTargetC:b,resolution:S,data:l,colors:g,contrastLimits:v,is3dMode:c,renderingMode:h,layerTransparency:m,xSlice:E,ySlice:T,zSlice:A}}(0,h,f,p,a[d],e);return null!==v&&(0===t.channelTargetC.length||t.channelTargetC.toString()===v.toString()&&t.resolution.toString()===y.toString()?(t.channelsVisible.toString()!==m.toString()||t.colors.toString()!==x.toString()||t.is3dMode!==S||t.contrastLimits.toString()!==w.toString()||t.renderingMode.toString()!==_.toString()||t.layerTransparency.toString()!==E.toString()||t.xSlice.toString()!==T.toString()||t.ySlice.toString()!==A.toString()||t.zSlice.toString()!==P.toString())&&(n({channelsVisible:m,allChannels:g,channelTargetC:v,resolution:y,data:b,colors:x,contrastLimits:w,is3dMode:S,renderingMode:_,layerTransparency:E,xSlice:T,ySlice:A,zSlice:P}),i(!1)):o||i(!0)),{images:a,layerScope:d,imageLayerScopes:s,imageLayerCoordination:l,imageChannelScopesByLayer:u,imageChannelCoordination:c,channelsVisible:m,allChannels:g,channelTargetC:v,resolution:y,data:b,colors:x,contrastLimits:w,is3dMode:S,renderingMode:_,layerTransparency:E,xSlice:T,ySlice:A,zSlice:P}}function va(e,t){const[n,r]=t;return(e-n)/Math.sqrt(r**2-n**2)}function ya(e,t,n,o,i,a,s,l,u,c,d,f,h,p){const m=[],g=[],v=[];let y=null;if(t.forEach(((t,r)=>{n[r]&&(y=e.get(t),m.push(i.get(t)),g.push([o[r][0]/255,o[r][1]/255,o[r][2]/255]),0===a[r][0]&&255===a[r][1]?v.push([va(s.get(t)[0],s.get(t)),va(s.get(t)[1],s.get(t))]):v.push([va(a[r][0],s.get(t)),va(a[r][1],s.get(t))]))})),null===y)return null;const b=pa,x=r.aC.clone(b.uniforms);return function(e,t,n,r,o,i,a,s,l,u,c,d,f){e.boxSize.value.set(n.xLength,n.yLength,n.zLength),e.volumeTex.value=t.length>0?t[0]:null,e.volumeTex2.value=t.length>1?t[1]:null,e.volumeTex3.value=t.length>2?t[2]:null,e.volumeTex4.value=t.length>3?t[3]:null,e.volumeTex5.value=t.length>4?t[4]:null,e.volumeTex6.value=t.length>5?t[5]:null,e.near.value=.1,e.far.value=3e3,e.alphaScale.value=1,e.dtScale.value=s,e.finalGamma.value=4.5,e.volumeCount.value=t.length,e.u_size.value.set(n.xLength,n.yLength,n.zLength),e.u_stop_geom.value=null,e.u_window_size.value.set(0,0),e.u_vol_scale.value.set(1/n.xLength,1/n.yLength,1/n.zLength*2),e.u_renderstyle.value=o,e.u_clim.value.set(i.length>0?i[0][0]:null,i.length>0?i[0][1]:null),e.u_clim2.value.set(i.length>1?i[1][0]:null,i.length>1?i[1][1]:null),e.u_clim3.value.set(i.length>2?i[2][0]:null,i.length>2?i[2][1]:null),e.u_clim4.value.set(i.length>3?i[3][0]:null,i.length>3?i[3][1]:null),e.u_clim5.value.set(i.length>4?i[4][0]:null,i.length>4?i[4][1]:null),e.u_clim6.value.set(i.length>5?i[5][0]:null,i.length>5?i[5][1]:null),e.u_xClip.value.set(l[0]*(1/d[0])/f[0]*n.xLength,l[1]*(1/d[0])/f[0]*n.xLength),e.u_yClip.value.set(u[0]*(1/d[1])/f[1]*n.yLength,u[1]*(1/d[1])/f[1]*n.yLength),e.u_zClip.value.set(c[0]*(1/d[2])/f[2]*n.zLength,c[1]*(1/d[1])/f[2]*n.zLength),e.u_color.value.set(a.length>0?a[0][0]:null,a.length>0?a[0][1]:null,a.length>0?a[0][2]:null),e.u_color2.value.set(a.length>1?a[1][0]:null,a.length>1?a[1][1]:null,a.length>1?a[1][2]:null),e.u_color3.value.set(a.length>2?a[2][0]:null,a.length>2?a[2][1]:null,a.length>2?a[2][2]:null),e.u_color4.value.set(a.length>3?a[3][0]:null,a.length>3?a[3][1]:null,a.length>3?a[3][2]:null),e.u_color5.value.set(a.length>4?a[4][0]:null,a.length>4?a[4][1]:null,a.length>4?a[4][2]:null),e.u_color6.value.set(a.length>5?a[5][0]:null,a.length>5?a[5][1]:null,a.length>5?a[5][2]:null)}(x,m,y,0,u,v,g,c,d,f,h,[l[0].size,l[1].size,l[2]?l[2].size:1],p),[x,b,[1,l[1].size/l[0].size,l[2]?l[2].size/l[0].size:1],[y.xLength,y.yLength,y.zLength],[1,y.yLength/y.xLength,y.zLength/y.xLength]]}const ba={Uint8:Uint8Array,Uint16:Uint16Array,Uint32:Uint32Array,Int8:Int8Array,Int16:Int16Array,Int32:Int32Array,Float32:Float32Array,Float64:Float64Array};function xa(e,t,n){return async function(e){let{source:t,selection:n,onUpdate:o=()=>{},downsampleDepth:i=1,signal:a}=e;const{shape:s,labels:l,dtype:u}=t,{height:c,width:d}=(0,r.aP)(t),f=s[l.indexOf("z")],h=Math.max(1,Math.floor(f/i)),p=c*d,m=new(0,ba[u])(p*h);return await Promise.all(new Array(h).fill(0).map((async(e,r)=>{const s={...n,z:r*i},{data:l}=await t.getRaster({selection:s,signal:a});let u=0;for(o({z:r,total:h,progress:.5});u<p;){const e=r*p+(p-u-1),t=(d-u-1)%d+d*Math.floor(u/d);m[e]=l[t],u+=1}o({z:r,total:h,progress:1})}))),{data:m,height:c,width:d,depth:h}}({source:n[t],selection:{t:0,c:e},downsampleDepth:2**t})}async function wa(e,t,n,o,i,a,s){let l=null,u=null;const{shape:c,labels:d}=n[0],f=e.filter((e=>!o.has(e)||t!==s)),h=await Promise.all(f.map((e=>xa(e,t,n))));return f.forEach(((e,s)=>{const c=h[s];l=function(e){const t=new ha;return t.xLength=e.width,t.yLength=e.height,t.zLength=e.depth,t.data=e.data,t}(c);const d=l.computeMinMax();l.data=function(e){const[t,n]=e.computeMinMax(),r=new Float32Array(e.data.length);for(let o=0;o<e.data.length;o++)r[o]=(e.data[o]-t)/Math.sqrt(n**2-t**2);return r}(l),o.set(e,l),i.set(e,function(e){const t=new r.aM(e.data,e.xLength,e.yLength,e.zLength);return t.format=r.aN,t.type=r.aO,t.generateMipmaps=!1,t.minFilter=r.$,t.magFilter=r.$,t.needsUpdate=!0,t}(l)),a.set(e,d),u=function(e){const{x:t,y:n,z:r}=e?.meta?.physicalSizes??{};return[t,n,r]}(n[t])})),[o,i,a,u,[c[d.indexOf("x")],c[d.indexOf("y")],c[d.indexOf("z")]]]}function Sa(e){const t=(0,o.useRef)(null),n=(0,o.useRef)(null),[i,a]=(0,o.useState)(!1),[s,l]=(0,o.useState)(!1),[u,c]=(0,o.useState)(null),[d,f]=(0,o.useState)([1,1,1]),[h,p]=(0,o.useState)({uniforms:null,shader:null,meshScale:null,geometrySize:null,boxSize:null}),[m,g]=(0,o.useState)({volumes:new Map,textures:new Map,volumeMinMax:new Map,scale:null,resolution:null,originalScale:null}),[v,y]=(0,o.useState)({channelsVisible:[],allChannels:[],channelTargetC:[],resolution:null,data:null,colors:[],contrastLimits:[],is3dMode:!1,renderingMode:null,layerTransparency:1}),[b,x]=(0,o.useState)({visible:!0,color:[1,1,1],opacity:1,multiVisible:"",multiOpacity:"",multiColor:"",data:null,obsSets:[]}),{images:w,layerScope:S,channelsVisible:_,allChannels:E,channelTargetC:T,resolution:A,data:P,colors:C,contrastLimits:M,is3dMode:L,renderingMode:R,layerTransparency:I,xSlice:z,ySlice:k,zSlice:N}=ga(e,v,y,s,l),{obsSegmentations:O,onEntitySelected:j,segmentationLayerCoordination:B,segmentationChannelCoordination:D,segmentationChannelScopesByLayer:U}=e;let F=()=>{};const H=[];if(void 0!==D[0][S]){const e=D[0][S][S],{setObsHighlight:t}=D[1][S][S];F=t;const n=D[0][S][S].additionalObsSets;null!==n&&e.obsSetSelection.forEach((t=>{const r=t[1];n.tree[0].children.forEach((t=>{t.name===r&&t.set.forEach((t=>{let[n]=t;const o={name:"",id:"",color:[255,255,255]};o.name=r,o.id=n,e.obsSetColor.forEach((e=>{e.path[1]===r&&(o.color=e.color)})),H.push(o)}))}))})),null!==e.obsHighlight&&H.push({name:"",id:e.obsHighlight,color:[255,34,0]})}if(O?.[S]?.obsSegmentations&&null==u){const{scene:e,sceneOptions:t}=O[S].obsSegmentations;if(e?.children){const n=new r.S,o=new r.G;o.userData.name="finalPass",e.children.forEach((e=>{let n=e;void 0===n.material&&(n=e.children[0]),(n.material instanceof r.H||n.material instanceof r.z)&&(n.material=new r.a4);let i=n.name.replace("mesh_","").replace("mesh","").replace("glb","").replace("_dec","").replace("_Decobj","").replace("obj","").replace("_DEc","").replace(".","").replace("_Dec","");i.includes("_")&&(i=i.split("_")[0]),n.name=i,n.userData.name=i,n.userData.layerScope=S,n.material.transparent=!0,n.material.writeDepthTexture=!0,n.material.depthTest=!0,n.material.depthWrite=!0,n.material.needsUpdate=!0,n.material.side="back"===t?.materialSide?r.aI:r.ap;const a=n.clone();a.geometry=n.geometry.clone(),a.geometry.translate(t?.targetX??0,t?.targetY??0,t?.targetZ??0),a.geometry.scale(t?.scaleX??1,t?.scaleY??1,t?.scaleZ??1),a.geometry.rotateX(t?.rotationX??0),a.geometry.rotateY(t?.rotationY??0),a.geometry.rotateZ(t?.rotationZ??0);const s=n.clone();s.material=n.material.clone(),s.geometry=a.geometry.clone(),o.add(s)})),n.add(o),n.scale.set(t?.sceneScaleX??1,t?.sceneScaleY??1,t?.sceneScaleZ??1);f([t?.sceneScaleX??1,t?.sceneScaleY??1,t?.sceneScaleZ??1]),n.rotateX(t?.sceneRotationX??0),n.rotateY(t?.sceneRotationY??0),n.rotateZ(t?.sceneRotationZ??0),c(n)}}if(void 0!==D[0]&&void 0!==D[0][S]){const e=D[0][S][S];let t="";H.forEach((e=>{t+=`${e.id};${e.color.toString()};${e.name}`}));let n="";if(b.obsSets.forEach((e=>{n+=`${e.id};${e.color.toString()};${e.name}`})),U[S].length>1){let t="",n="",r="",o=!1,i=0;U[S].forEach((e=>{const a=D[0][S][e];t+=`${a.spatialChannelColor.toString()};`,n+=`${a.spatialChannelOpacity};`,r+=`${a.spatialChannelVisible};`,o|=a.spatialChannelVisible,i+=a.spatialChannelOpacity})),(t!==b.multiColor||n!==b.multiOpacity||r!==b.multiVisible)&&x({color:e.spatialChannelColor,opacity:i,visible:o,multiColor:t,multiVisible:r,multiOpacity:n,data:O,obsSets:H})}else(e.spatialChannelColor.toString()!==b.color.toString()||e.spatialChannelVisible!==b.visible||e.spatialChannelOpacity!==b.opacity||t!==n)&&x({color:e.spatialChannelColor,opacity:e.spatialChannelOpacity,visible:e.spatialChannelVisible,multiColor:"",multiVisible:"",multiOpacity:"",data:O,obsSets:H})}if((0,o.useEffect)((()=>{if(null!==u){let e=0,t=0;for(let n=0;n<u.children.length;n++)"finalPass"===u.children[n].userData.name?t=n:e=n;u.children[t].children.forEach(((t,n)=>{let{color:r}=b;const o=t.userData.name;if(b.obsSets.forEach((e=>{e.id===o&&(r=e.color)})),U[S].length>1)U[S].forEach((r=>{const i=D[0][S][r];i.spatialTargetC===o&&(t.material.color.r=i.spatialChannelColor[0]/255,t.material.color.g=i.spatialChannelColor[1]/255,t.material.color.b=i.spatialChannelColor[2]/255,t.material.opacity=i.spatialChannelOpacity,t.visible=i.spatialChannelVisible,t.material.needsUpdate=!0,t.userData.layerScope=S,t.userData.channelScope=r,u.children[e].children[n].material.needsUpdate=!0)}));else{t.material.color.r=r[0]/255,t.material.color.g=r[1]/255,t.material.color.b=r[2]/255,t.material.opacity=b.opacity,t.material.visible=b.visible,t.material.needsUpdate=!0,t.userData.layerScope=S;const e=Object.keys(D[0][S])?.[0];t.userData.channelScope=e}}))}}),[b,u]),void 0!==w[S]?.image?.instance?.getData()&&!s&&!i&&null!==M&&255!==M[0][1]&&L&&(l(!0),a(!0)),(0,o.useEffect)((()=>{s&&(A!==v.resolution&&t.current&&(t.current.material.uniforms.volumeCount.value=0,t.current.material.uniforms.volumeTex.value=null),(async()=>{const e=await wa(T,A,P,m.volumes,m.textures,m.volumeMinMax,m.resolution);if(null!==e[0])if(g({resolution:A,volumes:e[0],textures:e[1],volumeMinMax:e[2],scale:null!==e[3]?e[3]:m.scale,originalScale:e[4]}),h.uniforms&&h.shader)y({channelsVisible:_,allChannels:E,channelTargetC:T,resolution:A,data:P,colors:C,contrastLimits:M,is3dMode:L,renderingMode:R,layerTransparency:I,xSlice:z,ySlice:k,zSlice:N});else{const t=ya(e[0],T,_,C,e[1],M,e[2],e[3],R,I,z,k,N,e[4]);null!==t&&p({uniforms:t[0],shader:t[1],meshScale:t[2],geometrySize:t[3],boxSize:t[4]})}})(),l(!1))}),[s]),(0,o.useEffect)((()=>{if(h.uniforms&&h.shader){const e=ya(m.volumes,v.channelTargetC,v.channelsVisible,v.colors,m.textures,v.contrastLimits,m.volumeMinMax,m.scale,v.renderingMode,v.layerTransparency,v.xSlice,v.ySlice,v.zSlice,m.originalScale);if(null!==e){let n=0;v.channelsVisible.forEach((e=>{e&&n++})),l(!1),t?.current?.material?.uniforms&&(t.current.material.uniforms.u_clim.value=e[0].u_clim.value,t.current.material.uniforms.u_clim2.value=e[0].u_clim2.value,t.current.material.uniforms.u_clim3.value=e[0].u_clim3.value,t.current.material.uniforms.u_clim4.value=e[0].u_clim4.value,t.current.material.uniforms.u_clim5.value=e[0].u_clim5.value,t.current.material.uniforms.u_clim6.value=e[0].u_clim6.value,t.current.material.uniforms.u_xClip.value=e[0].u_xClip.value,t.current.material.uniforms.u_yClip.value=e[0].u_yClip.value,t.current.material.uniforms.u_zClip.value=e[0].u_zClip.value,t.current.material.uniforms.u_color.value=e[0].u_color.value,t.current.material.uniforms.u_color2.value=e[0].u_color2.value,t.current.material.uniforms.u_color3.value=e[0].u_color3.value,t.current.material.uniforms.u_color4.value=e[0].u_color4.value,t.current.material.uniforms.u_color5.value=e[0].u_color5.value,t.current.material.uniforms.u_color6.value=e[0].u_color6.value,t.current.material.uniforms.volumeTex.value=e[0].volumeTex.value,t.current.material.uniforms.volumeTex2.value=e[0].volumeTex2.value,t.current.material.uniforms.volumeTex3.value=e[0].volumeTex3.value,t.current.material.uniforms.volumeTex4.value=e[0].volumeTex4.value,t.current.material.uniforms.volumeTex5.value=e[0].volumeTex5.value,t.current.material.uniforms.volumeTex6.value=e[0].volumeTex6.value,t.current.material.uniforms.volumeCount.value=n,t.current.material.uniforms.u_renderstyle.value=v.renderingMode,t.current.material.uniforms.dtScale.value=v.layerTransparency)}else t?.current?.material?.uniforms&&(t.current.material.uniforms.volumeCount.value=0,t.current.material.uniforms.volumeTex.value=null)}}),[v]),!v.is3dMode)return null;if(v.is3dMode&&(!h.uniforms||!h.shader))return r.aJ.jsxs("group",{children:[r.aJ.jsx("ambientLight",{}),r.aJ.jsx("pointLight",{position:[10,10,10]}),r.aJ.jsx(vr,{color:"white",scale:20,fontWeight:1e3,children:"Loading ..."})]});const V={segmentationGroup:u,segmentationSettings:b,segmentationSceneScale:d,renderingSettings:h,materialRef:t,highlightEntity:j,setObsHighlight:F};return r.aJ.jsxs("group",{children:[r.aJ.jsx(fr,{}),r.aJ.jsx(mr,{}),r.aJ.jsx(ua,{}),r.aJ.jsx(fa,{}),r.aJ.jsx(da,{...V}),r.aJ.jsx(yr,{ref:n,enableDamping:!1,dampingFactor:0,zoomDampingFactor:0,smoothZoom:!1})]})}const _a=(0,o.forwardRef)(((e,t)=>r.aJ.jsxs("div",{style:{width:"100%",height:"100%"},children:[r.aJ.jsx(pt,{mode:"AR",sessionInit:{optionalFeatures:["hand-tracking"]},style:{border:"none",background:"rgba(0, 0, 0, 0.0)",zIndex:1,position:"absolute"},children:e=>"unsupported"!==e?r.aJ.jsx("div",{style:{border:"1px solid white",padding:"12px 24px",borderRadius:"4px",background:"rgba(0, 0, 0, 0.1)",color:"white",font:"normal 0.8125rem sans-serif",outline:"none",cursor:"pointer"},children:"entered"===e?"Exit AR":"Enter AR"}):null}),r.aJ.jsx(Ke,{style:{position:"absolute",top:0,left:0},camera:{fov:50,up:[0,1,0],position:[0,0,800],near:.1,far:3e3},gl:{antialias:!0,logarithmicDepthBuffer:!1},ref:t,children:r.aJ.jsx(dt,{children:r.aJ.jsx(Sa,{...e})})})]})))}}]);
//# sourceMappingURL=568.47b3a6d1.chunk.js.map